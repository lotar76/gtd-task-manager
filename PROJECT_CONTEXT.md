# üß† –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞ - –í–∞–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã

> **–¶–µ–ª—å**: –•—Ä–∞–Ω–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏–Ω—è—Ç—ã—Ö —Ä–µ—à–µ–Ω–∏—è—Ö, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –∏ –Ω–µ–Ω—É–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã.

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –ù–ï –¢–†–û–ì–ê–¢–¨ –ë–ï–ó –†–ê–ó–†–ï–®–ï–ù–ò–Ø

### Frontend Build System
- **`vite.config.js`** - ‚ö†Ô∏è –ù–ï –ú–ï–ù–Ø–¢–¨ –±–µ–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è
  - `emptyOutDir: false` - –∫—Ä–∏—Ç–∏—á–Ω–æ! –ò–Ω–∞—á–µ —É–¥–∞–ª—è–µ—Ç—Å—è `index.php` Laravel
  - `define` –¥–ª—è `VITE_API_URL` - –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è production
  
- **`resources/js/services/api.js`** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `import.meta.env.VITE_API_URL || '/api'`
  - –í production –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å `/api`
  - –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å `VITE_API_URL` –ø—Ä–∏ production —Å–±–æ—Ä–∫–µ!

### Docker Compose
- **`docker-compose.prod.yml`** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Traefik, –Ω–µ –º–µ–Ω—è—Ç—å –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è
- **`docker-compose.local.yml`** - –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–ø–æ—Ä—Ç 9090)

### Nginx Config
- **`docker/nginx/nginx.conf`** - –ø–æ—Ä—è–¥–æ–∫ location –±–ª–æ–∫–æ–≤ –∫—Ä–∏—Ç–∏—á–µ–Ω:
  1. `/api/` ‚Üí PHP
  2. `/assets/` ‚Üí —Å—Ç–∞—Ç–∏–∫–∞
  3. `\.php$` ‚Üí PHP-FPM
  4. `/` ‚Üí SPA (index.html)

---

## üìã –ü—Ä–∏–Ω—è—Ç—ã–µ —Ä–µ—à–µ–Ω–∏—è

### Frontend Deployment
- ‚úÖ **–§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –õ–û–ö–ê–õ–¨–ù–û**, –Ω–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ –°–æ–±—Ä–∞–Ω–Ω—ã–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ git (`public/`)
- ‚úÖ –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ç–æ–ª—å–∫–æ `git pull` - –±–µ–∑ —Å–±–æ—Ä–∫–∏
- ‚úÖ `VITE_API_URL` –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ production (—Ç–æ–ª—å–∫–æ `/api`)

**–ü–æ—á–µ–º—É**: 
- –ë—ã—Å—Ç—Ä–µ–µ –¥–µ–ø–ª–æ–π (–Ω–µ—Ç npm install –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
- –ú–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–±–æ—Ä–∫—É –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- –ò–∑–±–µ–≥–∞–µ–º –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

### PHP-FPM Configuration
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ `docker/php-fpm/www.conf` –±–µ–∑ `user`/`group` –¥–∏—Ä–µ–∫—Ç–∏–≤
- ‚úÖ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –æ—Ç `www-data` —á–µ—Ä–µ–∑ `USER` –≤ Dockerfile

**–ü–æ—á–µ–º—É**: –£–±–∏—Ä–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö PHP-FPM

### Sanctum Configuration
- ‚úÖ –£–±—Ä–∞–Ω `localhost` –∏–∑ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ `config/sanctum.php`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `Sanctum::currentApplicationUrlWithPort()`

**–ü–æ—á–µ–º—É**: –î–ª—è production –Ω–µ –Ω—É–∂–Ω—ã localhost –¥–æ–º–µ–Ω—ã

---

## üîß –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞: localhost:9090 –≤ —Å–æ–±—Ä–∞–Ω–Ω–æ–º JS
**–°–∏–º–ø—Ç–æ–º—ã**: API –∑–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç –Ω–∞ `http://localhost:9090/api` –≤–º–µ—Å—Ç–æ `/api`

**–ü—Ä–∏—á–∏–Ω–∞**: –ü—Ä–∏ —Å–±–æ—Ä–∫–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ `VITE_API_URL` –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `http://localhost:9090/api`

**–†–µ—à–µ–Ω–∏–µ**: 
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç `scripts/rebuild-frontend.sh`
- –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ `VITE_API_URL` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ —Å–±–æ—Ä–∫–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--env-file /dev/null` –≤ Docker

### –ü—Ä–æ–±–ª–µ–º–∞: index.php —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ —Ñ—Ä–æ–Ω—Ç–∞
**–°–∏–º–ø—Ç–æ–º—ã**: API –ø–µ—Ä–µ—Å—Ç–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ `npm run build`

**–ü—Ä–∏—á–∏–Ω–∞**: `emptyOutDir: true` –≤ vite.config.js

**–†–µ—à–µ–Ω–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `emptyOutDir: false` –≤ vite.config.js

### –ü—Ä–æ–±–ª–µ–º–∞: –¶–∏–∫–ª –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ nginx
**–°–∏–º–ø—Ç–æ–º—ã**: 500 –æ—à–∏–±–∫–∞, "rewrite or internal redirection cycle"

**–ü—Ä–∏—á–∏–Ω–∞**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É `location ~ \.html$` –∏ `location /`

**–†–µ—à–µ–Ω–∏–µ**: –£–±—Ä–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π location –¥–ª—è `.html$`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `location /`

---

## üìù Workflow

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
./scripts/setup-local.sh
# –∏–ª–∏
docker-compose -f docker-compose.local.yml up -d
```

### Production –¥–µ–ø–ª–æ–π
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ:
npm run build
git add public/
git commit -m "Build frontend"
git push

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:
./scripts/deploy.sh
# –∏–ª–∏
git pull
docker-compose -f docker-compose.prod.yml up -d --build
```

### –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```bash
./scripts/rebuild-frontend.sh
```

---

## ‚ùì –í–æ–ø—Ä–æ—Å—ã –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è? –í–Ω–µ—à–Ω—è—è –∏–ª–∏ –≤ Docker? –ö–∞–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã?

2. **S3 Storage**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏? –ö–∞–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞–∂–Ω—ã?

3. **Environment Variables**: –ö–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è production? –ù—É–∂–Ω–æ –ª–∏ –∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å?

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ï—Å—Ç—å –ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã? –ù—É–∂–Ω–æ –ª–∏ –∏—Ö –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º?

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥/–õ–æ–≥–∏**: –ö–∞–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –≤ production? –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏?

6. **Backup**: –ï—Å—Ç—å –ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –±—ç–∫–∞–ø–æ–≤? –ß—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –±—ç–∫–∞–ø–∏—Ç—å?

---

## üìå TODO –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è

- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ environment variables
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º (—Ç–µ—Å—Ç—ã, –ª–∏–Ω—Ç–µ—Ä—ã)
- [ ] –û–ø–∏—Å–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –ø—Ä–æ–±–ª–µ–º
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É API endpoints

---

## üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 2025-11-25
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å localhost:9090 –≤ —Å–æ–±—Ä–∞–Ω–Ω–æ–º JS
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ —Å–±–æ—Ä–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –±–µ–∑ VITE_API_URL
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PHP-FPM
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Sanctum
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è nginx (—É–±—Ä–∞–Ω—ã —Ü–∏–∫–ª—ã –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

