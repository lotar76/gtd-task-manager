# GTD TODO — Техзадание на дашборд «Зеркало жизни»

---

## 1. Концепция

Дашборд — это не панель со статистикой. Это **зеркало**, которое говорит пользователю правду о его жизни. Центральный элемент — живое сообщение от системы, а данные — подтверждение сказанного.

Пользователь открывает дашборд и сразу получает ответ на вопрос: **«Как я живу?»** — без необходимости самому анализировать графики.

---

## 2. Иерархия данных в приложении

```
Сфера          Область жизни (8 штук: Духовная, Семья, Здоровье, Финансы, 
               Работа, Развитие, Окружение, Отдых)
  └─ Цель      Конкретный измеримый результат + дедлайн
      ├─ Поток  Группа связанных задач внутри цели
      │   └─ Задача
      └─ Задача Отдельная задача без потока
```

Карточка цели:
- **Что** — текстовое поле (обязательно)
- **Когда** — дата дедлайна (обязательно)
- **Зачем** — мотивация (опционально)
- **Картинка** — визуализация результата (опционально)
- **Стих из Библии** — вводится пользователем вручную (опционально)

---

## 3. Структура дашборда

### 3.1. Шапка

- Название: «Зеркало жизни»
- Дата
- Переключатель периодов: **День / Неделя / Месяц / Год**

### 3.2. Блок-герой: Голос системы

**Это главный элемент дашборда. Он должен визуально доминировать.**

Структура:
- Аватар системы с пульсирующим индикатором (цвет зависит от настроения)
- Лейбл «Зеркало говорит»
- **Основное сообщение** — 2-4 предложения, крупный шрифт, ключевые слова подсвечены
- **Дополнительное сообщение** — в карточке внутри, как второе сообщение в чате
- **Рекомендации** — конкретные действия с привязкой к сферам, кнопка «Добавить задачу»
- **Библейский стих** — внизу блока, если у пользователя включена вера

Настроения и их цвета:
| Настроение | Когда | Цвет градиента |
|-----------|-------|----------------|
| positive | Баланс хороший | Зелёный |
| concerned | Есть перекосы | Голубой |
| warning | Серьёзный дисбаланс | Жёлтый |
| serious | Цели под угрозой | Розовый |
| reflective | Годовой обзор | Фиолетовый |

**Текст генерирует AI на основе данных пользователя (см. раздел AI-движка ниже).**

### 3.3. Левая панель: Колесо баланса

Постоянно видно при любом периоде.

- Круговая диаграмма из 8 сегментов (по сферам)
- Каждый сегмент закрашен пропорционально прогрессу в сфере
- У каждой сферы свой цвет:
  - Духовная — фиолетовый (#A78BFA)
  - Семья — розовый (#F472B6)
  - Здоровье — изумрудный (#34D399)
  - Финансы — золотой (#FBBF24)
  - Работа — голубой (#60A5FA)
  - Развитие — индиго (#818CF8)
  - Окружение — бирюзовый (#2DD4BF)
  - Отдых — оранжевый (#FB923C)
- В центре — средний % по всем сферам
- При наведении на сегмент — подробности сферы (прогресс, было→стало, дни без внимания)
- Под колесом — легенда сфер (кликабельная)

### 3.4. Правая панель: Данные периода

Контент меняется в зависимости от выбранного периода.

---

#### ДЕНЬ

Отвечает на вопрос: **«Я сегодня живу полноценно или по инерции?»**

Блоки:
1. **Баланс дня** — горизонтальная полоса, показывающая распределение задач по сферам. Пустые сферы показаны пунктиром. Под полосой — легенда: сфера + количество.
2. **Задачи на сегодня** — список с чекбоксами, сгруппированный или с иконкой сферы. При клике — задача отмечается выполненной. У каждой задачи — привязка к потоку (если есть).
3. **Пустые сферы** — сетка 2 колонки. Каждая пустая сфера с кнопкой «Добавить задачу». Фон — цвет сферы приглушённый, рамка пунктирная.

Диагностика от AI:
- Какой % дня уходит на одну сферу
- Какие сферы давно без внимания
- Конкретные рекомендации что добавить

---

#### НЕДЕЛЯ

Отвечает на вопрос: **«Эта неделя приблизила меня к жизни которую я хочу?»**

Блоки:
1. **Рентген недели** — 7 столбцов (Пн-Вс), каждый разбит на сегменты по сферам (цвета сфер). Высота сегмента = количество задач. Пустой день показан как «—». Сразу видно визуально: где сплошная работа, где пустота.
2. **Распределение внимания** — список сфер с прогресс-барами, показывающий % внимания за неделю. Отсортировано от большего к меньшему. Сферы с 0% — приглушённые.
3. **Потоки** — список всех потоков с прогресс-барами (выполнено/запланировано). Застрявшие потоки (status: stalled) — визуально приглушённые, с пометкой «стоит».

Диагностика от AI:
- Перекос внимания (например, 62% работа)
- Сферы с нулевым вниманием
- Застрявшие потоки — что с ними делать

---

#### МЕСЯЦ

Отвечает на вопрос: **«Я приближаюсь к жизни которую хочу, или ухожу от неё?»**

Блоки:
1. **Нагрузка** — прогресс-бар: выполнено / запланировано. Рядом число. Под ним текст: «Осталось X задач, ~Y/день чтобы успеть».
2. **Было → Стало** — таблица по сферам: иконка, название, прошлый %, прогресс-бар с маркером прошлого месяца, текущий %, тренд (стрелка вверх/вниз/—). Отсортировано по изменению (лучшие сверху).
3. **Застрявшие потоки** — потоки без движения N дней, с кнопкой «Реанимировать».
4. **Цели под угрозой** — цели где текущий темп < необходимого. Показать оба числа.

Диагностика от AI:
- Реален ли темп
- Что выросло, что упало
- Цели которые при текущем темпе недостижимы (математика)
- Провокационные вопросы: «Семья упала — ты осознанно выбрал?»

---

#### ГОД

Отвечает на вопрос: **«Я строю жизнь которую хочу, или жизнь которая получается?»**

Блоки:
1. **Индекс баланса — тренд** — столбчатая диаграмма по месяцам (последние 6-12 месяцев). Текущий месяц выделен цветом и свечением.
2. **Цели года** — таблица: иконка сферы, название, прогресс-бар, дней до дедлайна, статус (опережает / по графику / отстаёт / стоит). Застрявшие — приглушённые.
3. **Достигнутые цели** — список с галочками, цветом сферы, датой достижения. Мотивационный блок.
4. **Тренды по сферам** — какие сферы системно растут, какие системно падают за год.

Диагностика от AI:
- Общая траектория: жизнь шире или уже
- Мёртвые цели — тащить или отпустить
- Философские вопросы: «Помнишь зачем начал?»

---

## 4. Дизайн

- Тёмная тема, фон #0c0e14
- Каждая сфера — свой яркий цвет (палитра выше)
- Прогресс-бары — градиент от цвета сферы
- При наведении — glow-эффект цветом сферы
- Карточки — полупрозрачный фон, тонкая рамка
- Шрифт — IBM Plex Sans (основной) + IBM Plex Mono (числа, коды)
- SVG-иконки для сфер, без эмодзи
- Блок-герой (голос системы) — градиентный фон в цвет настроения, крупный шрифт, аватар с пульсацией
- Анимации: плавное появление блоков при загрузке, hover-эффекты на колесе и карточках

---

## 5. Взаимодействие

- Переключение периодов — мгновенное, без перезагрузки
- Наведение на сегмент колеса — подсветка сферы везде на странице
- Клик на задачу — переключение статуса
- Кнопка «Добавить задачу» в пустых сферах — открывает форму создания задачи с предвыбранной сферой
- Кнопка «Реанимировать» у застрявших потоков — открывает поток
- AI-сообщение обновляется при смене периода

---

## 6. Технические требования

- Фреймворк: React
- AI: Claude API (Sonnet) для генерации сообщений
- Кеширование AI-ответов:
  - День — не чаще 1 раза в час
  - Неделя — 1 раз в день
  - Месяц — 1 раз в день
  - Год — 1 раз в неделю
- Fallback при недоступности AI: правила на фронтенде (если career > 50% → «Работа доминирует»)
- Адаптивность: десктоп (2 колонки), планшет (1 колонка, колесо сверху)

---

---

# Раздел 2 — AI-движок: Промпты и JSON

---

## Как это работает

```
Фронтенд собирает данные → формирует JSON → отправляет в AI с промптом → 
AI возвращает JSON с текстом и рекомендациями → фронтенд рендерит
```

---

## Общий системный промпт (один на все периоды)

```
Ты — «Зеркало жизни», встроенный помощник в GTD-приложении.

Твоя задача — анализировать данные о жизни пользователя по 8 сферам 
и давать честную, живую обратную связь. Не статистику — а осознанный взгляд со стороны.

ПРАВИЛА ОБЩЕНИЯ:
- Говори как умный друг, не как робот. Коротко, по делу.
- Не лей воду. Каждое предложение — ценность.
- Называй вещи своими именами. «Ты забил на здоровье» — нормально.
- Не хвали без причины. Хвали только реальные достижения.
- Задавай вопросы которые заставляют думать.
- Не используй эмодзи, списки, маркдаун. Только живой текст.
- Если у пользователя включена вера — можешь добавить короткую 
  цитату из Библии, но только если она реально в тему. Не вставляй для галочки.

СФЕРЫ ЖИЗНИ:
- spiritual (Духовная жизнь)
- family (Семья)  
- health (Здоровье)
- finance (Финансы)
- career (Работа)
- education (Развитие)
- social (Окружение)
- hobby (Отдых)

АНАЛИЗИРУЙ:
1. Баланс — где перекос? Какие сферы доминируют, какие голодают?
2. Тренды — что растёт, что падает, что стоит?
3. Проблемы — застрявшие потоки, забытые сферы, просроченные цели
4. Цена выбора — если человек вкладывается в одно, что страдает?
5. Рекомендации — конкретные, выполнимые, по одной на проблему

ФОРМАТ ОТВЕТА — строго JSON, никакого текста вне JSON.
```

---

## ДЕНЬ — промпт и данные

### Промпт (добавляется после системного)

```
Период: ДЕНЬ.

Проанализируй сегодняшний план пользователя. Обрати внимание:
- Какие сферы представлены в задачах, какие — нет
- Есть ли перекос (например, всё — работа)
- Есть ли важные сферы которые давно без внимания
- Выполнимо ли запланированное количество

Главный вопрос дня: «Ты сегодня живёшь полноценно или по инерции?»

Вот данные:
```

### JSON на вход

```json
{
  "period": "day",
  "date": "2026-02-14",
  "user_name": "Игорь",
  "faith_enabled": true,

  "today": {
    "total_tasks": 6,
    "done_tasks": 3,
    "tasks_by_sphere": {
      "career": 3,
      "spiritual": 1,
      "finance": 1,
      "health": 1
    },
    "spheres_missing": ["family", "education", "social", "hobby"]
  },

  "spheres_context": [
    {
      "id": "career",
      "name": "Работа",
      "days_without_attention": 0,
      "today_tasks": 3,
      "today_pct": 50
    },
    {
      "id": "spiritual",
      "name": "Духовная жизнь",
      "days_without_attention": 0,
      "today_tasks": 1,
      "today_pct": 17
    },
    {
      "id": "health",
      "name": "Здоровье",
      "days_without_attention": 21,
      "today_tasks": 1,
      "today_pct": 17
    },
    {
      "id": "family",
      "name": "Семья",
      "days_without_attention": 12,
      "today_tasks": 0,
      "today_pct": 0
    },
    {
      "id": "education",
      "name": "Развитие",
      "days_without_attention": 3,
      "today_tasks": 0,
      "today_pct": 0
    },
    {
      "id": "social",
      "name": "Окружение",
      "days_without_attention": 9,
      "today_tasks": 0,
      "today_pct": 0
    },
    {
      "id": "hobby",
      "name": "Отдых",
      "days_without_attention": 14,
      "today_tasks": 0,
      "today_pct": 0
    },
    {
      "id": "finance",
      "name": "Финансы",
      "days_without_attention": 0,
      "today_tasks": 1,
      "today_pct": 17
    }
  ]
}
```

### JSON на выход (что AI должен вернуть)

```json
{
  "main_message": "Сегодня у тебя 6 задач — половина уже сделана. Но 50% плана — работа. Семья не получала внимания 12 дней. Отдых — 14 дней. Ты уверен что сегодня нет 10 минут для звонка жене или прогулки?",
  
  "followup_message": "Здоровье в плане есть — пробежка. Но ты откладываешь её уже 21 день. Сегодня суббота. Если не сейчас — когда?",
  
  "mood": "concerned",
  
  "recommendations": [
    {
      "sphere": "family",
      "action": "Позвони жене или проведи 15 минут с детьми без телефона",
      "why": "12 дней без внимания к семье"
    },
    {
      "sphere": "health",
      "action": "Не откладывай пробежку. Хотя бы 2 км",
      "why": "21 день без внимания, пробежка уже в плане"
    }
  ],

  "bible_verse": {
    "text": "Если же кто о своих и особенно о домашних не печётся, тот отрёкся от веры",
    "ref": "1 Тим. 5:8"
  }
}
```

---

## НЕДЕЛЯ — промпт и данные

### Промпт

```
Период: НЕДЕЛЯ.

Проанализируй неделю пользователя. Обрати внимание:
- Распределение внимания по сферам за неделю (процент задач)
- Какие сферы получили 0% внимания
- Какие потоки активны, какие застряли
- Есть ли дни когда всё ушло в одну сферу

Главный вопрос недели: «Эта неделя приблизила тебя к жизни которую ты хочешь?»

Вот данные:
```

### JSON на вход

```json
{
  "period": "week",
  "week_start": "2026-02-09",
  "week_end": "2026-02-15",
  "user_name": "Игорь",
  "faith_enabled": true,

  "week_summary": {
    "total_tasks": 28,
    "done_tasks": 22,
    "completion_rate": 79
  },

  "attention_by_sphere": {
    "career": { "pct": 62, "tasks": 17 },
    "spiritual": { "pct": 11, "tasks": 3 },
    "finance": { "pct": 7, "tasks": 2 },
    "education": { "pct": 7, "tasks": 2 },
    "family": { "pct": 4, "tasks": 1 },
    "health": { "pct": 0, "tasks": 0 },
    "social": { "pct": 0, "tasks": 0 },
    "hobby": { "pct": 0, "tasks": 0 }
  },

  "daily_breakdown": [
    { "day": "Пн", "by_sphere": { "career": 4, "finance": 1, "spiritual": 1 } },
    { "day": "Вт", "by_sphere": { "career": 3, "spiritual": 1 } },
    { "day": "Ср", "by_sphere": { "career": 3, "education": 2, "finance": 1 } },
    { "day": "Чт", "by_sphere": { "career": 4, "family": 1 } },
    { "day": "Пт", "by_sphere": { "career": 2, "spiritual": 1 } },
    { "day": "Сб", "by_sphere": {} },
    { "day": "Вс", "by_sphere": {} }
  ],

  "flows": [
    { "name": "GTD TODO", "sphere": "career", "done": 8, "total": 12, "status": "active" },
    { "name": "Фриланс", "sphere": "career", "done": 4, "total": 6, "status": "active" },
    { "name": "Чтение Библии", "sphere": "spiritual", "done": 5, "total": 7, "status": "active" },
    { "name": "Полумарафон", "sphere": "health", "done": 0, "total": 4, "status": "stalled" },
    { "name": "Семейный отдых", "sphere": "family", "done": 0, "total": 3, "status": "stalled" },
    { "name": "React курс", "sphere": "education", "done": 2, "total": 3, "status": "active" },
    { "name": "Гитара", "sphere": "hobby", "done": 0, "total": 2, "status": "stalled" }
  ]
}
```

### JSON на выход

```json
{
  "main_message": "22 из 28 задач — неделя продуктивная. Но 62% ушло на работу. Здоровье, окружение, отдых — ни одной задачи. Ты работаешь на автопилоте, а не живёшь.",
  
  "followup_message": "Три потока стоят мёртвым грузом: Полумарафон, Семейный отдых, Гитара. Ноль задач за неделю. Если они ещё важны — хотя бы один шаг на следующей неделе. Если нет — убери, хватит тащить вину.",

  "mood": "warning",

  "recommendations": [
    {
      "sphere": "health",
      "action": "Запланируй 2 тренировки на следующую неделю и поставь напоминание",
      "why": "Поток Полумарафон стоит, 0 задач за неделю, цель под угрозой"
    },
    {
      "sphere": "family",
      "action": "Забронируй один вечер на неделе только для семьи, без работы",
      "why": "4% внимания за неделю, поток Семейный отдых стоит"
    },
    {
      "sphere": "hobby",
      "action": "Реши: гитара ещё актуальна? Если да — 15 минут завтра. Если нет — закрой поток",
      "why": "Поток Гитара стоит, 0% внимания, мёртвый груз"
    }
  ],

  "bible_verse": {
    "text": "Всему своё время, и время всякой вещи под небом",
    "ref": "Еккл. 3:1"
  }
}
```

---

## МЕСЯЦ — промпт и данные

### Промпт

```
Период: МЕСЯЦ.

Проанализируй месяц пользователя. Обрати внимание:
- Общая нагрузка — запланировано vs выполнено, реален ли темп
- Тренды по сферам — что выросло, что упало (было → стало)
- Застрявшие потоки — сколько дней без движения
- Цели под угрозой — текущий темп vs необходимый
- Перекосы на длинной дистанции

Главный вопрос месяца: «Ты приближаешься к жизни которую хочешь, или уходишь от неё?»

Вот данные:
```

### JSON на вход

```json
{
  "period": "month",
  "month": "2026-02",
  "user_name": "Игорь",
  "faith_enabled": true,

  "month_summary": {
    "planned": 89,
    "done": 42,
    "completion_rate": 47,
    "days_passed": 14,
    "days_remaining": 14,
    "required_daily_pace": 3.4
  },

  "sphere_trends": [
    { "id": "career",    "name": "Работа",          "now": 85, "was": 78, "change": 7  },
    { "id": "spiritual", "name": "Духовная жизнь",  "now": 72, "was": 65, "change": 7  },
    { "id": "finance",   "name": "Финансы",         "now": 60, "was": 48, "change": 12 },
    { "id": "education", "name": "Развитие",        "now": 55, "was": 50, "change": 5  },
    { "id": "family",    "name": "Семья",           "now": 45, "was": 52, "change": -7 },
    { "id": "social",    "name": "Окружение",       "now": 30, "was": 35, "change": -5 },
    { "id": "hobby",     "name": "Отдых",           "now": 20, "was": 22, "change": -2 },
    { "id": "health",    "name": "Здоровье",        "now": 15, "was": 18, "change": -3 }
  ],

  "stalled_flows": [
    { "name": "Полумарафон",    "sphere": "health", "days_stalled": 21 },
    { "name": "Гитара",         "sphere": "hobby",  "days_stalled": 14 },
    { "name": "Семейный отдых", "sphere": "family", "days_stalled": 12 }
  ],

  "goals_at_risk": [
    {
      "title": "Полумарафон к сентябрю",
      "sphere": "health",
      "progress": 15,
      "days_left": 213,
      "current_pace": 0.1,
      "required_pace": 1.2
    },
    {
      "title": "Семейный отдых в июне",
      "sphere": "family",
      "progress": 45,
      "days_left": 120,
      "current_pace": 0.5,
      "required_pace": 2.8
    }
  ]
}
```

### JSON на выход

```json
{
  "main_message": "Половина месяца. 42 из 89 — темп нормальный, но нагрузка растёт. Финансы хорошо выросли, +12%. А вот семья упала с 52% до 45%. Это осознанный выбор или ты просто не заметил?",
  
  "followup_message": "Здоровье: 15%, падает третий месяц. Полумарафон в сентябре — при текущем темпе ты не добежишь. Это не мнение, это математика. Нужен темп 1.2 задачи в день, у тебя — 0.1.",

  "mood": "serious",

  "recommendations": [
    {
      "sphere": "health",
      "action": "Начни с малого: 3 тренировки на следующей неделе. Не полумарафон — просто выйди на улицу",
      "why": "Прогресс 15%, темп 0.1 vs нужного 1.2, цель под угрозой"
    },
    {
      "sphere": "family",
      "action": "Спланируй конкретные шаги по отдыху: бронь, билеты, даты. Преврати мечту в задачи",
      "why": "Упала с 52% до 45%, поток стоит 12 дней, цель отстаёт"
    },
    {
      "sphere": "hobby",
      "action": "Прими решение по гитаре. Либо 15 минут в день — либо убери из целей. Не мучай себя",
      "why": "Поток стоит 14 дней, прогресс падает"
    }
  ],

  "bible_verse": {
    "text": "Не знаете ли, что тела ваши суть храм живущего в вас Святого Духа",
    "ref": "1 Кор. 6:19"
  }
}
```

---

## ГОД — промпт и данные

### Промпт

```
Период: ГОД.

Проанализируй годовую картину пользователя. Обрати внимание:
- Сколько целей достигнуто, сколько в процессе, сколько стоят
- Тренд индекса баланса — жизнь становится сбалансированнее или нет
- Какие сферы системно растут, какие системно падают
- Есть ли цели которые стоят месяцами — мёртвый груз
- Общая траектория — куда человек движется

Главный вопрос года: «Ты строишь жизнь которую хочешь, или жизнь которая получается?»

Вот данные:
```

### JSON на вход

```json
{
  "period": "year",
  "year": 2026,
  "user_name": "Игорь",
  "faith_enabled": true,

  "goals_summary": {
    "total": 8,
    "achieved": 2,
    "on_track": 2,
    "behind": 2,
    "stalled": 2
  },

  "achieved_goals": [
    { "title": "Освоить TypeScript", "sphere": "education", "achieved_date": "2025-11" },
    { "title": "Накопить на первый взнос", "sphere": "finance", "achieved_date": "2025-10" }
  ],

  "active_goals": [
    { "title": "Запустить GTD TODO",    "sphere": "career",    "progress": 85, "days_left": 18,  "status": "ahead" },
    { "title": "Прочитать Библию",      "sphere": "spiritual", "progress": 72, "days_left": 320, "status": "on_track" },
    { "title": "Закрыть ипотеку",       "sphere": "finance",   "progress": 60, "days_left": 655, "status": "on_track" },
    { "title": "Освоить React",         "sphere": "education", "progress": 55, "days_left": 120, "status": "behind" },
    { "title": "Семейный отдых",        "sphere": "family",    "progress": 45, "days_left": 120, "status": "behind" },
    { "title": "Найти ментора",         "sphere": "social",    "progress": 30, "days_left": 210, "status": "behind" },
    { "title": "Гитара",                "sphere": "hobby",     "progress": 20, "days_left": 320, "status": "stalled" },
    { "title": "Полумарафон",           "sphere": "health",    "progress": 15, "days_left": 213, "status": "stalled" }
  ],

  "balance_trend": [
    { "month": "Сен 2025", "index": 35 },
    { "month": "Окт 2025", "index": 38 },
    { "month": "Ноя 2025", "index": 32 },
    { "month": "Дек 2025", "index": 29 },
    { "month": "Янв 2026", "index": 34 },
    { "month": "Фев 2026", "index": 31 }
  ],

  "sphere_yearly_trend": [
    { "id": "career",    "trend": "growing",  "avg_attention": 55 },
    { "id": "spiritual", "trend": "growing",  "avg_attention": 12 },
    { "id": "finance",   "trend": "growing",  "avg_attention": 13 },
    { "id": "education", "trend": "stable",   "avg_attention": 8  },
    { "id": "family",    "trend": "falling",  "avg_attention": 6  },
    { "id": "social",    "trend": "falling",  "avg_attention": 3  },
    { "id": "hobby",     "trend": "stalled",  "avg_attention": 2  },
    { "id": "health",    "trend": "falling",  "avg_attention": 1  }
  ]
}
```

### JSON на выход

```json
{
  "main_message": "2 из 8 целей достигнуты — TypeScript и первый взнос. GTD TODO на финише. Это хорошая база. Но индекс баланса за полгода падает: 35 → 31. Ты разгоняешься по работе и финансам, а жизнь становится уже. Здоровье, отдых, окружение — системно падают месяц за месяцем.",

  "followup_message": "Полумарафон и Гитара стоят с осени. Каждый раз ты видишь их в списке — и чувствуешь укол. Это мёртвый груз. Либо верни в работу с конкретным планом на следующую неделю, либо отпусти. Честность с собой — это тоже прогресс.",

  "mood": "reflective",

  "recommendations": [
    {
      "sphere": "health",
      "action": "Реши: марафон или нет. Если да — план тренировок с понедельника. Если нет — закрой цель и поставь новую по здоровью",
      "why": "Стоит с осени, прогресс 15%, тренд falling"
    },
    {
      "sphere": "family",
      "action": "Семья системно теряет внимание: 6% в среднем за год. Поставь минимум: 1 вечер в неделю без работы — в календарь",
      "why": "Тренд falling, семейный отдых отстаёт"
    },
    {
      "sphere": "career",
      "action": "GTD TODO — 85%, осталось 18 дней. Сфокусируйся и закрой. Это освободит ресурс для остальных сфер",
      "why": "Почти на финише, закрытие снизит перекос в работу"
    }
  ],

  "bible_verse": {
    "text": "Во всех путях твоих познавай Его, и Он направит стези твои",
    "ref": "Притч. 3:6"
  }
}
```

---

## Описание полей выходного JSON

| Поле | Тип | Описание |
|------|-----|----------|
| `main_message` | string | Главное сообщение, 2-4 предложения. Ключевые цифры + честная оценка |
| `followup_message` | string | Дополнительное сообщение. Глубже, эмоциональнее, про конкретную проблему |
| `mood` | string | Настроение: `positive`, `concerned`, `warning`, `serious`, `reflective` |
| `recommendations` | array | 1-3 конкретных рекомендации с указанием сферы, действия и причины |
| `recommendations[].sphere` | string | ID сферы к которой относится рекомендация |
| `recommendations[].action` | string | Конкретное действие, выполнимое сегодня/на этой неделе |
| `recommendations[].why` | string | Почему это важно — данные, не мнение |
| `bible_verse` | object/null | Цитата из Библии если `faith_enabled: true` и есть что-то в тему. Null если нет |

---

## Значения mood и как их рендерить

| mood | Когда | Цвет | Тон |
|------|-------|------|-----|
| `positive` | Баланс хороший, цели идут по графику | Зелёный | Поддержка, но без лести |
| `concerned` | Есть перекосы, но ситуация управляемая | Голубой | Мягкое предупреждение |
| `warning` | Серьёзный дисбаланс, потоки стоят | Жёлтый | Прямой разговор |
| `serious` | Цели под угрозой, сферы падают | Розовый | Жёсткая правда |
| `reflective` | Годовой обзор, глубокие вопросы | Фиолетовый | Философский, глубокий |

---

## Примечания по реализации

**Токены:** Входной JSON — 300-500 токенов. Промпт — 200-300. Ответ — 300-500. 
Итого ~1000 токенов на запрос. Дёшево.

**Кеширование:** Нет смысла вызывать AI на каждый рендер дашборда. 
Кешировать ответ и обновлять:
- День — при открытии дашборда, не чаще 1 раза в час
- Неделя — 1 раз в день
- Месяц — 1 раз в день
- Год — 1 раз в неделю

**Fallback:** Если AI недоступен — показывать простые автоматические сообщения 
на основе правил (например: если career > 50% attention → "Работа доминирует").

**Модель:** Claude Sonnet — оптимальный баланс цены и качества для таких задач.
