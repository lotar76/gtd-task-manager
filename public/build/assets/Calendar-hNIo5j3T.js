import{d as b,u as E,_ as F}from"./TaskList-DOwioYR-.js";import{r as u,k as p,q,c as l,a as t,p as h,t as d,F as x,y as k,f as z,o as i,b as C}from"./app-DjZzWwoi.js";import"./workspace-BLzY3GDa.js";const L={class:"p-4 lg:p-8"},A={class:"max-w-7xl mx-auto"},G={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6"},H={class:"flex items-center space-x-3 mt-4 lg:mt-0"},I={class:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6"},J={class:"flex items-center justify-between"},K={class:"text-lg font-semibold text-gray-900"},P={class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},Q={class:"grid grid-cols-7 border-b border-gray-200"},R={class:"grid grid-cols-7"},U={class:"flex justify-between items-start mb-1"},W={key:0,class:"inline-flex items-center justify-center w-5 h-5 text-xs font-medium bg-primary-600 text-white rounded-full"},X={class:"space-y-1"},Z=["onClick"],tt={key:0,class:"text-xs text-gray-500"},et={class:"lg:hidden mt-6"},rt={__name:"Calendar",setup(st){b.locale("ru");const f=E(),n=u(b()),_=u([]),M=u(!1),m=u(!1),w=u("calendar"),D=u([]),T=["ÐŸÐ½","Ð’Ñ‚","Ð¡Ñ€","Ð§Ñ‚","ÐŸÑ‚","Ð¡Ð±","Ð’Ñ"],j=p(()=>n.value.format("MMMM")),O=p(()=>n.value.format("YYYY")),B=p(()=>{const o=[],s=n.value.startOf("month"),e=n.value.endOf("month"),c=s.day()===0?6:s.day()-1;for(let a=c-1;a>=0;a--){const y=s.subtract(a+1,"day");o.push(v(y,!1))}for(let a=0;a<e.date();a++){const y=s.add(a,"day");o.push(v(y,!0))}const r=42-o.length;for(let a=0;a<r;a++){const y=e.add(a+1,"day");o.push(v(y,!1))}return o}),v=(o,s)=>{const e=o.format("YYYY-MM-DD"),c=_.value.filter(r=>r.due_date&&b(r.due_date).format("YYYY-MM-DD")===e);return{day:o.date(),date:e,currentMonth:s,isToday:o.isSame(b(),"day"),taskCount:c.length,tasks:c}},g=async()=>{M.value=!0;try{const o=n.value.startOf("month").subtract(7,"days").format("YYYY-MM-DD"),s=n.value.endOf("month").add(7,"days").format("YYYY-MM-DD");await f.fetchCalendar(o,s,m.value),_.value=f.tasks}finally{M.value=!1}},S=()=>{n.value=n.value.subtract(1,"month"),g()},N=()=>{n.value=n.value.add(1,"month"),g()},V=()=>{m.value=!m.value,g()},Y=o=>{console.log("Task clicked:",o)},$=async o=>{try{o.status==="completed"?await f.updateTask(o.id,{status:"next_action"}):await f.completeTask(o.id),g()}catch(s){console.error("Error toggling task:",s)}};return q(()=>{g()}),(o,s)=>(i(),l("div",L,[t("div",A,[t("div",G,[s[1]||(s[1]=t("div",null,[t("h1",{class:"text-2xl lg:text-3xl font-bold text-gray-900"},"ðŸ“… ÐšÐ°Ð»ÐµÐ½Ð´Ð°Ñ€ÑŒ"),t("p",{class:"text-sm text-gray-600 mt-1"},"Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð² ÐºÐ°Ð»ÐµÐ½Ð´Ð°Ñ€Ð½Ð¾Ð¼ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÐµÐ½Ð¸Ð¸")],-1)),t("div",H,[t("button",{onClick:V,class:h(["btn",m.value?"btn-primary":"btn-secondary"])},d(m.value?"ÐœÐ¾Ð¸ Ð·Ð°Ð´Ð°Ñ‡Ð¸":"Ð’ÑÐµ Ð·Ð°Ð´Ð°Ñ‡Ð¸"),3),t("button",{onClick:s[0]||(s[0]=e=>w.value="list"),class:h(["btn",w.value==="list"?"btn-primary":"btn-secondary"])}," Ð¡Ð¿Ð¸ÑÐ¾Ðº ",2)])]),t("div",I,[t("div",J,[t("button",{onClick:S,class:"btn btn-secondary"},[...s[2]||(s[2]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),t("h2",K,d(j.value)+" "+d(O.value),1),t("button",{onClick:N,class:"btn btn-secondary"},[...s[3]||(s[3]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])])]),t("div",P,[t("div",Q,[(i(),l(x,null,k(T,e=>t("div",{key:e,class:"text-center py-3 text-sm font-medium text-gray-700 border-r border-gray-200 last:border-r-0"},d(e),1)),64))]),t("div",R,[(i(!0),l(x,null,k(B.value,(e,c)=>(i(),l("div",{key:c,class:h(["min-h-[100px] lg:min-h-[120px] border-b border-r border-gray-200 last:border-r-0 p-2",{"bg-gray-50":!e.currentMonth,"bg-primary-50":e.isToday}])},[t("div",U,[t("span",{class:h(["text-sm font-medium",{"text-gray-400":!e.currentMonth,"text-primary-700":e.isToday,"text-gray-900":e.currentMonth&&!e.isToday}])},d(e.day),3),e.taskCount>0?(i(),l("span",W,d(e.taskCount),1)):C("",!0)]),t("div",X,[(i(!0),l(x,null,k(e.tasks.slice(0,2),r=>(i(),l("div",{key:r.id,onClick:a=>Y(r),class:h(["text-xs p-1 rounded cursor-pointer truncate",{"bg-primary-100 text-primary-700":r.status!=="completed","bg-gray-100 text-gray-500 line-through":r.status==="completed"}])},d(r.title),11,Z))),128)),e.tasks.length>2?(i(),l("div",tt," +"+d(e.tasks.length-2)+" ÐµÑ‰Ðµ ",1)):C("",!0)])],2))),128))])]),t("div",et,[s[4]||(s[4]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-3"},"Ð—Ð°Ð´Ð°Ñ‡Ð¸ Ð½Ð° Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ",-1)),z(F,{tasks:D.value,onTaskClick:Y,onToggleComplete:$},null,8,["tasks"])])])]))}};export{rt as default};
