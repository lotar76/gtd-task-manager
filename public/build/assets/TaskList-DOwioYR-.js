import{B as he,r as re,k as me,C as A,c as V,o as N,b as E,F as ie,y as ue,a as B,p as ne,w as pe,t as P,D as se,e as ye}from"./app-DjZzWwoi.js";import{u as ve}from"./workspace-BLzY3GDa.js";const je=he("tasks",()=>{const d=re([]),w=re(!1),D=re(localStorage.getItem("taskViewMode")||"list"),y=re({status:null,projectId:null,myTasks:!1}),h=ve(),t=me(()=>{var o;return(o=h.currentWorkspace)==null?void 0:o.id});return{tasks:d,loading:w,viewMode:D,filter:y,fetchInbox:async(o=!1)=>{if(t.value){w.value=!0;try{const l=o?{my_tasks:!0}:{},v=await A.get(`/v1/workspaces/${t.value}/inbox`,{params:l});d.value=v.data}finally{w.value=!1}}},fetchNextActions:async(o=!1)=>{if(t.value){w.value=!0;try{const l=o?{my_tasks:!0}:{},v=await A.get(`/v1/workspaces/${t.value}/next-actions`,{params:l});d.value=v.data}finally{w.value=!1}}},fetchWaiting:async(o=!1)=>{if(t.value){w.value=!0;try{const l=o?{my_tasks:!0}:{},v=await A.get(`/v1/workspaces/${t.value}/waiting`,{params:l});d.value=v.data}finally{w.value=!1}}},fetchSomeday:async(o=!1)=>{if(t.value){w.value=!0;try{const l=o?{my_tasks:!0}:{},v=await A.get(`/v1/workspaces/${t.value}/someday`,{params:l});d.value=v.data}finally{w.value=!1}}},fetchToday:async(o=!1)=>{if(t.value){w.value=!0;try{const l=o?{my_tasks:!0}:{},v=await A.get(`/v1/workspaces/${t.value}/today`,{params:l});d.value=v.data}finally{w.value=!1}}},fetchCalendar:async(o,l,v=!1)=>{if(t.value){w.value=!0;try{const O={start_date:o,end_date:l};v&&(O.my_tasks=!0);const x=await A.get(`/v1/workspaces/${t.value}/calendar`,{params:O});d.value=x.data}finally{w.value=!1}}},createTask:async o=>{if(!t.value)return;const l=await A.post(`/v1/workspaces/${t.value}/tasks`,o);return d.value.unshift(l.data),l.data},updateTask:async(o,l)=>{if(!t.value)return;const v=await A.put(`/v1/workspaces/${t.value}/tasks/${o}`,l),O=d.value.findIndex(x=>x.id===o);return O!==-1&&(d.value[O]=v.data),v.data},completeTask:async o=>{if(!t.value)return;const l=await A.post(`/v1/workspaces/${t.value}/tasks/${o}/complete`),v=d.value.findIndex(O=>O.id===o);return v!==-1&&(d.value[v]=l.data),l.data},deleteTask:async o=>{t.value&&(await A.delete(`/v1/workspaces/${t.value}/tasks/${o}`),d.value=d.value.filter(l=>l.id!==o))},setViewMode:o=>{D.value=o,localStorage.setItem("taskViewMode",o)}}});var ae=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ce(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var le={exports:{}};(function(d,w){(function(D,y){d.exports=y()})(ae,function(){var D=1e3,y=6e4,h=36e5,t="millisecond",M="second",j="minute",H="hour",m="day",$="week",_="month",I="quarter",T="year",c="date",Y="Invalid Date",z=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,o=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(a){var n=["th","st","nd","rd"],e=a%100;return"["+a+(n[(e-20)%10]||n[e]||n[0])+"]"}},v=function(a,n,e){var s=String(a);return!s||s.length>=n?a:""+Array(n+1-s.length).join(e)+a},O={s:v,z:function(a){var n=-a.utcOffset(),e=Math.abs(n),s=Math.floor(e/60),r=e%60;return(n<=0?"+":"-")+v(s,2,"0")+":"+v(r,2,"0")},m:function a(n,e){if(n.date()<e.date())return-a(e,n);var s=12*(e.year()-n.year())+(e.month()-n.month()),r=n.clone().add(s,_),i=e-r<0,u=n.clone().add(s+(i?-1:1),_);return+(-(s+(e-r)/(i?r-u:u-r))||0)},a:function(a){return a<0?Math.ceil(a)||0:Math.floor(a)},p:function(a){return{M:_,y:T,w:$,d:m,D:c,h:H,m:j,s:M,ms:t,Q:I}[a]||String(a||"").toLowerCase().replace(/s$/,"")},u:function(a){return a===void 0}},x="en",C={};C[x]=l;var q="$isDayjsObject",U=function(a){return a instanceof ee||!(!a||!a[q])},X=function a(n,e,s){var r;if(!n)return x;if(typeof n=="string"){var i=n.toLowerCase();C[i]&&(r=i),e&&(C[i]=e,r=i);var u=n.split("-");if(!r&&u.length>1)return a(u[0])}else{var p=n.name;C[p]=n,r=p}return!s&&r&&(x=r),r||!s&&x},k=function(a,n){if(U(a))return a.clone();var e=typeof n=="object"?n:{};return e.date=a,e.args=arguments,new ee(e)},f=O;f.l=X,f.i=U,f.w=function(a,n){return k(a,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var ee=function(){function a(e){this.$L=X(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[q]=!0}var n=a.prototype;return n.parse=function(e){this.$d=function(s){var r=s.date,i=s.utc;if(r===null)return new Date(NaN);if(f.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var u=r.match(z);if(u){var p=u[2]-1||0,g=(u[7]||"0").substring(0,3);return i?new Date(Date.UTC(u[1],p,u[3]||1,u[4]||0,u[5]||0,u[6]||0,g)):new Date(u[1],p,u[3]||1,u[4]||0,u[5]||0,u[6]||0,g)}}return new Date(r)}(e),this.init()},n.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},n.$utils=function(){return f},n.isValid=function(){return this.$d.toString()!==Y},n.isSame=function(e,s){var r=k(e);return this.startOf(s)<=r&&r<=this.endOf(s)},n.isAfter=function(e,s){return k(e)<this.startOf(s)},n.isBefore=function(e,s){return this.endOf(s)<k(e)},n.$g=function(e,s,r){return f.u(e)?this[s]:this.set(r,e)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(e,s){var r=this,i=!!f.u(s)||s,u=f.p(e),p=function(Z,L){var F=f.w(r.$u?Date.UTC(r.$y,L,Z):new Date(r.$y,L,Z),r);return i?F:F.endOf(m)},g=function(Z,L){return f.w(r.toDate()[Z].apply(r.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(L)),r)},b=this.$W,S=this.$M,W=this.$D,G="set"+(this.$u?"UTC":"");switch(u){case T:return i?p(1,0):p(31,11);case _:return i?p(1,S):p(0,S+1);case $:var J=this.$locale().weekStart||0,K=(b<J?b+7:b)-J;return p(i?W-K:W+(6-K),S);case m:case c:return g(G+"Hours",0);case H:return g(G+"Minutes",1);case j:return g(G+"Seconds",2);case M:return g(G+"Milliseconds",3);default:return this.clone()}},n.endOf=function(e){return this.startOf(e,!1)},n.$set=function(e,s){var r,i=f.p(e),u="set"+(this.$u?"UTC":""),p=(r={},r[m]=u+"Date",r[c]=u+"Date",r[_]=u+"Month",r[T]=u+"FullYear",r[H]=u+"Hours",r[j]=u+"Minutes",r[M]=u+"Seconds",r[t]=u+"Milliseconds",r)[i],g=i===m?this.$D+(s-this.$W):s;if(i===_||i===T){var b=this.clone().set(c,1);b.$d[p](g),b.init(),this.$d=b.set(c,Math.min(this.$D,b.daysInMonth())).$d}else p&&this.$d[p](g);return this.init(),this},n.set=function(e,s){return this.clone().$set(e,s)},n.get=function(e){return this[f.p(e)]()},n.add=function(e,s){var r,i=this;e=Number(e);var u=f.p(s),p=function(S){var W=k(i);return f.w(W.date(W.date()+Math.round(S*e)),i)};if(u===_)return this.set(_,this.$M+e);if(u===T)return this.set(T,this.$y+e);if(u===m)return p(1);if(u===$)return p(7);var g=(r={},r[j]=y,r[H]=h,r[M]=D,r)[u]||1,b=this.$d.getTime()+e*g;return f.w(b,this)},n.subtract=function(e,s){return this.add(-1*e,s)},n.format=function(e){var s=this,r=this.$locale();if(!this.isValid())return r.invalidDate||Y;var i=e||"YYYY-MM-DDTHH:mm:ssZ",u=f.z(this),p=this.$H,g=this.$m,b=this.$M,S=r.weekdays,W=r.months,G=r.meridiem,J=function(L,F,R,te){return L&&(L[F]||L(s,i))||R[F].slice(0,te)},K=function(L){return f.s(p%12||12,L,"0")},Z=G||function(L,F,R){var te=L<12?"AM":"PM";return R?te.toLowerCase():te};return i.replace(o,function(L,F){return F||function(R){switch(R){case"YY":return String(s.$y).slice(-2);case"YYYY":return f.s(s.$y,4,"0");case"M":return b+1;case"MM":return f.s(b+1,2,"0");case"MMM":return J(r.monthsShort,b,W,3);case"MMMM":return J(W,b);case"D":return s.$D;case"DD":return f.s(s.$D,2,"0");case"d":return String(s.$W);case"dd":return J(r.weekdaysMin,s.$W,S,2);case"ddd":return J(r.weekdaysShort,s.$W,S,3);case"dddd":return S[s.$W];case"H":return String(p);case"HH":return f.s(p,2,"0");case"h":return K(1);case"hh":return K(2);case"a":return Z(p,g,!0);case"A":return Z(p,g,!1);case"m":return String(g);case"mm":return f.s(g,2,"0");case"s":return String(s.$s);case"ss":return f.s(s.$s,2,"0");case"SSS":return f.s(s.$ms,3,"0");case"Z":return u}return null}(L)||u.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(e,s,r){var i,u=this,p=f.p(s),g=k(e),b=(g.utcOffset()-this.utcOffset())*y,S=this-g,W=function(){return f.m(u,g)};switch(p){case T:i=W()/12;break;case _:i=W();break;case I:i=W()/3;break;case $:i=(S-b)/6048e5;break;case m:i=(S-b)/864e5;break;case H:i=S/h;break;case j:i=S/y;break;case M:i=S/D;break;default:i=S}return r?i:f.a(i)},n.daysInMonth=function(){return this.endOf(_).$D},n.$locale=function(){return C[this.$L]},n.locale=function(e,s){if(!e)return this.$L;var r=this.clone(),i=X(e,s,!0);return i&&(r.$L=i),r},n.clone=function(){return f.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},a}(),oe=ee.prototype;return k.prototype=oe,[["$ms",t],["$s",M],["$m",j],["$H",H],["$W",m],["$M",_],["$y",T],["$D",c]].forEach(function(a){oe[a[1]]=function(n){return this.$g(n,a[0],a[1])}}),k.extend=function(a,n){return a.$i||(a(n,ee,k),a.$i=!0),k},k.locale=X,k.isDayjs=U,k.unix=function(a){return k(1e3*a)},k.en=C[x],k.Ls=C,k.p={},k})})(le);var de=le.exports;const Q=ce(de);var _e={exports:{}};(function(d,w){(function(D,y){d.exports=y(de)})(ae,function(D){function y(c){return c&&typeof c=="object"&&"default"in c?c:{default:c}}var h=y(D),t="января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_"),M="январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),j="янв._февр._мар._апр._мая_июня_июля_авг._сент._окт._нояб._дек.".split("_"),H="янв._февр._март_апр._май_июнь_июль_авг._сент._окт._нояб._дек.".split("_"),m=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function $(c,Y,z){var o,l;return z==="m"?Y?"минута":"минуту":c+" "+(o=+c,l={mm:Y?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"}[z].split("_"),o%10==1&&o%100!=11?l[0]:o%10>=2&&o%10<=4&&(o%100<10||o%100>=20)?l[1]:l[2])}var _=function(c,Y){return m.test(Y)?t[c.month()]:M[c.month()]};_.s=M,_.f=t;var I=function(c,Y){return m.test(Y)?j[c.month()]:H[c.month()]};I.s=H,I.f=j;var T={name:"ru",weekdays:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),weekdaysShort:"вск_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),months:_,monthsShort:I,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., H:mm",LLLL:"dddd, D MMMM YYYY г., H:mm"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:$,mm:$,h:"час",hh:$,d:"день",dd:$,M:"месяц",MM:$,y:"год",yy:$},ordinal:function(c){return c},meridiem:function(c){return c<4?"ночи":c<12?"утра":c<17?"дня":"вечера"}};return h.default.locale(T,null,!0),T})})(_e);var fe={exports:{}};(function(d,w){(function(D,y){d.exports=y()})(ae,function(){return function(D,y,h){D=D||{};var t=y.prototype,M={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function j(m,$,_,I){return t.fromToBase(m,$,_,I)}h.en.relativeTime=M,t.fromToBase=function(m,$,_,I,T){for(var c,Y,z,o=_.$locale().relativeTime||M,l=D.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],v=l.length,O=0;O<v;O+=1){var x=l[O];x.d&&(c=I?h(m).diff(_,x.d,!0):_.diff(m,x.d,!0));var C=(D.rounding||Math.round)(Math.abs(c));if(z=c>0,C<=x.r||!x.r){C<=1&&O>0&&(x=l[O-1]);var q=o[x.l];T&&(C=T(""+C)),Y=typeof q=="string"?q.replace("%d",C):q(C,$,x.l,z);break}}if($)return Y;var U=z?o.future:o.past;return typeof U=="function"?U(Y):U.replace("%s",Y)},t.to=function(m,$){return j(m,$,this,!0)},t.from=function(m,$){return j(m,$,this)};var H=function(m){return m.$u?h.utc():h()};t.toNow=function(m){return this.to(H(this),m)},t.fromNow=function(m){return this.from(H(this),m)}}})})(fe);var $e=fe.exports;const ge=ce($e),Me={class:"space-y-2"},we=["onClick"],xe={class:"flex items-start space-x-3"},ke=["onClick"],be={key:0,class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},De={class:"flex-1 min-w-0"},Se={key:0,class:"text-sm text-gray-500 mt-1 truncate"},Te={class:"flex flex-wrap items-center gap-2 mt-2"},Ye={key:2,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700"},Oe={key:0,class:"text-center py-12"},He={__name:"TaskList",props:{tasks:{type:Array,default:()=>[]}},emits:["task-click","toggle-complete"],setup(d){Q.extend(ge),Q.locale("ru");const w=y=>{const h=Q(y),t=Q();return h.isSame(t,"day")?"Сегодня":h.isSame(t.add(1,"day"),"day")?"Завтра":h.isBefore(t)?h.fromNow():h.format("D MMM")},D=y=>{if(y.status==="completed")return"bg-gray-100 text-gray-600";const h=Q(y.due_date),t=Q();return h.isBefore(t,"day")?"bg-red-100 text-red-700":h.isSame(t,"day")?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-600"};return(y,h)=>(N(),V("div",Me,[(N(!0),V(ie,null,ue(d.tasks,t=>(N(),V("div",{key:t.id,class:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow cursor-pointer",onClick:M=>y.$emit("task-click",t)},[B("div",xe,[B("button",{onClick:pe(M=>y.$emit("toggle-complete",t),["stop"]),class:ne(["mt-1 flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors",t.status==="completed"?"bg-primary-600 border-primary-600":"border-gray-300 hover:border-primary-500"])},[t.status==="completed"?(N(),V("svg",be,[...h[0]||(h[0]=[B("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)])])):E("",!0)],10,ke),B("div",De,[B("h3",{class:ne(["text-sm font-medium",t.status==="completed"?"text-gray-400 line-through":"text-gray-900"])},P(t.title),3),t.description?(N(),V("p",Se,P(t.description),1)):E("",!0),B("div",Te,[t.project?(N(),V("span",{key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:se({backgroundColor:t.project.color+"20",color:t.project.color})},P(t.project.name),5)):E("",!0),t.due_date?(N(),V("span",{key:1,class:ne(["inline-flex items-center px-2 py-1 rounded text-xs font-medium",D(t)])},[h[1]||(h[1]=B("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[B("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),ye(" "+P(w(t.due_date)),1)],2)):E("",!0),t.assignee?(N(),V("span",Ye,P(t.assignee.name),1)):E("",!0),t.context?(N(),V("span",{key:3,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:se({backgroundColor:t.context.color+"20",color:t.context.color})},P(t.context.name),5)):E("",!0),(N(!0),V(ie,null,ue(t.tags,M=>(N(),V("span",{key:M.id,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:se({backgroundColor:M.color+"20",color:M.color})},P(M.name),5))),128))])]),t.priority!=="medium"?(N(),V("div",{key:0,class:ne(["flex-shrink-0 w-2 h-2 rounded-full mt-2",{"bg-red-500":t.priority==="urgent","bg-orange-500":t.priority==="high","bg-blue-500":t.priority==="low"}])},null,2)):E("",!0)])],8,we))),128)),d.tasks.length?E("",!0):(N(),V("div",Oe,[...h[2]||(h[2]=[B("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[B("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),B("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Нет задач",-1),B("p",{class:"mt-1 text-sm text-gray-500"},"Создайте первую задачу чтобы начать",-1)])]))]))}};export{He as _,Q as d,je as u};
