import{r as g,s as E,c as n,o,a as e,w as B,b as f,d as S,t as h,f as H,y as P,v as j,p as M,i as z,u as K,k as T,B as G,e as J,F as O,C as W,L as A,M as Q,K as L,H as U,j as X,z as Y,l as V}from"./index-B82rmahJ.js";import{u as q}from"./workspace-BO8xjwdg.js";import{P as Z}from"./style-l0kSihDo.js";import{_ as ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as te}from"./lifeSpheres-DpNFy_cY.js";const re={class:"space-y-6"},ae={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},se={class:"flex items-center gap-2"},oe={class:"relative"},le={key:0,class:"absolute top-12 left-0 z-10 emoji-picker-mono"},ne={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},de={key:1,class:"text-green-600 dark:text-green-400 text-sm bg-green-50 dark:bg-green-900/20 p-3 rounded-lg"},ie=["disabled"],ue={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},ce={class:"flex items-center justify-between"},me=["disabled","aria-checked"],ve={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-red-200 dark:border-red-900/50 p-6"},pe=["disabled"],be={__name:"GeneralTab",props:{workspace:{type:Object,required:!0}},setup($){const m=$,y=z(),k=q(),l=g({name:"",emoji:"",description:"",faith_enabled:!0}),c=g(!1),d=g(!1),p=g(!1),x=g(""),u=g(""),_=g(!1),i=w=>{l.value.emoji=w.i,_.value=!1};E(()=>{m.workspace&&(l.value.name=m.workspace.name||"",l.value.emoji=m.workspace.emoji||"",l.value.description=m.workspace.description||"",l.value.faith_enabled=m.workspace.faith_enabled!==!1)});const t=async()=>{var w,a;x.value="",u.value="",c.value=!0;try{await k.updateWorkspace(m.workspace.id,l.value),u.value="Настройки сохранены"}catch(r){x.value=((a=(w=r.response)==null?void 0:w.data)==null?void 0:a.message)||"Ошибка сохранения"}finally{c.value=!1}},v=async()=>{var w,a;d.value=!0;try{l.value.faith_enabled=!l.value.faith_enabled,await k.updateWorkspace(m.workspace.id,{faith_enabled:l.value.faith_enabled})}catch(r){l.value.faith_enabled=!l.value.faith_enabled,x.value=((a=(w=r.response)==null?void 0:w.data)==null?void 0:a.message)||"Ошибка сохранения"}finally{d.value=!1}},C=async()=>{var w,a,r;if(confirm(`Удалить пространство "${(w=m.workspace)==null?void 0:w.name}"? Это действие необратимо.`)){p.value=!0;try{await k.deleteWorkspace(m.workspace.id),y.push("/")}catch(s){x.value=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.message)||"Ошибка удаления"}finally{p.value=!1}}};return(w,a)=>(o(),n("div",re,[e("div",ae,[a[5]||(a[5]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Основные",-1)),e("form",{onSubmit:B(t,["prevent"]),class:"space-y-4"},[e("div",null,[a[3]||(a[3]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Название ",-1)),e("div",se,[e("div",oe,[e("button",{type:"button",onClick:a[0]||(a[0]=r=>_.value=!_.value),class:"emoji-btn flex-shrink-0 w-10 h-10 flex items-center justify-center text-xl border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"Выбрать иконку"},h(l.value.emoji||"◆"),1),_.value?(o(),n("div",le,[H(P(Z),{native:!0,"disable-skin-tones":!0,"display-recent":!0,onSelect:i})])):f("",!0)]),S(e("input",{"onUpdate:modelValue":a[1]||(a[1]=r=>l.value.name=r),type:"text",class:"input flex-1",required:""},null,512),[[j,l.value.name]])])]),e("div",null,[a[4]||(a[4]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"}," Описание ",-1)),S(e("textarea",{"onUpdate:modelValue":a[2]||(a[2]=r=>l.value.description=r),class:"input",rows:"3",placeholder:"Описание пространства (необязательно)"},null,512),[[j,l.value.description]])]),x.value?(o(),n("div",ne,h(x.value),1)):f("",!0),u.value?(o(),n("div",de,h(u.value),1)):f("",!0),e("button",{type:"submit",disabled:c.value,class:"btn btn-primary"},h(c.value?"Сохранение...":"Сохранить"),9,ie)],32)]),e("div",ue,[e("div",ce,[a[6]||(a[6]=e("div",null,[e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Библейские стихи"),e("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," Показывать цитаты из Библии в Зеркале жизни ")],-1)),e("button",{type:"button",onClick:v,disabled:d.value,class:M(["relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800",l.value.faith_enabled?"bg-primary-600":"bg-gray-200 dark:bg-gray-600"]),role:"switch","aria-checked":l.value.faith_enabled},[e("span",{class:M(["pointer-events-none inline-block h-5 w-5 transform rounded-full bg-white shadow ring-0 transition duration-200 ease-in-out",l.value.faith_enabled?"translate-x-5":"translate-x-0"])},null,2)],10,me)])]),e("div",ve,[a[7]||(a[7]=e("h2",{class:"text-lg font-semibold text-red-600 dark:text-red-400 mb-2"},"Опасная зона",-1)),a[8]||(a[8]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mb-4"}," Удаление пространства приведёт к удалению всех задач, потоков и данных. ",-1)),e("button",{onClick:C,disabled:p.value,class:"px-4 py-2 text-sm font-medium text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-800 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/40 transition-colors"},h(p.value?"Удаление...":"Удалить пространство"),9,pe)])]))}},ge=ee(be,[["__scopeId","data-v-a13340b6"]]),ye={class:"space-y-6"},xe={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},ke=["disabled"],fe={key:0,class:"mt-3 text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},he={key:1,class:"mt-3 text-green-600 dark:text-green-400 text-sm bg-green-50 dark:bg-green-900/20 p-3 rounded-lg"},_e={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700"},we={class:"p-4 border-b border-gray-200 dark:border-gray-700"},$e={class:"text-lg font-semibold text-gray-900 dark:text-white"},Se={key:0,class:"text-sm font-normal text-gray-500 dark:text-gray-400"},Ce={key:0,class:"p-8 text-center"},je={key:1,class:"divide-y divide-gray-200 dark:divide-gray-700"},Me={class:"flex items-center space-x-3"},Te={class:"w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900/30 flex items-center justify-center text-sm font-medium text-primary-700 dark:text-primary-400"},Ue={class:"text-sm font-medium text-gray-900 dark:text-white"},Ve={class:"text-xs text-gray-500 dark:text-gray-400"},Be={class:"flex items-center space-x-3"},Le=["onClick"],Ee={__name:"MembersTab",props:{workspace:{type:Object,required:!0},canManage:{type:Boolean,default:!1}},setup($){const m=$,y=q(),k=K(),l=g([]),c=g(!0),d=g(!1),p=g(""),x=g(""),u=g({email:"",role:"member"}),_=T(()=>{var r;return(r=k.user)==null?void 0:r.id}),i=async()=>{var r;if((r=m.workspace)!=null&&r.id){c.value=!0;try{const s=await y.fetchMembers(m.workspace.id);l.value=s||[]}catch(s){console.error("Error loading members:",s)}finally{c.value=!1}}},t=async()=>{var r,s;p.value="",x.value="",d.value=!0;try{await y.addMember(m.workspace.id,u.value),x.value=`${u.value.email} добавлен`,u.value.email="",await i()}catch(b){p.value=((s=(r=b.response)==null?void 0:r.data)==null?void 0:s.message)||"Ошибка добавления"}finally{d.value=!1}},v=async r=>{if(confirm(`Удалить ${r.name} из пространства?`))try{await y.removeMember(m.workspace.id,r.id),await i()}catch(s){console.error("Error removing member:",s)}},C=r=>r?r.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,2):"?",w=r=>{const s={owner:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",admin:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",member:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",viewer:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"};return s[r]||s.member},a=r=>({owner:"Владелец",admin:"Админ",member:"Участник",viewer:"Просмотр"})[r]||r;return E(i),(r,s)=>(o(),n("div",ye,[$.canManage?(o(),n("div",xe,[s[3]||(s[3]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Добавить участника",-1)),e("form",{onSubmit:B(t,["prevent"]),class:"flex flex-col sm:flex-row gap-3"},[S(e("input",{"onUpdate:modelValue":s[0]||(s[0]=b=>u.value.email=b),type:"email",class:"input flex-1",placeholder:"Email пользователя",required:""},null,512),[[j,u.value.email]]),S(e("select",{"onUpdate:modelValue":s[1]||(s[1]=b=>u.value.role=b),class:"input w-full sm:w-36"},[...s[2]||(s[2]=[e("option",{value:"viewer"},"Просмотр",-1),e("option",{value:"member"},"Участник",-1),e("option",{value:"admin"},"Админ",-1)])],512),[[G,u.value.role]]),e("button",{type:"submit",disabled:d.value,class:"btn btn-primary whitespace-nowrap"},h(d.value?"...":"Добавить"),9,ke)],32),p.value?(o(),n("div",fe,h(p.value),1)):f("",!0),x.value?(o(),n("div",he,h(x.value),1)):f("",!0)])):f("",!0),e("div",_e,[e("div",we,[e("h2",$e,[s[4]||(s[4]=J(" Участники ",-1)),l.value.length>0?(o(),n("span",Se," ("+h(l.value.length)+") ",1)):f("",!0)])]),c.value?(o(),n("div",Ce,[...s[5]||(s[5]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):(o(),n("div",je,[(o(!0),n(O,null,W(l.value,b=>{var I,D,F,N,R;return o(),n("div",{key:b.id,class:"flex items-center justify-between p-4"},[e("div",Me,[e("div",Te,h(C(b.name)),1),e("div",null,[e("p",Ue,h(b.name),1),e("p",Ve,h(b.email),1)])]),e("div",Be,[e("span",{class:M(["px-2 py-1 text-xs font-medium rounded-full",w(((I=b.pivot)==null?void 0:I.role)||(b.id===((D=$.workspace)==null?void 0:D.owner_id)?"owner":"member"))])},h(a(((F=b.pivot)==null?void 0:F.role)||(b.id===((N=$.workspace)==null?void 0:N.owner_id)?"owner":"member"))),3),$.canManage&&b.id!==((R=$.workspace)==null?void 0:R.owner_id)&&b.id!==_.value?(o(),n("button",{key:0,onClick:ht=>v(b),class:"text-gray-400 hover:text-red-500 dark:hover:text-red-400 transition-colors",title:"Удалить"},[...s[6]||(s[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Le)):f("",!0)])])}),128))]))])]))}},qe={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Ie={class:"flex items-center justify-between mb-4"},De=["disabled"],Fe={key:0,class:"space-y-2 mb-4"},Ne=["value","onChange"],Re=["onBlur","onKeydown"],Ae=["onClick"],ze=["onClick"],Ke={key:1,class:"text-sm text-gray-500 dark:text-gray-400 mb-4"},Oe=["disabled"],We={key:2,class:"text-red-600 dark:text-red-400 text-sm mt-3"},He={__name:"SpheresTab",props:{workspace:{type:Object,required:!0}},setup($){const m=$,y=te(),k=g(!1),l=g(""),c=g(null),d=g(""),p=g(null),x=g({name:"",color:"#3B82F6"}),u=T(()=>y.allSpheres.filter(a=>a.workspace_id===m.workspace.id).sort((a,r)=>a.position-r.position)),_=a=>{c.value=a.id,d.value=a.name,Q(()=>{if(p.value){const r=Array.isArray(p.value)?p.value[0]:p.value;r==null||r.focus()}})},i=async a=>{const r=d.value.trim();if(!r){c.value=null;return}try{await y.update(m.workspace.id,a,{name:r})}catch{l.value="Ошибка при переименовании"}c.value=null},t=async(a,r)=>{try{await y.update(m.workspace.id,a,r)}catch{l.value="Ошибка при обновлении"}},v=async a=>{if(confirm(`Удалить сферу «${a.name}»? Цели останутся без сферы.`))try{await y.remove(m.workspace.id,a.id)}catch{l.value="Ошибка при удалении"}},C=async()=>{const a=x.value.name.trim();if(a){l.value="",k.value=!0;try{await y.create(m.workspace.id,{name:a,color:x.value.color,position:u.value.length}),x.value.name="",x.value.color="#3B82F6"}catch{l.value="Ошибка при создании"}finally{k.value=!1}}},w=async()=>{l.value="",k.value=!0;try{await y.seedDefaults(m.workspace.id)}catch{l.value="Ошибка при создании сфер по умолчанию"}finally{k.value=!1}};return(a,r)=>(o(),n("div",qe,[e("div",Ie,[r[4]||(r[4]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Сферы жизни",-1)),u.value.length===0?(o(),n("button",{key:0,onClick:w,disabled:k.value,class:"text-sm text-primary-600 hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300 transition-colors"}," Заполнить по умолчанию ",8,De)):f("",!0)]),u.value.length>0?(o(),n("div",Fe,[(o(!0),n(O,null,W(u.value,s=>(o(),n("div",{key:s.id,class:"flex items-center gap-3 group"},[e("input",{type:"color",value:s.color,onChange:b=>t(s.id,{color:b.target.value}),class:"w-7 h-7 rounded cursor-pointer border border-gray-300 dark:border-gray-600 p-0.5"},null,40,Ne),c.value===s.id?S((o(),n("input",{key:0,"onUpdate:modelValue":r[0]||(r[0]=b=>d.value=b),onBlur:b=>i(s.id),onKeydown:[A(b=>i(s.id),["enter"]),r[1]||(r[1]=A(b=>c.value=null,["escape"]))],ref_for:!0,ref_key:"sphereNameInput",ref:p,class:"input flex-1 text-sm py-1.5",autofocus:""},null,40,Re)),[[j,d.value]]):(o(),n("span",{key:1,onClick:b=>_(s),class:"flex-1 text-sm text-gray-900 dark:text-white cursor-pointer hover:text-primary-600 dark:hover:text-primary-400 transition-colors"},h(s.name),9,Ae)),e("button",{onClick:b=>v(s),class:"p-1 text-gray-300 dark:text-gray-600 hover:text-red-500 dark:hover:text-red-400 opacity-0 group-hover:opacity-100 transition-all",title:"Удалить сферу"},[...r[5]||(r[5]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ze)]))),128))])):k.value?f("",!0):(o(),n("div",Ke," Сферы не созданы. Нажмите «Заполнить по умолчанию» или добавьте вручную. ")),e("form",{onSubmit:B(C,["prevent"]),class:"flex items-center gap-2"},[S(e("input",{type:"color","onUpdate:modelValue":r[2]||(r[2]=s=>x.value.color=s),class:"w-7 h-7 rounded cursor-pointer border border-gray-300 dark:border-gray-600 p-0.5"},null,512),[[j,x.value.color]]),S(e("input",{"onUpdate:modelValue":r[3]||(r[3]=s=>x.value.name=s),type:"text",class:"input flex-1 text-sm py-1.5",placeholder:"Новая сфера..."},null,512),[[j,x.value.name]]),e("button",{type:"submit",disabled:!x.value.name.trim()||k.value,class:"p-1.5 text-primary-600 hover:text-primary-700 dark:text-primary-400 disabled:opacity-30 transition-colors"},[...r[6]||(r[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,Oe)],32),l.value?(o(),n("div",We,h(l.value),1)):f("",!0)]))}},Pe={key:0,class:"text-center py-12"},Ge={key:1,class:"space-y-6"},Je={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},Qe={key:0,class:"text-center py-6"},Xe={key:1,class:"text-center py-6"},Ye={key:0,class:"text-sm text-gray-400 dark:text-gray-500 mb-4"},Ze=["disabled"],et={key:2},tt={class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 mb-4"},rt=["href"],at={key:3},st={class:"flex items-center space-x-2 mb-6"},ot={key:0,class:"text-sm text-gray-400 dark:text-gray-500"},lt={class:"flex items-center justify-between"},nt={key:0,class:"ml-4"},dt={class:"flex items-center justify-between"},it={key:1,class:"ml-4"},ut={class:"flex items-center justify-between"},ct={key:2,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},mt={key:3,class:"text-green-600 dark:text-green-400 text-sm bg-green-50 dark:bg-green-900/20 p-3 rounded-lg"},vt={class:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700"},pt=["disabled"],bt={__name:"TelegramTab",props:{workspace:{type:Object,required:!0}},setup($){const m=g(!0),y=g(!1),k=g(""),l=g(""),c=g({bot_configured:!1,bot_username:null,subscribed:!1,is_active:!1,connect_url:null}),d=g({morning_digest_time:"08:00",reminder_minutes_before:30,notify_overdue:!0,notify_morning_digest:!0,notify_reminders:!0}),p=async()=>{m.value=!0;try{const t=(await U.get("/v1/telegram/subscription")).data;c.value={bot_configured:t.bot_configured,bot_username:t.bot_username||null,subscribed:t.subscribed||!1,is_active:t.is_active||!1,connect_url:t.connect_url||null},t.subscribed&&t.is_active&&(d.value={morning_digest_time:t.morning_digest_time||"08:00",reminder_minutes_before:t.reminder_minutes_before||30,notify_overdue:t.notify_overdue??!0,notify_morning_digest:t.notify_morning_digest??!0,notify_reminders:t.notify_reminders??!0})}catch(i){console.error("Error loading telegram data:",i)}finally{m.value=!1}},x=async()=>{var i,t;k.value="",y.value=!0;try{await U.post("/v1/telegram/subscription"),await p()}catch(v){k.value=((t=(i=v.response)==null?void 0:i.data)==null?void 0:t.message)||"Ошибка подписки"}finally{y.value=!1}},u=async()=>{var i,t;k.value="",l.value="",y.value=!0;try{await U.put("/v1/telegram/subscription",d.value),l.value="Настройки сохранены",setTimeout(()=>{l.value=""},3e3)}catch(v){k.value=((t=(i=v.response)==null?void 0:i.data)==null?void 0:t.message)||"Ошибка сохранения"}finally{y.value=!1}},_=async()=>{var i,t;if(confirm("Отключить Telegram уведомления?")){y.value=!0;try{await U.delete("/v1/telegram/subscription"),await p()}catch(v){k.value=((t=(i=v.response)==null?void 0:i.data)==null?void 0:t.message)||"Ошибка отключения"}finally{y.value=!1}}};return E(p),(i,t)=>(o(),n("div",null,[m.value?(o(),n("div",Pe,[...t[5]||(t[5]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):(o(),n("div",Ge,[e("div",Je,[t[19]||(t[19]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Telegram уведомления",-1)),c.value.bot_configured?c.value.subscribed?c.value.is_active?(o(),n("div",at,[e("div",st,[t[11]||(t[11]=e("span",{class:"w-2 h-2 bg-green-500 rounded-full"},null,-1)),t[12]||(t[12]=e("span",{class:"text-sm text-green-700 dark:text-green-400 font-medium"},"Telegram подключен",-1)),c.value.bot_username?(o(),n("span",ot," (@"+h(c.value.bot_username)+") ",1)):f("",!0)]),t[18]||(t[18]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mb-4"}," Уведомления приходят по задачам из всех ваших пространств. ",-1)),e("form",{onSubmit:B(u,["prevent"]),class:"space-y-4"},[e("div",lt,[t[13]||(t[13]=e("div",null,[e("label",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Утренний дайджест"),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Список задач на сегодня")],-1)),S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=v=>d.value.notify_morning_digest=v),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[L,d.value.notify_morning_digest]])]),d.value.notify_morning_digest?(o(),n("div",nt,[t[14]||(t[14]=e("label",{class:"block text-sm text-gray-600 dark:text-gray-400 mb-1"},"Время отправки",-1)),S(e("input",{"onUpdate:modelValue":t[1]||(t[1]=v=>d.value.morning_digest_time=v),type:"time",class:"input w-32"},null,512),[[j,d.value.morning_digest_time]])])):f("",!0),e("div",dt,[t[15]||(t[15]=e("div",null,[e("label",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Напоминания"),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Перед началом задачи")],-1)),S(e("input",{"onUpdate:modelValue":t[2]||(t[2]=v=>d.value.notify_reminders=v),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[L,d.value.notify_reminders]])]),d.value.notify_reminders?(o(),n("div",it,[t[16]||(t[16]=e("label",{class:"block text-sm text-gray-600 dark:text-gray-400 mb-1"},"За сколько минут",-1)),S(e("input",{"onUpdate:modelValue":t[3]||(t[3]=v=>d.value.reminder_minutes_before=v),type:"number",min:"5",max:"120",class:"input w-32"},null,512),[[j,d.value.reminder_minutes_before,void 0,{number:!0}]])])):f("",!0),e("div",ut,[t[17]||(t[17]=e("div",null,[e("label",{class:"text-sm font-medium text-gray-900 dark:text-white"},"Просроченные задачи"),e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Ежедневно в 09:00")],-1)),S(e("input",{"onUpdate:modelValue":t[4]||(t[4]=v=>d.value.notify_overdue=v),type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[L,d.value.notify_overdue]])]),k.value?(o(),n("div",ct,h(k.value),1)):f("",!0),l.value?(o(),n("div",mt,h(l.value),1)):f("",!0),e("div",vt,[e("button",{type:"submit",disabled:y.value,class:"btn btn-primary"},h(y.value?"Сохранение...":"Сохранить"),9,pt),e("button",{type:"button",onClick:_,class:"text-sm text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300"}," Отключить Telegram ")])],32)])):(o(),n("div",et,[e("div",tt,[t[9]||(t[9]=e("p",{class:"text-sm font-medium text-blue-800 dark:text-blue-300 mb-2"}," Перейдите по ссылке и нажмите Start: ",-1)),e("a",{href:c.value.connect_url,target:"_blank",class:"inline-flex items-center space-x-2 text-primary-600 dark:text-primary-400 hover:underline font-medium"},[...t[8]||(t[8]=[e("span",null,"Открыть в Telegram",-1),e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})],-1)])],8,rt)]),t[10]||(t[10]=e("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," После нажатия Start в Telegram, обновите эту страницу. ",-1)),e("div",{class:"mt-4 flex space-x-3"},[e("button",{onClick:p,class:"btn btn-secondary text-sm"}," Обновить статус "),e("button",{onClick:_,class:"text-sm text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300"}," Отменить ")])])):(o(),n("div",Xe,[t[7]||(t[7]=e("p",{class:"text-gray-600 dark:text-gray-400 mb-2"}," Подключите Telegram для получения уведомлений и управления задачами из всех ваших пространств. ",-1)),c.value.bot_username?(o(),n("p",Ye," Бот: @"+h(c.value.bot_username),1)):f("",!0),e("button",{onClick:x,disabled:y.value,class:"btn btn-primary"},h(y.value?"Подключение...":"Подключить Telegram"),9,Ze)])):(o(),n("div",Qe,[...t[6]||(t[6]=[e("svg",{class:"w-12 h-12 mx-auto mb-3 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})],-1),e("p",{class:"text-gray-500 dark:text-gray-400"}," Telegram бот не настроен. ",-1),e("p",{class:"text-sm text-gray-400 dark:text-gray-500 mt-1"}," Обратитесь к администратору. ",-1)])]))])]))]))}},gt={class:"p-4 lg:p-8"},yt={class:"max-w-3xl mx-auto"},xt={class:"text-2xl font-bold text-gray-900 dark:text-white mb-6"},kt={class:"border-b border-gray-200 dark:border-gray-700 mb-6"},ft={class:"flex space-x-6"},jt={__name:"Settings",setup($){const m=X(),y=z(),k=q(),l=K(),c=T(()=>parseInt(m.params.id)),d=T(()=>k.workspaces.find(_=>_.id===c.value)),p=T(()=>{var v,C,w;const _=d.value,i=(v=l.user)==null?void 0:v.id;if(!_||!i)return!1;if(_.owner_id===i)return!0;const t=(C=_.members)==null?void 0:C.find(a=>a.id===i);return((w=t==null?void 0:t.pivot)==null?void 0:w.role)==="admin"}),x=T(()=>p.value?"general":"members"),u=g(m.query.tab||x.value);return Y(u,_=>{y.replace({query:{...m.query,tab:_}})}),(_,i)=>{var t;return o(),n("div",gt,[e("div",yt,[e("h1",xt," Настройки — "+h(((t=d.value)==null?void 0:t.name)||"Пространство"),1),e("div",kt,[e("nav",ft,[p.value?(o(),n("button",{key:0,onClick:i[0]||(i[0]=v=>u.value="general"),class:M(["pb-3 text-sm font-medium border-b-2 transition-colors",u.value==="general"?"border-primary-600 text-primary-600 dark:text-primary-400 dark:border-primary-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"])}," Общие ",2)):f("",!0),p.value?(o(),n("button",{key:1,onClick:i[1]||(i[1]=v=>u.value="spheres"),class:M(["pb-3 text-sm font-medium border-b-2 transition-colors",u.value==="spheres"?"border-primary-600 text-primary-600 dark:text-primary-400 dark:border-primary-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"])}," Сферы жизни ",2)):f("",!0),e("button",{onClick:i[2]||(i[2]=v=>u.value="members"),class:M(["pb-3 text-sm font-medium border-b-2 transition-colors",u.value==="members"?"border-primary-600 text-primary-600 dark:text-primary-400 dark:border-primary-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"])}," Участники ",2),e("button",{onClick:i[3]||(i[3]=v=>u.value="telegram"),class:M(["pb-3 text-sm font-medium border-b-2 transition-colors",u.value==="telegram"?"border-primary-600 text-primary-600 dark:text-primary-400 dark:border-primary-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300"])}," Telegram ",2)])]),u.value==="general"&&p.value?(o(),V(ge,{key:c.value,workspace:d.value},null,8,["workspace"])):f("",!0),u.value==="spheres"&&p.value?(o(),V(He,{key:c.value,workspace:d.value},null,8,["workspace"])):f("",!0),u.value==="members"?(o(),V(Ee,{key:c.value,workspace:d.value,"can-manage":p.value},null,8,["workspace","can-manage"])):f("",!0),u.value==="telegram"?(o(),V(bt,{key:c.value,workspace:d.value},null,8,["workspace"])):f("",!0)])])}}};export{jt as default};
