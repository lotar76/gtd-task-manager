import{u as V,d as B,T as M}from"./TaskModal-CKlznka9.js";import{T as N}from"./TaskList-DBcBmOG5.js";import{T as S}from"./TaskView-Cv440rGc.js";import{r as j}from"./PlusIcon-DhhlLxZT.js";import{k as g,r as u,c,a,f as m,F as A,l as F,z as w,e as $,o as n}from"./index-B6HI204u.js";import"./workspace-Cm4YHt43.js";import"./projects-BsIMSTaO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"p-4 lg:p-8"},G={class:"max-w-4xl mx-auto"},L={key:0,class:"text-center py-12"},O={key:1,class:"text-center py-12"},q={class:"max-w-md mx-auto"},D={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-yellow-50 dark:bg-yellow-900/30 flex items-center justify-center"},Y={__name:"NextActions",setup(H){const l=V(),p=g(()=>l.nextActionTasks),T=g(()=>l.loading),o=u(!1),i=u(!1),s=u(null),d=u(""),y=t=>{s.value=t,i.value=!0},h=()=>{s.value=null,o.value=!0},b=()=>{i.value=!1,o.value=!0},_=async t=>{try{t.status==="completed"?await l.updateTask(t.id,{status:"next_action"}):await l.completeTask(t.id)}catch(e){console.error("Error toggling task:",e)}},C=async t=>{var e,k,x,f;d.value="";try{s.value?await l.updateTask(s.value.id,t):await l.createTask(t),o.value=!1,s.value=null}catch(r){console.error("Error saving task:",r);let v="Ошибка при сохранении задачи";(k=(e=r.response)==null?void 0:e.data)!=null&&k.errors?v=Object.values(r.response.data.errors).flat().join(", "):(f=(x=r.response)==null?void 0:x.data)!=null&&f.message&&(v=r.response.data.message),d.value=v}},E=()=>{o.value=!1,s.value=null,d.value=""};return(t,e)=>(n(),c("div",z,[a("div",G,[e[5]||(e[5]=a("div",{class:"mb-6"},[a("h1",{class:"text-xl lg:text-2xl font-semibold text-gray-900 dark:text-white"},"Следующие действия")],-1)),T.value?(n(),c("div",L,[...e[1]||(e[1]=[a("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):(n(),c(A,{key:1},[p.value.length>0?(n(),F(N,{key:0,tasks:p.value,onTaskClick:y,onToggleComplete:_},null,8,["tasks"])):(n(),c("div",O,[a("div",q,[a("div",D,[m(w(B),{class:"w-8 h-8 text-yellow-500"})]),e[3]||(e[3]=a("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"Нет следующих действий",-1)),e[4]||(e[4]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-6 leading-relaxed"}," Следующие действия — это ключевой список GTD. Сюда попадают конкретные физические действия, которые можно выполнить прямо сейчас, без привязки к дате. Спросите себя: «Какой следующий конкретный шаг?» — и запишите его сюда. ",-1)),a("button",{onClick:h,class:"inline-flex items-center px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-lg hover:bg-primary-700 transition-colors"},[m(w(j),{class:"w-5 h-5 mr-1.5"}),e[2]||(e[2]=$(" Добавить действие ",-1))])])]))],64)),m(S,{show:i.value,task:s.value,onClose:e[0]||(e[0]=k=>{i.value=!1,s.value=null}),onEnterEdit:b},null,8,["show","task"]),m(M,{show:o.value,task:s.value,"server-error":d.value,onClose:E,onSubmit:C},null,8,["show","task","server-error"])])]))}};export{Y as default};
