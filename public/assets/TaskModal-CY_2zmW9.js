import{E as ye,r as w,k as v,H as N,c as u,a as t,o as i,z as T,s as be,x as fe,l as le,f as ke,g as we,b as D,w as W,t as k,d as Z,v as A,m as se,F,C as K,p as $,e as ne,K as ie,T as xe,A as he,j as _e}from"./index-CnkTNq8J.js";import{u as pe}from"./workspace-DnamxNfV.js";import{u as Ce}from"./projects-CEoyNY3i.js";import{u as je}from"./lifeSpheres-BNGfdyGE.js";import{u as Se}from"./goals-CNAspvLr.js";import{_ as $e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Tt=ye("tasks",()=>{const n=w([]),g=w(!1),_=w(!1),R=w(localStorage.getItem("taskViewMode")||"list"),M=pe(),q=v(()=>M.selectedWorkspaces.map(l=>l.id)),m=v(()=>{const l=q.value;return l.length?n.value.filter(s=>l.includes(s.workspace_id)&&!s.completed_at):[]}),O=v(()=>m.value.filter(l=>l.status==="inbox")),E=v(()=>m.value.filter(l=>l.status==="next_action")),J=v(()=>m.value.filter(l=>l.status==="today")),V=v(()=>m.value.filter(l=>l.status==="tomorrow")),Q=v(()=>m.value.filter(l=>l.status==="waiting")),z=v(()=>m.value.filter(l=>l.status==="someday")),X=v(()=>m.value.filter(l=>l.status==="scheduled")),H=v(()=>{const l=q.value;return l.length?n.value.filter(s=>l.includes(s.workspace_id)&&s.completed_at).sort((s,d)=>new Date(d.completed_at||d.updated_at)-new Date(s.completed_at||s.updated_at)).slice(0,20):[]}),te=v(()=>({inbox:O.value.length,next_actions:E.value.length,today:J.value.length,tomorrow:V.value.length,waiting:Q.value.length,someday:z.value.length,scheduled:X.value.length})),Y=(l,s)=>m.value.filter(d=>{if(!d.due_date)return!1;const c=d.due_date.substring(0,10);return c>=l&&c<=s}),G=async({force:l=!1}={})=>{var s;if(!(_.value&&!l)){g.value=!0;try{const d=await N.get("/v1/tasks");n.value=((s=d.data.data)==null?void 0:s.tasks)||d.data.tasks||d.data||[],_.value=!0}finally{g.value=!1}}},U=l=>{const s={...l};return s.estimated_time===""&&(s.estimated_time=null),s.due_date===""&&(s.due_date=null),s.description===""&&(s.description=null),(s.project_id===""||s.project_id===null)&&(s.project_id=null),s},o=async l=>{var x;const s=(l==null?void 0:l.workspace_id)||((x=M.currentWorkspace)==null?void 0:x.id);if(!s){console.error("Cannot create task: workspace_id not found");return}const d=U(l);d.workspace_id=s;const c=await N.post(`/v1/workspaces/${s}/tasks`,d),b=c.data.data||c.data;return n.value.unshift(b),b},P=async(l,s)=>{var oe;const d=n.value.find(ee=>ee.id===l),c=(s==null?void 0:s.workspace_id)||(d==null?void 0:d.workspace_id)||((oe=M.currentWorkspace)==null?void 0:oe.id);if(!c){console.error("Cannot update task: workspace_id not found");return}const b=U(s),x=await N.put(`/v1/workspaces/${c}/tasks/${l}`,b),p=x.data.data||x.data,I=n.value.findIndex(ee=>ee.id===l);return I!==-1&&(n.value[I]=p),p},S=async l=>{var x;const s=n.value.findIndex(p=>p.id===l);if(s===-1)return;const d=n.value[s],c=d.workspace_id||((x=M.currentWorkspace)==null?void 0:x.id);if(!c){console.error("Cannot complete task: workspace_id not found");return}const b={...d};n.value[s]={...d,completed_at:new Date().toISOString()};try{const p=await N.post(`/v1/workspaces/${c}/tasks/${l}/complete`),I=p.data.data||p.data;n.value[s]=I}catch(p){throw n.value[s]=b,p}},B=async l=>{var x;const s=n.value.findIndex(p=>p.id===l);if(s===-1)return;const d=n.value[s],c=d.workspace_id||((x=M.currentWorkspace)==null?void 0:x.id);if(!c){console.error("Cannot uncomplete task: workspace_id not found");return}const b={...d};n.value[s]={...d,completed_at:null};try{const p=await N.post(`/v1/workspaces/${c}/tasks/${l}/uncomplete`),I=p.data.data||p.data;n.value[s]=I}catch(p){throw n.value[s]=b,p}},C=async l=>{var c;const s=n.value.find(b=>b.id===l),d=(s==null?void 0:s.workspace_id)||((c=M.currentWorkspace)==null?void 0:c.id);if(!d){console.error("Cannot delete task: workspace_id not found");return}await N.delete(`/v1/workspaces/${d}/tasks/${l}`),n.value=n.value.filter(b=>b.id!==l)},j=l=>{R.value=l,localStorage.setItem("taskViewMode",l)};let y=null;return{allTasks:n,loading:g,loaded:_,filteredTasks:m,inboxTasks:O,nextActionTasks:E,todayTasks:J,tomorrowTasks:V,waitingTasks:Q,somedayTasks:z,scheduledTasks:X,archivedTasks:H,counts:te,calendarTasks:Y,viewMode:R,fetchAllTasks:G,createTask:o,updateTask:P,completeTask:S,uncompleteTask:B,deleteTask:C,setViewMode:j,startSync:()=>{y=setInterval(()=>G({force:!0}),5*60*1e3)},stopSync:()=>{y&&clearInterval(y)}}});function Me(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"})])}function Te(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"})])}function Ve(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"})])}function Be(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"})])}function Vt(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5m-9-6h.008v.008H12v-.008ZM12 15h.008v.008H12V15Zm0 2.25h.008v.008H12v-.008ZM9.75 15h.008v.008H9.75V15Zm0 2.25h.008v.008H9.75v-.008ZM7.5 15h.008v.008H7.5V15Zm0 2.25h.008v.008H7.5v-.008Zm6.75-4.5h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V15Zm0 2.25h.008v.008h-.008v-.008Zm2.25-4.5h.008v.008H16.5v-.008Zm0 2.25h.008v.008H16.5V15Z"})])}function de(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})])}function Ie(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function De(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}function He(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.218a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859m-19.5.338V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H6.911a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661Z"})])}function Le(n,g){return i(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 12h14"})])}const Ze={class:"flex min-h-screen items-center justify-center p-4"},Ae={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Oe={class:"text-xl font-semibold text-gray-900 dark:text-white"},Ee={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Pe={class:"md:col-span-2"},ze={class:"relative"},Ge={class:"flex items-center space-x-2"},Ue={key:0,class:"absolute z-10 mt-1 w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg"},Ne=["onClick"],We={class:"flex gap-2 justify-end"},Fe=["onClick","title"],Ke={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Re={key:0},qe={class:"flex flex-wrap gap-2"},Je=["onClick"],Qe={key:0,class:"mr-1"},Xe={class:"grid grid-cols-3 gap-4 relative"},Ye={key:0,class:"mr-1"},et={class:"relative bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl p-3 max-h-[70vh] overflow-y-auto w-full max-w-lg"},tt={class:"mb-3 pb-3 border-b border-gray-200 dark:border-gray-600 mt-6"},rt={class:"flex gap-2"},ot=["disabled"],at={class:"flex flex-wrap gap-2"},lt=["onClick"],st={class:"relative bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl p-3 max-h-[70vh] overflow-y-auto w-full max-w-lg"},nt={class:"mb-3 pb-3 border-b border-gray-200 dark:border-gray-600 mt-6"},it={class:"flex gap-2"},dt=["disabled"],ut={class:"flex flex-wrap gap-2"},ct=["onClick"],vt={key:0,class:"mr-1"},pt={class:"relative bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg shadow-xl p-3 max-h-[70vh] overflow-y-auto w-full max-w-lg"},gt={class:"mb-3 pb-3 border-b border-gray-200 dark:border-gray-600 mt-6"},mt={class:"flex gap-2"},yt=["disabled"],bt={class:"flex flex-wrap gap-2"},ft=["onClick"],kt={key:1,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},wt={class:"flex justify-end space-x-3 pt-4"},xt=["disabled"],ht={__name:"TaskModal",props:{show:{type:Boolean,default:!1},task:{type:Object,default:null},serverError:{type:String,default:""},defaultDate:{type:String,default:""}},emits:["close","submit"],setup(n,{emit:g}){const _=n,R=g,M=_e(),q=pe(),m=Ce(),O=je(),E=Se(),J=v(()=>q.workspaces),V=v(()=>q.currentWorkspace),Q=v(()=>{const r=o.value.workspace_id;return r?m.allProjects.filter(e=>e.workspace_id===r&&(e.status==="active"||!e.status)):[]}),z=v(()=>o.value.project_id?Q.value.find(r=>r.id===o.value.project_id):null),X=v(()=>{const r=o.value.workspace_id;return r?O.allSpheres.filter(e=>e.workspace_id===r):[]}),H=v(()=>o.value.life_sphere_id?X.value.find(r=>r.id===o.value.life_sphere_id):null),te=v(()=>{const r=o.value.workspace_id;return r?E.allGoals.filter(e=>e.workspace_id===r&&(e.status==="active"||!e.status)):[]}),Y=v(()=>o.value.goal_id?te.value.find(r=>r.id===o.value.goal_id):null),G=()=>{const r=M.path;return r.includes("/inbox")?"inbox":r.includes("/today")?"today":r.includes("/next-actions")?"next_action":r.includes("/tomorrow")?"tomorrow":r.includes("/waiting")?"waiting":r.includes("/someday")?"someday":"inbox"},U=()=>{const r=M.path;if(r.includes("/today"))return new Date().toISOString().split("T")[0];if(r.includes("/tomorrow")){const e=new Date;return e.setDate(e.getDate()+1),e.toISOString().split("T")[0]}return""},o=w({title:"",description:"",status:"inbox",priority:"medium",due_date:"",estimated_time:"",end_time:"",workspace_id:null,project_id:null,goal_id:null,life_sphere_id:null,completed_at:null}),P=w(!1),S=w(""),B=w(!1),C=w(!1),j=w(!1),y=w(!1),re=w(null),L=w(""),l=w(""),s=w(""),d=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e"],c=()=>d[Math.floor(Math.random()*d.length)],b=async()=>{if(L.value.trim())try{const r=await m.createProject({name:L.value.trim(),workspace_id:o.value.workspace_id,color:c(),status:"active"});o.value.project_id=r.id,C.value=!1,L.value=""}catch(r){console.error("Error creating project:",r),S.value="Ошибка при создании потока"}},x=async()=>{if(l.value.trim())try{const r=await O.create(o.value.workspace_id,{name:l.value.trim(),color:c()});o.value.life_sphere_id=r.id,j.value=!1,l.value=""}catch(r){console.error("Error creating sphere:",r),S.value="Ошибка при создании сферы"}},p=async()=>{if(s.value.trim())try{const r=await E.createGoal({name:s.value.trim(),workspace_id:o.value.workspace_id,color:c(),status:"active"});o.value.goal_id=r.id,y.value=!1,s.value=""}catch(r){console.error("Error creating goal:",r),S.value="Ошибка при создании цели"}},I={inbox:{label:"Входящие",icon:He},next_action:{label:"Следующие",icon:Be},today:{label:"Сегодня",icon:de},tomorrow:{label:"Завтра",icon:de},waiting:{label:"Ожидание",icon:Ie},someday:{label:"Когда-нибудь",icon:Me},scheduled:{label:"Запланировано",icon:de}},oe={low:{label:"Низкий",icon:Te,color:"text-gray-500"},medium:{label:"Средний",icon:Le,color:"text-blue-500"},high:{label:"Высокий",icon:Ve,color:"text-orange-500"},urgent:{label:"Срочный",icon:De,color:"text-red-500"}},ee=r=>{if(o.value.status=r,B.value=!1,r==="today"){const e=new Date;o.value.due_date=e.toISOString().split("T")[0]}else if(r==="tomorrow"){const e=new Date;e.setDate(e.getDate()+1),o.value.due_date=e.toISOString().split("T")[0]}};v(()=>!!o.value.completed_at);const ge=r=>r?/^\d{4}-\d{2}-\d{2}$/.test(r)?r:r.split("T")[0]:"",ue=r=>r?/^\d{2}:\d{2}$/.test(r)?r:r.substring(0,5):"";T(()=>_.task,(r,e)=>{var f,a,h;if(e&&!r){o.value={title:"",description:"",status:"inbox",priority:"medium",due_date:"",estimated_time:"",end_time:"",workspace_id:(f=V.value)==null?void 0:f.id,project_id:null,goal_id:null,life_sphere_id:null,completed_at:null},re.value=null,S.value="",B.value=!1;return}if(r)o.value={title:r.title||"",description:r.description||"",status:r.status||"inbox",priority:r.priority||"medium",due_date:ge(r.due_date),estimated_time:ue(r.estimated_time),end_time:ue(r.end_time),workspace_id:r.workspace_id||((a=V.value)==null?void 0:a.id),project_id:r.project_id||null,goal_id:r.goal_id||null,life_sphere_id:r.life_sphere_id||null,completed_at:r.completed_at||null};else{const ae=G();re.value=ae,o.value={title:"",description:"",status:ae,priority:"medium",due_date:U(),estimated_time:"",end_time:"",workspace_id:(h=V.value)==null?void 0:h.id,project_id:null,goal_id:null,life_sphere_id:null,completed_at:null}}S.value="",B.value=!1},{immediate:!0}),T(()=>_.serverError,r=>{S.value=r,r&&(P.value=!1)}),T(()=>_.show,r=>{var e,f,a;r?_.task?o.value.workspace_id||(o.value.workspace_id=(f=V.value)==null?void 0:f.id):(o.value.workspace_id=(e=V.value)==null?void 0:e.id,o.value.status=G(),o.value.due_date=_.defaultDate||U()):(o.value={title:"",description:"",status:"inbox",priority:"medium",due_date:"",estimated_time:"",end_time:"",workspace_id:(a=V.value)==null?void 0:a.id,project_id:null,goal_id:null,life_sphere_id:null,completed_at:null},re.value=null,B.value=!1,C.value=!1,j.value=!1,y.value=!1,P.value=!1,S.value="")}),T(()=>_.show,r=>{r&&(m.loaded||m.fetchAllProjects(),O.loaded||O.fetchAll(),E.loaded||E.fetchAllGoals())}),T(()=>M.path,()=>{if(!_.task){o.value.status=G();const r=U();(r||M.path.includes("/today"))&&(o.value.due_date=r)}}),T(()=>{var r;return(r=V.value)==null?void 0:r.id},r=>{!_.task&&r&&(o.value.workspace_id=r)}),T(C,r=>{r||(L.value="")}),T(j,r=>{r||(l.value="")}),T(y,r=>{r||(s.value="")}),T(()=>o.value.workspace_id,(r,e)=>{if(!(!e||r===e)&&o.value.project_id){const f=m.allProjects.find(a=>a.id===o.value.project_id);f&&f.workspace_id!==r&&(o.value.project_id=null)}}),T(()=>o.value.due_date,r=>{if(!r||o.value.completed_at)return;const e=new Date().toISOString().split("T")[0],f=new Date;f.setDate(f.getDate()+1);const a=f.toISOString().split("T")[0];r===e?o.value.status="today":r===a?o.value.status="tomorrow":["today","tomorrow","completed"].includes(o.value.status)||(o.value.status="scheduled")});const me=()=>{S.value="",P.value=!0,R("submit",o.value)},ce=r=>{r.target.closest(".relative")||(B.value=!1,C.value=!1,j.value=!1,y.value=!1)},ve=r=>{r.key==="Escape"&&_.show&&R("close")};return be(()=>{document.addEventListener("click",ce),document.addEventListener("keydown",ve)}),fe(()=>{document.removeEventListener("click",ce),document.removeEventListener("keydown",ve)}),(r,e)=>(i(),le(he,{to:"body"},[ke(xe,{name:"modal"},{default:we(()=>{var f;return[n.show?(i(),u("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:e[24]||(e[24]=W(a=>r.$emit("close"),["self"]))},[e[47]||(e[47]=t("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),t("div",Ze,[t("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-auto",onClick:e[23]||(e[23]=W(()=>{},["stop"]))},[t("div",Ae,[t("h3",Oe,k((f=n.task)!=null&&f.id?"Редактировать задачу":"Новая задача"),1),t("button",{onClick:e[0]||(e[0]=a=>r.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...e[25]||(e[25]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),t("form",{onSubmit:W(me,["prevent"]),class:"p-6 space-y-4"},[t("div",null,[e[26]||(e[26]=t("label",{for:"title",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название задачи * ",-1)),Z(t("input",{id:"title","onUpdate:modelValue":e[1]||(e[1]=a=>o.value.title=a),type:"text",required:"",class:"w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400",placeholder:"Введите название задачи"},null,512),[[A,o.value.title]])]),t("div",null,[e[27]||(e[27]=t("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),Z(t("textarea",{id:"description","onUpdate:modelValue":e[2]||(e[2]=a=>o.value.description=a),rows:"3",class:"w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400 resize-none",placeholder:"Добавьте описание"},null,512),[[A,o.value.description]])]),t("div",Ee,[t("div",Pe,[e[29]||(e[29]=t("label",{for:"status",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Статус ",-1)),t("div",ze,[t("button",{type:"button",onClick:e[3]||(e[3]=a=>B.value=!B.value),class:"w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400 flex items-center justify-between"},[t("span",Ge,[(i(),le(se(I[o.value.status].icon),{class:"w-5 h-5 text-gray-500 dark:text-gray-400"})),t("span",null,k(I[o.value.status].label),1)]),e[28]||(e[28]=t("svg",{class:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),B.value?(i(),u("div",Ue,[(i(),u(F,null,K(I,(a,h)=>t("button",{key:h,type:"button",onClick:ae=>ee(h),class:$(["w-full flex items-center space-x-2 px-3 py-2 text-sm hover:bg-gray-50 dark:hover:bg-gray-600 first:rounded-t-lg last:rounded-b-lg transition-colors",o.value.status===h?"bg-primary-50 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-gray-300"])},[(i(),le(se(a.icon),{class:"w-5 h-5"})),t("span",null,k(a.label),1)],10,Ne)),64))])):D("",!0)])]),t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Приоритет ",-1)),t("div",We,[(i(),u(F,null,K(oe,(a,h)=>t("button",{key:h,type:"button",onClick:ae=>o.value.priority=h,title:a.label,class:$(["p-2 rounded-lg transition-all border-2",o.value.priority===h?"bg-white dark:bg-gray-700 border-current shadow-sm":"border-transparent hover:bg-gray-100 dark:hover:bg-gray-700",a.color])},[(i(),le(se(a.icon),{class:"w-5 h-5"}))],10,Fe)),64))])])]),t("div",Ke,[t("div",null,[e[31]||(e[31]=t("label",{for:"due_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Срок выполнения ",-1)),Z(t("input",{id:"due_date","onUpdate:modelValue":e[4]||(e[4]=a=>o.value.due_date=a),type:"date",class:"w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400"},null,512),[[A,o.value.due_date]])]),t("div",null,[e[32]||(e[32]=t("label",{for:"estimated_time",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Время начала ",-1)),Z(t("input",{id:"estimated_time","onUpdate:modelValue":e[5]||(e[5]=a=>o.value.estimated_time=a),type:"time",class:"w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400",placeholder:"12:30"},null,512),[[A,o.value.estimated_time]])]),t("div",null,[e[33]||(e[33]=t("label",{for:"end_time",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Время окончания ",-1)),Z(t("input",{id:"end_time","onUpdate:modelValue":e[6]||(e[6]=a=>o.value.end_time=a),type:"time",class:"w-full px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400",placeholder:"13:30"},null,512),[[A,o.value.end_time]])])]),J.value.length>1?(i(),u("div",Re,[e[34]||(e[34]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Рабочее пространство ",-1)),t("div",qe,[(i(!0),u(F,null,K(J.value,a=>(i(),u("button",{key:a.id,type:"button",onClick:h=>o.value.workspace_id=a.id,class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",o.value.workspace_id===a.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[a.emoji?(i(),u("span",Qe,k(a.emoji),1)):D("",!0),ne(k(a.name),1)],10,Je))),128))])])):D("",!0),t("div",Xe,[t("div",null,[e[35]||(e[35]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Поток ",-1)),t("button",{type:"button",onClick:e[7]||(e[7]=a=>C.value=!C.value),class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors w-full",z.value?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},k(z.value?z.value.name:"Без потока"),3)]),t("div",null,[e[36]||(e[36]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Сфера жизни ",-1)),t("button",{type:"button",onClick:e[8]||(e[8]=a=>j.value=!j.value),class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors w-full",H.value?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},[H.value&&H.value.emoji?(i(),u("span",Ye,k(H.value.emoji),1)):D("",!0),ne(" "+k(H.value?H.value.name:"Без сферы"),1)],2)]),t("div",null,[e[37]||(e[37]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Цель ",-1)),t("button",{type:"button",onClick:e[9]||(e[9]=a=>y.value=!y.value),class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors w-full",Y.value?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"])},k(Y.value?Y.value.name:"Без цели"),3)]),C.value?(i(),u("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-12",onClick:e[13]||(e[13]=W(a=>C.value=!1,["self"]))},[e[40]||(e[40]=t("div",{class:"absolute inset-0 bg-black bg-opacity-30"},null,-1)),t("div",et,[t("button",{type:"button",onClick:e[10]||(e[10]=a=>C.value=!1),class:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...e[38]||(e[38]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),t("div",tt,[t("div",rt,[Z(t("input",{"onUpdate:modelValue":e[11]||(e[11]=a=>L.value=a),type:"text",placeholder:"Создать новый поток...",onKeypress:ie(b,["enter"]),class:"flex-1 text-sm px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400"},null,544),[[A,L.value]]),t("button",{type:"button",onClick:b,disabled:!L.value.trim(),class:"p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[...e[39]||(e[39]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,ot)])]),t("div",at,[t("button",{type:"button",onClick:e[12]||(e[12]=a=>{o.value.project_id=null,C.value=!1}),class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",o.value.project_id?"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500":"bg-primary-600 text-white"])}," Без потока ",2),(i(!0),u(F,null,K(Q.value,a=>(i(),u("button",{key:a.id,type:"button",onClick:h=>{o.value.project_id=a.id,C.value=!1},class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",o.value.project_id===a.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"])},k(a.name),11,lt))),128))])])])):D("",!0),j.value?(i(),u("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center p-12",onClick:e[17]||(e[17]=W(a=>j.value=!1,["self"]))},[e[43]||(e[43]=t("div",{class:"absolute inset-0 bg-black bg-opacity-30"},null,-1)),t("div",st,[t("button",{type:"button",onClick:e[14]||(e[14]=a=>j.value=!1),class:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...e[41]||(e[41]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),t("div",nt,[t("div",it,[Z(t("input",{"onUpdate:modelValue":e[15]||(e[15]=a=>l.value=a),type:"text",placeholder:"Создать новую сферу...",onKeypress:ie(x,["enter"]),class:"flex-1 text-sm px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400"},null,544),[[A,l.value]]),t("button",{type:"button",onClick:x,disabled:!l.value.trim(),class:"p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[...e[42]||(e[42]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,dt)])]),t("div",ut,[t("button",{type:"button",onClick:e[16]||(e[16]=a=>{o.value.life_sphere_id=null,j.value=!1}),class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",o.value.life_sphere_id?"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500":"bg-primary-600 text-white"])}," Без сферы ",2),(i(!0),u(F,null,K(X.value,a=>(i(),u("button",{key:a.id,type:"button",onClick:h=>{o.value.life_sphere_id=a.id,j.value=!1},class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",o.value.life_sphere_id===a.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"])},[a.emoji?(i(),u("span",vt,k(a.emoji),1)):D("",!0),ne(" "+k(a.name),1)],10,ct))),128))])])])):D("",!0),y.value?(i(),u("div",{key:2,class:"fixed inset-0 z-50 flex items-center justify-center p-12",onClick:e[21]||(e[21]=W(a=>y.value=!1,["self"]))},[e[46]||(e[46]=t("div",{class:"absolute inset-0 bg-black bg-opacity-30"},null,-1)),t("div",pt,[t("button",{type:"button",onClick:e[18]||(e[18]=a=>y.value=!1),class:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...e[44]||(e[44]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),t("div",gt,[t("div",mt,[Z(t("input",{"onUpdate:modelValue":e[19]||(e[19]=a=>s.value=a),type:"text",placeholder:"Создать новую цель...",onKeypress:ie(p,["enter"]),class:"flex-1 text-sm px-3 py-2 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 focus:outline-none focus:border-primary-500 dark:focus:border-primary-400"},null,544),[[A,s.value]]),t("button",{type:"button",onClick:p,disabled:!s.value.trim(),class:"p-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},[...e[45]||(e[45]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])],8,yt)])]),t("div",bt,[t("button",{type:"button",onClick:e[20]||(e[20]=a=>{o.value.goal_id=null,y.value=!1}),class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",o.value.goal_id?"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500":"bg-primary-600 text-white"])}," Без цели ",2),(i(!0),u(F,null,K(te.value,a=>(i(),u("button",{key:a.id,type:"button",onClick:h=>{o.value.goal_id=a.id,y.value=!1},class:$(["px-3 py-1.5 text-sm font-medium rounded-lg transition-colors",o.value.goal_id===a.id?"bg-primary-600 text-white":"bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-500"])},k(a.name),11,ft))),128))])])])):D("",!0)]),S.value?(i(),u("div",kt,k(S.value),1)):D("",!0),t("div",wt,[t("button",{type:"button",onClick:e[22]||(e[22]=a=>r.$emit("close")),class:"btn btn-secondary"}," Отмена "),t("button",{type:"submit",disabled:P.value,class:"btn btn-primary"},k(P.value?"Сохранение...":"Сохранить"),9,xt)])],32)])])])):D("",!0)]}),_:1})]))}},Bt=$e(ht,[["__scopeId","data-v-ccf68834"]]);export{Bt as T,Vt as a,Ie as b,de as c,Be as d,He as e,De as f,Me as r,Tt as u};
