import{u as _,T as x}from"./TaskModal-D_ZK8beS.js";import{u as S}from"./workspace-BHJnreAw.js";import{u as b}from"./useTaskEvents-2uukmWGh.js";import{_ as C}from"./TaskList-BEbbMALv.js";import{r as o,z as v,c as p,a as c,l as E,f as B,o as d}from"./index-Cw5ZgCdA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ru-D_ksFwAV.js";const M={class:"p-4 lg:p-8"},N={class:"max-w-4xl mx-auto"},V={key:0,class:"text-center py-12"},G={__name:"Someday",setup(W){const s=_(),f=S(),{taskUpdatedEvent:T}=b(),m=o([]),u=o(!1),l=o(!1),t=o(null),r=o(""),n=async()=>{u.value=!0;try{await s.fetchSomeday(!1),m.value=s.tasks}finally{u.value=!1}},y=e=>{t.value=e,l.value=!0},g=async e=>{try{e.status==="completed"?await s.updateTask(e.id,{status:"someday"}):await s.completeTask(e.id),n()}catch(a){console.error("Error toggling task:",a)}},h=async e=>{var a,k;r.value="";try{t.value?await s.updateTask(t.value.id,e):await s.createTask(e),l.value=!1,t.value=null,await n()}catch(i){console.error("Error saving task:",i),r.value=((k=(a=i.response)==null?void 0:a.data)==null?void 0:k.message)||i.message||"Ошибка при сохранении задачи"}},w=()=>{l.value=!1,t.value=null,r.value=""};return v(()=>{var e;return(e=f.currentWorkspace)==null?void 0:e.id},e=>{e&&n()},{immediate:!0}),v(T,()=>{n()}),(e,a)=>(d(),p("div",M,[c("div",N,[a[1]||(a[1]=c("div",{class:"mb-6"},[c("h1",{class:"text-xl lg:text-2xl font-semibold text-gray-900"},"Когда-нибудь")],-1)),u.value?(d(),p("div",V,[...a[0]||(a[0]=[c("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):(d(),E(C,{key:1,tasks:m.value,onTaskClick:y,onToggleComplete:g},null,8,["tasks"])),B(x,{show:l.value,task:t.value,"server-error":r.value,onClose:w,onSubmit:h},null,8,["show","task","server-error"])])]))}};export{G as default};
