import{u as C,T as E}from"./TaskModal-B7votAW0.js";import{u as S}from"./workspace-DxROCKju.js";import{u as B}from"./useTaskEvents-CbHPJt0o.js";import{_ as M}from"./TaskList-BbIdbNU5.js";import{r as t,z as T,c as w,a as i,l as j,f as N,o as m}from"./app-CggqkjMs.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ru-B7JyRvIu.js";const V={class:"p-4 lg:p-8"},W={class:"max-w-4xl mx-auto"},z={key:0,class:"text-center py-12"},J={__name:"Tomorrow",setup(O){const a=C(),g=S(),{taskUpdatedEvent:h}=B(),k=t([]),u=t(!1),l=t(!1),o=t(null),n=t(""),c=async()=>{u.value=!0;try{await a.fetchTomorrow(!1),k.value=a.tasks}finally{u.value=!1}},_=e=>{o.value=e,l.value=!0},y=async e=>{try{e.status==="completed"?await a.updateTask(e.id,{status:"tomorrow"}):await a.completeTask(e.id),c()}catch(s){console.error("Error toggling task:",s)}},x=async e=>{var s,p,v,f;n.value="";try{o.value?await a.updateTask(o.value.id,e):await a.createTask(e),l.value=!1,o.value=null,await c()}catch(r){console.error("Error saving task:",r);let d="Ошибка при сохранении задачи";(p=(s=r.response)==null?void 0:s.data)!=null&&p.errors?d=Object.values(r.response.data.errors).flat().join(", "):(f=(v=r.response)==null?void 0:v.data)!=null&&f.message&&(d=r.response.data.message),n.value=d}},b=()=>{l.value=!1,o.value=null,n.value=""};return T(()=>{var e;return(e=g.currentWorkspace)==null?void 0:e.id},e=>{e&&c()},{immediate:!0}),T(h,()=>{c()}),(e,s)=>(m(),w("div",V,[i("div",W,[s[1]||(s[1]=i("div",{class:"mb-6"},[i("h1",{class:"text-xl lg:text-2xl font-semibold text-gray-900"},"Завтра")],-1)),u.value?(m(),w("div",z,[...s[0]||(s[0]=[i("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):(m(),j(M,{key:1,tasks:k.value,onTaskClick:_,onToggleComplete:y},null,8,["tasks"])),N(E,{show:l.value,task:o.value,"server-error":n.value,onClose:b,onSubmit:x},null,8,["show","task","server-error"])])]))}};export{J as default};
