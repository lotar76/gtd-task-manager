import{r as p,k as u,s as P,c as a,a as t,f as C,F as M,C as S,i as $,o as n,b as v,D as B,t as g,w as V}from"./index-BM-3aGKM.js";import{u as W}from"./projects-DIMWl5aI.js";import{u as A}from"./workspace-CoKcgfuB.js";import{P as E}from"./ProjectModal-DYKykoGV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const N={class:"p-4 lg:p-8"},F={class:"flex items-center justify-between mb-6"},z={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},H=["onClick"],I={class:"flex items-start justify-between mb-4"},D={class:"flex items-center space-x-3 flex-1 min-w-0"},L={class:"flex-1 min-w-0"},R={class:"text-lg font-semibold text-gray-900 dark:text-white truncate"},q={key:0,class:"text-sm text-gray-500 dark:text-gray-400 truncate"},G=["onClick"],J={key:0,class:"text-sm text-gray-600 dark:text-gray-300 mb-4 line-clamp-2"},K={class:"flex items-center justify-between text-sm"},O={class:"text-gray-500 dark:text-gray-400"},Q={key:0,class:"px-2 py-1 bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-400 rounded-full text-xs"},T={key:1,class:"text-center py-16"},se={__name:"Index",setup(U){$();const l=W(),m=A(),i=p(!1),c=p(null),d=p(""),k=u(()=>l.activeProjects),x=u(()=>m.currentWorkspace),y=u(()=>m.workspaces),f=u(()=>m.selectedWorkspaces.map(r=>r.id)),w=r=>{const e=y.value.find(s=>s.id===r);return(e==null?void 0:e.name)||""},b=async r=>{var e,s;d.value="";try{c.value?await l.updateProject(c.value.id,r):await l.createProject(r),i.value=!1,c.value=null,await l.fetchAllProjects({force:!0})}catch(o){console.error("Error saving project:",o),d.value=((s=(e=o.response)==null?void 0:e.data)==null?void 0:s.message)||o.message||"Ошибка при сохранении проекта"}},_=()=>{i.value=!1,c.value=null,d.value=""},j=async r=>{var e,s;if(confirm(`Архивировать проект "${r.name}"?`))try{await l.archiveProject(r.id),await l.fetchAllProjects({force:!0})}catch(o){console.error("Error archiving project:",o),alert("Ошибка при архивировании проекта: "+(((s=(e=o.response)==null?void 0:e.data)==null?void 0:s.message)||o.message))}};return P(async()=>{await l.fetchAllProjects()}),(r,e)=>(n(),a("div",N,[t("div",F,[e[3]||(e[3]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Проекты",-1)),t("button",{onClick:e[0]||(e[0]=s=>i.value=!0),class:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg flex items-center space-x-2 transition-colors"},[...e[2]||(e[2]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),t("span",null,"Создать проект",-1)])])]),k.value.length>0?(n(),a("div",z,[(n(!0),a(M,null,S(k.value,s=>(n(),a("div",{key:s.id,class:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow cursor-pointer",onClick:o=>{var h;return r.$router.push(`/workspaces/${(h=x.value)==null?void 0:h.id}/projects/${s.id}`)}},[t("div",I,[t("div",D,[t("div",{class:"w-4 h-4 rounded-full flex-shrink-0",style:B({backgroundColor:s.color||"#3B82F6"})},null,4),t("div",L,[t("h3",R,g(s.name),1),f.value.length>1?(n(),a("p",q,g(w(s.workspace_id)),1)):v("",!0)])]),t("button",{onClick:V(o=>j(s),["stop"]),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-1 transition-colors",title:"Архивировать"},[...e[4]||(e[4]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)])],8,G)]),s.description?(n(),a("p",J,g(s.description),1)):v("",!0),t("div",K,[t("span",O,g(s.tasks_count||0)+" задач ",1),s.status==="active"?(n(),a("span",Q," Активен ")):v("",!0)])],8,H))),128))])):(n(),a("div",T,[e[5]||(e[5]=t("svg",{class:"mx-auto h-16 w-16 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e[6]||(e[6]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"Нет проектов",-1)),e[7]||(e[7]=t("p",{class:"text-gray-500 dark:text-gray-400 mb-4"},"Создайте первый проект для организации ваших задач",-1)),t("button",{onClick:e[1]||(e[1]=s=>i.value=!0),class:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors"}," Создать проект ")])),C(E,{show:i.value,project:c.value,"server-error":d.value,onClose:_,onSubmit:b},null,8,["show","project","server-error"])]))}};export{se as default};
