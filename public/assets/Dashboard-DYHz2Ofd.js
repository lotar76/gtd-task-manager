import{E as le,G as ne,r as D,z as U,H as Z,k as L,c as s,o as r,a as e,t as n,F as f,C,p as j,b as _,D as M,e as T,l as W,f as H,m as de,s as ie,y as O}from"./index-BQRmz4GQ.js";import{u as X}from"./workspace-DTkHaZL8.js";import{d as E}from"./ru-B7JyRvIu.js";import{_ as ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as ue}from"./TaskModal-BzRPWaSn.js";import"./projects-BB9qncDe.js";import"./lifeSpheres-DDVy7cpI.js";import"./goals-D1Fsmasl.js";const ge=le("dashboard",()=>{const a=ne({}),m=D(localStorage.getItem("dashboardPeriod")||"day"),i=X(),b=t=>{a[t]||(a[t]={lifeMirror:null,aiMessage:null,loading:!1,aiLoading:!1})},d=async t=>{if(t){b(t),a[t].loading=!0;try{const y=await Z.get("/v1/dashboard/life-mirror",{params:{workspace_id:t,period:m.value}});a[t].lifeMirror=y.data}catch(y){console.error(`Failed to fetch life mirror for ws ${t}:`,y),a[t].lifeMirror=null}finally{a[t].loading=!1}}},v=async t=>{if(t){b(t),a[t].aiLoading=!0;try{const y=await Z.get("/v1/dashboard/ai-message",{params:{workspace_id:t,period:m.value}});a[t].aiMessage=y.data}catch(y){console.error(`Failed to fetch AI message for ws ${t}:`,y),a[t].aiMessage=null}finally{a[t].aiLoading=!1}}},h=async t=>{await Promise.all([d(t),v(t)])},c=async()=>{const t=i.selectedWorkspaces;t.length&&await Promise.all(t.map(y=>h(y.id)))},l=t=>{m.value=t,localStorage.setItem("dashboardPeriod",t),c()};return U(()=>i.selectedWorkspaces.map(t=>t.id).join(","),()=>{c()}),{dataByWorkspace:a,selectedPeriod:m,fetchLifeMirror:d,fetchAiMessage:v,fetchForWorkspace:h,fetchAllWorkspaces:c,setPeriod:l}}),xe={class:"mb-6"},he={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},ye={class:"text-sm text-gray-500 dark:text-gray-400 mt-0.5"},me={class:"inline-flex rounded-xl bg-gray-100 dark:bg-gray-800 p-1",role:"group"},be=["onClick"],ve={__name:"DashboardHeader",props:{period:{type:String,required:!0}},emits:["change-period"],setup(a){E.locale("ru");const m=a,i=[{value:"day",label:"День"},{value:"week",label:"Неделя"},{value:"month",label:"Месяц"},{value:"year",label:"Год"}],b=L(()=>{const d=E();switch(m.period){case"day":return d.format("D MMMM YYYY, dddd");case"week":{const v=d.startOf("week"),h=d.endOf("week");return`${v.format("D MMM")} — ${h.format("D MMM YYYY")}`}case"month":return d.format("MMMM YYYY");case"year":return d.format("YYYY год");default:return d.format("D MMMM YYYY")}});return(d,v)=>(r(),s("div",xe,[e("div",he,[e("div",null,[v[0]||(v[0]=e("h1",{class:"text-xl sm:text-2xl font-bold text-gray-900 dark:text-white"}," Зеркало жизни ",-1)),e("p",ye,n(b.value),1)]),e("div",me,[(r(),s(f,null,C(i,h=>e("button",{key:h.value,onClick:c=>d.$emit("change-period",h.value),type:"button",class:j(["px-4 py-2 text-sm font-medium rounded-lg transition-all duration-200",[a.period===h.value?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"]])},n(h.label),11,be)),64))])])]))}},ke={key:0,class:"h-1 mb-2 relative overflow-hidden rounded-full"},pe=["viewBox"],fe=["d","stroke"],_e={class:"relative overflow-hidden rounded-2xl shadow-sm border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800"},$e={class:"p-4 sm:p-6"},we={class:"max-h-[40vh] overflow-y-auto sm:max-h-none sm:overflow-visible scrollbar-thin"},Me={key:0,class:"animate-pulse space-y-3"},Ce={key:1},Se={class:"text-sm sm:text-base text-gray-900 dark:text-gray-100 leading-relaxed"},Pe={key:0,class:"mt-2 sm:mt-3 bg-gray-50 dark:bg-gray-700/50 rounded-xl p-3 sm:p-4"},Le={class:"text-gray-700 dark:text-gray-300 text-xs sm:text-sm leading-relaxed"},Ye={key:1,class:"mt-3 sm:mt-4 flex flex-wrap gap-1.5 sm:gap-2"},Be={key:2,class:"mt-3 sm:mt-4 pt-3 border-t border-gray-200 dark:border-gray-700"},je={class:"text-gray-500 dark:text-gray-400 text-xs sm:text-sm italic"},ze={class:"text-gray-400 dark:text-gray-500 not-italic ml-1"},Ae={key:2},J=200,De={__name:"AiHeroBanner",props:{message:{type:Object,default:null},loading:{type:Boolean,default:!1}},setup(a){const m=a,i={positive:"#10b981",concerned:"#6366f1",warning:"#f59e0b",serious:"#ef4444",reflective:"#8b5cf6"},b=L(()=>{var c;const h=((c=m.message)==null?void 0:c.mood)||"concerned";return i[h]||i.concerned}),d={positive:2,reflective:2.5,concerned:3,warning:3.5,serious:4.5},v=L(()=>{var B;const h=((B=m.message)==null?void 0:B.mood)||"concerned",c=d[h]||3,l=J,t=5,y=Math.floor(l/40);let p=`M 0 ${t}`;for(let $=0;$<y;$++){const o=$*40;p+=` L ${o+12} ${t}`,p+=` L ${o+16} ${t+c*.4}`,p+=` L ${o+20} ${t-c}`,p+=` L ${o+24} ${t+c*.7}`,p+=` L ${o+28} ${t}`,p+=` L ${o+40} ${t}`}return p});return(h,c)=>{var l;return r(),s("div",null,[a.message?(r(),s("div",ke,[(r(),s("svg",{class:"absolute inset-0 w-full h-full",preserveAspectRatio:"none",viewBox:`0 0 ${J} 10`},[e("path",{d:v.value,fill:"none",stroke:b.value,"stroke-width":"2","stroke-linecap":"round",class:"pulse-line",style:M({"--pulse-color":b.value})},null,12,fe)],8,pe))])):_("",!0),e("div",_e,[e("div",$e,[e("div",we,[a.loading?(r(),s("div",Me,[...c[0]||(c[0]=[e("div",{class:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-2/3"},null,-1),e("div",{class:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"},null,-1),e("div",{class:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-4/5"},null,-1)])])):a.message?(r(),s("div",Ce,[e("p",Se,n(a.message.main_message),1),a.message.followup_message?(r(),s("div",Pe,[e("p",Le,n(a.message.followup_message),1)])):_("",!0),(l=a.message.recommendations)!=null&&l.length?(r(),s("div",Ye,[(r(!0),s(f,null,C(a.message.recommendations,(t,y)=>(r(),s("div",{key:y,class:"bg-gray-100 dark:bg-gray-700 rounded-lg px-2.5 py-1.5 sm:px-3 sm:py-2 text-xs sm:text-sm text-gray-700 dark:text-gray-300 flex items-center gap-1.5 sm:gap-2"},[e("div",{class:"w-2 h-2 rounded-full flex-shrink-0",style:M({backgroundColor:t.sphere_color||"#9ca3af"})},null,4),e("span",null,n(t.action),1)]))),128))])):_("",!0),a.message.bible_verse?(r(),s("div",Be,[e("p",je,[T(" «"+n(a.message.bible_verse.text)+"» ",1),e("span",ze,"— "+n(a.message.bible_verse.ref),1)])])):_("",!0)])):(r(),s("div",Ae,[...c[1]||(c[1]=[e("p",{class:"text-base font-medium text-gray-900 dark:text-white"},"Зеркало жизни",-1),e("p",{class:"text-gray-500 dark:text-gray-400 text-sm mt-1"},"Обзор баланса твоих жизненных сфер",-1)])]))])])])])}}},K=ce(De,[["__scopeId","data-v-033a7b32"]]),Te={class:"flex flex-col items-center"},He=["width","height","viewBox"],We=["cx","cy","r"],Ne=["cx","cy","r"],Oe=["x1","y1","x2","y2"],Ve=["d"],Ee=["d","fill","fill-opacity"],qe=["d","stroke"],Fe=["d","stroke"],Re=["x","y","fill","text-anchor"],Ge=["d","onMouseenter"],Ze=["cx","cy","r"],Je=["x","y"],Ke=["x","y"],N=40,Q=.03,Qe={__name:"BalanceWheel",props:{spheres:{type:Array,default:()=>[]},balanceIndex:{type:Number,default:0},size:{type:Number,default:280},hoveredSphereName:{type:String,default:null}},emits:["sphere-hover","sphere-leave"],setup(a,{emit:m}){const i=a,b=m,d=D(null),v=x=>{var g;d.value=x,b("sphere-hover",(g=i.spheres[x])==null?void 0:g.name)},h=()=>{d.value=null,b("sphere-leave")},c=L(()=>i.size/2),l=L(()=>i.size/2-40),t=L(()=>l.value*.35),y=L(()=>i.spheres.length),p=L(()=>y.value>0?2*Math.PI/y.value:0),B=[25,50,75],$=x=>p.value*x-Math.PI/2+Q/2,o=x=>p.value*(x+1)-Math.PI/2-Q/2,S=x=>($(x)+o(x))/2,P=(x,g)=>c.value+g*Math.cos(x),Y=(x,g)=>c.value+g*Math.sin(x),w=L(()=>i.spheres.length?Math.max(...i.spheres.map(x=>x.total||0),1):1),A=(x,g,u)=>{if(y.value===0||u<=g)return"";const k=$(x),z=o(x),G=z-k>Math.PI?1:0;return[`M ${P(k,g)} ${Y(k,g)}`,`L ${P(k,u)} ${Y(k,u)}`,`A ${u} ${u} 0 ${G} 1 ${P(z,u)} ${Y(z,u)}`,`L ${P(z,g)} ${Y(z,g)}`,`A ${g} ${g} 0 ${G} 0 ${P(k,g)} ${Y(k,g)}`,"Z"].join(" ")},q=(x,g)=>{if(y.value===0)return"";const u=$(x),k=o(x),z=k-u>Math.PI?1:0;return`M ${P(u,g)} ${Y(u,g)} A ${g} ${g} 0 ${z} 1 ${P(k,g)} ${Y(k,g)}`},I=x=>{if(!x.total||x.total===0)return t.value;const g=x.total/w.value;return t.value+(l.value-t.value)*Math.max(g,.1)},F=x=>{if(!x.done||x.done===0)return t.value;const g=x.done/w.value;return t.value+(l.value-t.value)*Math.max(g,.08)},ee=x=>q(x,l.value),te=(x,g)=>{const u=I(g);return u<=t.value?"":A(x,t.value,u)},ae=(x,g)=>{const u=F(g);return u<=t.value?"":A(x,t.value,u)},re=(x,g)=>{const u=F(g);return u<=t.value?"":q(x,u)},se=L(()=>y.value<=1?[]:i.spheres.map((x,g)=>{const u=p.value*g-Math.PI/2;return{x1:P(u,t.value),y1:Y(u,t.value),x2:P(u,l.value),y2:Y(u,l.value)}})),R=L(()=>i.spheres.map((x,g)=>{const u=l.value+18;return{x:P(S(g),u),y:Y(S(g),u)}})),oe=x=>{const g=S(x)*180/Math.PI;return g>-60&&g<60?"start":g>120||g<-120?"end":"middle"};return(x,g)=>(r(),s("div",Te,[(r(),s("svg",{width:a.size,height:a.size,viewBox:`${-N} ${-N} ${a.size+N*2} ${a.size+N*2}`},[(r(),s(f,null,C(B,u=>e("circle",{key:"grid-"+u,cx:c.value,cy:c.value,r:t.value+(l.value-t.value)*u/100,fill:"none",stroke:"currentColor",class:"text-gray-200 dark:text-gray-700","stroke-width":"0.5","stroke-dasharray":"3 3"},null,8,We)),64)),e("circle",{cx:c.value,cy:c.value,r:l.value,fill:"none",stroke:"currentColor",class:"text-gray-300 dark:text-gray-600","stroke-width":"1.5"},null,8,Ne),(r(!0),s(f,null,C(se.value,(u,k)=>(r(),s("line",{key:"div-"+k,x1:u.x1,y1:u.y1,x2:u.x2,y2:u.y2,stroke:"currentColor",class:"text-gray-300 dark:text-gray-600","stroke-width":"1"},null,8,Oe))),128)),(r(!0),s(f,null,C(a.spheres,(u,k)=>(r(),s("path",{key:"total-"+k,d:te(k,u),fill:"currentColor",class:"text-gray-400 dark:text-gray-500","fill-opacity":"0.25"},null,8,Ve))),128)),(r(!0),s(f,null,C(a.spheres,(u,k)=>(r(),s("path",{key:"done-"+k,d:ae(k,u),fill:u.color||"#888","fill-opacity":d.value===k||a.hoveredSphereName===u.name?"0.65":"0.45",class:"transition-all duration-300 ease-out"},null,8,Ee))),128)),(r(!0),s(f,null,C(a.spheres,(u,k)=>(r(),s("path",{key:"edge-"+k,d:re(k,u),fill:"none",stroke:u.color||"#888","stroke-width":"2.5","stroke-linecap":"round",class:"transition-all duration-700 ease-out"},null,8,qe))),128)),(r(!0),s(f,null,C(a.spheres,(u,k)=>(r(),s("path",{key:"arc-"+k,d:ee(k),fill:"none",stroke:u.color||"#888","stroke-width":"3","stroke-opacity":"0.25","stroke-linecap":"round"},null,8,Fe))),128)),(r(!0),s(f,null,C(a.spheres,(u,k)=>(r(),s("text",{key:"label-"+k,x:R.value[k].x,y:R.value[k].y,fill:u.color||"#888","font-size":"11","font-weight":"600","text-anchor":oe(k),"dominant-baseline":"central"},n(u.name||""),9,Re))),128)),(r(!0),s(f,null,C(a.spheres,(u,k)=>(r(),s("path",{key:"hover-"+k,d:A(k,t.value,l.value),fill:"transparent",class:"cursor-pointer",onMouseenter:z=>v(k),onMouseleave:h},null,40,Ge))),128)),e("circle",{cx:c.value,cy:c.value,r:t.value,class:"fill-white dark:fill-gray-900 stroke-gray-300 dark:stroke-gray-600","stroke-width":"1"},null,8,Ze),e("text",{x:c.value,y:c.value-8,"text-anchor":"middle","dominant-baseline":"central","font-size":"28","font-weight":"bold",class:"fill-gray-900 dark:fill-white"},n(a.balanceIndex),9,Je),e("text",{x:c.value,y:c.value+14,"text-anchor":"middle","dominant-baseline":"central","font-size":"10",class:"fill-gray-400 dark:fill-gray-500"}," баланс ",8,Ke)],8,He))]))}},Ue={class:"flex items-center justify-between mb-2"},Xe={class:"flex items-center gap-2"},Ie={class:"text-sm font-semibold text-gray-900 dark:text-white"},et={key:0,class:"text-xs px-2 py-0.5 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"},tt={class:"flex items-center gap-3"},at={class:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden"},rt={class:"text-xs font-medium text-gray-600 dark:text-gray-400 tabular-nums whitespace-nowrap"},st={__name:"SphereCard",props:{sphere:{type:Object,required:!0}},setup(a){const m=a,i=D(!1),b=L(()=>m.sphere.tasks_total?Math.round(m.sphere.tasks_done/m.sphere.tasks_total*100):0);return(d,v)=>(r(),s("div",{class:"rounded-xl border bg-white/80 dark:bg-gray-800/80 border-gray-200 dark:border-gray-700 p-4 transition-all duration-200 cursor-pointer group border-l-4",style:M({borderLeftColor:a.sphere.color,boxShadow:i.value?`0 0 20px ${a.sphere.color}30`:"none"}),onMouseenter:v[0]||(v[0]=h=>i.value=!0),onMouseleave:v[1]||(v[1]=h=>i.value=!1)},[e("div",Ue,[e("div",Xe,[e("div",{class:"w-3 h-3 rounded-full",style:M({backgroundColor:a.sphere.color})},null,4),e("span",Ie,n(a.sphere.name),1)]),a.sphere.days_without_attention!==null&&a.sphere.days_without_attention>0?(r(),s("span",et,n(a.sphere.days_without_attention)+" дн. ",1)):_("",!0)]),e("div",tt,[e("div",at,[e("div",{class:"h-full rounded-full transition-all duration-500",style:M({width:b.value+"%",backgroundColor:a.sphere.color})},null,4)]),e("span",rt,n(a.sphere.tasks_done)+"/"+n(a.sphere.tasks_total),1)])],36))}},ot={class:"bg-white/80 dark:bg-gray-800/80 rounded-xl border border-dashed border-gray-300 dark:border-gray-600 p-4"},lt={class:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-2"},nt={class:"min-w-0 flex-1"},dt={class:"text-xs font-medium text-gray-700 dark:text-gray-300 truncate"},it={class:"text-[10px] text-gray-400 dark:text-gray-500"},ct={__name:"MissingSpheres",props:{spheres:{type:Array,default:()=>[]}},setup(a){const m=i=>{const b=Math.abs(i)%100,d=b%10;return b>10&&b<20?"дней":d===1?"день":d>=2&&d<=4?"дня":"дней"};return(i,b)=>(r(),s("div",ot,[b[0]||(b[0]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"}," Сферы без внимания ",-1)),e("div",lt,[(r(!0),s(f,null,C(a.spheres,d=>(r(),s("div",{key:d.id,class:"flex items-center gap-2 rounded-lg border border-dashed p-3 transition-colors hover:bg-gray-50 dark:hover:bg-gray-700/50",style:M({borderColor:d.color+"40",backgroundColor:d.color+"08"})},[e("div",{class:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:M({backgroundColor:d.color})},null,4),e("div",nt,[e("p",dt,n(d.name),1),e("p",it,n(d.days_without_attention!==null?`${d.days_without_attention} ${m(d.days_without_attention)} без внимания`:"Нет задач"),1)])],4))),128))])]))}},ut={key:0,class:"space-y-6"},gt={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 h-full flex flex-col"},xt={key:0,class:"space-y-2 flex-1 overflow-y-auto"},ht=["onMouseenter"],yt={class:"flex-1 min-w-0"},mt={class:"flex items-start justify-between gap-2"},bt={class:"flex items-center gap-2 flex-1 min-w-0"},vt={key:0,class:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},kt={key:0,class:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-1"},pt={key:1,class:"flex-1 flex flex-col items-center justify-center py-12 text-center"},ft={key:2,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},_t={class:"flex items-center justify-between text-sm"},$t={class:"text-gray-600 dark:text-gray-400"},wt={class:"font-semibold text-gray-900 dark:text-white"},Mt={class:"text-gray-600 dark:text-gray-400"},Ct={class:"font-semibold text-emerald-600 dark:text-emerald-400"},V={__name:"PeriodDayView",props:{data:{type:Object,default:null},hoveredSphereName:{type:String,default:null}},emits:["task-hover","task-leave"],setup(a,{emit:m}){const i=a,b=m,d=D(!1),v=D(null),h=L(()=>{var o;if(!((o=i.data)!=null&&o.spheres))return[];const $=[];return i.data.spheres.forEach(S=>{var P;(P=S.tasks)!=null&&P.length&&S.tasks.forEach(Y=>{$.push({...Y,sphere_name:S.name,sphere_color:S.color})})}),$.sort((S,P)=>S.completed_at&&!P.completed_at?1:!S.completed_at&&P.completed_at?-1:S.sphere_name.localeCompare(P.sphere_name))}),c=$=>i.hoveredSphereName&&$.sphere_name===i.hoveredSphereName,l=$=>{b("task-hover",$)},t=()=>{b("task-leave")},y=()=>{v.value={due_date:new Date().toISOString().split("T")[0]},d.value=!0},p=()=>{d.value=!1,v.value=null},B=()=>{p()};return($,o)=>{var S,P,Y;return a.data?(r(),s("div",ut,[e("div",gt,[e("div",{class:"flex items-center justify-between mb-4"},[o[1]||(o[1]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Задачи на сегодня",-1)),e("button",{onClick:y,class:"flex items-center gap-2 px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white text-sm font-medium rounded-lg transition-colors duration-200"},[...o[0]||(o[0]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),T(" Добавить задачу ",-1)])])]),h.value.length?(r(),s("div",xt,[(r(!0),s(f,null,C(h.value,w=>(r(),s("div",{key:w.id,onMouseenter:A=>l(w.sphere_name),onMouseleave:t,class:j(["group flex items-start gap-3 p-3 rounded-lg border transition-all duration-200 cursor-pointer",[w.completed_at?"bg-gray-50/50 dark:bg-gray-700/30 border-gray-200 dark:border-gray-600":"bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600",c(w)?"ring-2 ring-offset-2 dark:ring-offset-gray-800":""]]),style:M(c(w)?{"--tw-ring-color":w.sphere_color}:{})},[e("div",{class:j(["w-1 h-full rounded-full flex-shrink-0 mt-1 transition-all duration-200",c(w)?"w-1.5":"w-1"]),style:M({backgroundColor:w.sphere_color})},null,6),e("div",yt,[e("div",mt,[e("div",bt,[e("div",{class:j(["w-5 h-5 rounded border-2 flex items-center justify-center flex-shrink-0 transition-colors",w.completed_at?"bg-emerald-500 border-emerald-500":"border-gray-300 dark:border-gray-600 group-hover:border-gray-400 dark:group-hover:border-gray-500"])},[w.completed_at?(r(),s("svg",vt,[...o[2]||(o[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)])])):_("",!0)],2),e("span",{class:j(["text-sm font-medium truncate",w.completed_at?"line-through text-gray-400 dark:text-gray-500":"text-gray-900 dark:text-white"])},n(w.title),3)]),e("span",{class:j(["px-2 py-0.5 text-xs font-medium rounded-full flex-shrink-0 transition-all duration-200",c(w)?"ring-1":""]),style:M({backgroundColor:w.sphere_color+"20",color:w.sphere_color,"--tw-ring-color":c(w)?w.sphere_color:"transparent"})},n(w.sphere_name),7)]),w.description?(r(),s("p",kt,n(w.description),1)):_("",!0)])],46,ht))),128))])):(r(),s("div",pt,[...o[3]||(o[3]=[e("svg",{class:"w-12 h-12 text-gray-300 dark:text-gray-600 mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),e("p",{class:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Нет задач на сегодня",-1),e("p",{class:"text-xs text-gray-500 dark:text-gray-500 mt-1"},"Добавьте задачу, чтобы начать работу",-1)])])),h.value.length?(r(),s("div",ft,[e("div",_t,[e("span",$t,[o[4]||(o[4]=T(" Выполнено: ",-1)),e("span",wt,n(((S=a.data.summary)==null?void 0:S.completed)||0),1),T(" из "+n(((P=a.data.summary)==null?void 0:P.total_tasks)||0),1)]),e("span",Mt,[o[5]||(o[5]=T(" Прогресс: ",-1)),e("span",Ct,n(((Y=a.data.summary)==null?void 0:Y.completion_rate)||0)+"%",1)])])])):_("",!0)]),d.value?(r(),W(ue,{key:0,show:d.value,task:v.value,onClose:p,onSaved:B},null,8,["show","task"])):_("",!0)])):_("",!0)}}},St={key:0,class:"space-y-6"},Pt={class:"grid grid-cols-2 sm:grid-cols-3 gap-3"},Lt={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},Yt={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},Bt={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},jt={class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400 mt-1"},zt={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},At={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},Dt={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},Tt={class:"flex items-end gap-1 h-32"},Ht={class:"w-full flex flex-col-reverse gap-px",style:{height:"100px"}},Wt=["title"],Nt={key:0,class:"w-full h-full flex items-center justify-center"},Ot={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},Vt={class:"space-y-2"},Et={class:"w-20 text-xs text-gray-600 dark:text-gray-400 truncate"},qt={class:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden"},Ft={class:"text-xs font-medium text-gray-500 dark:text-gray-400 tabular-nums w-12 text-right"},Rt={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},Gt={class:"space-y-2"},Zt={class:"flex-1 min-w-0"},Jt={class:"flex items-center gap-2"},Kt={class:"text-sm text-gray-900 dark:text-white truncate"},Qt={key:0,class:"text-[10px] text-amber-600 dark:text-amber-400 bg-amber-50 dark:bg-amber-900/20 px-1.5 py-0.5 rounded"},Ut={class:"flex items-center gap-2"},Xt={class:"w-16 bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden"},It={class:"text-xs text-gray-500 dark:text-gray-400 tabular-nums"},ea={__name:"PeriodWeekView",props:{data:{type:Object,default:null}},setup(a){const m=a,i=L(()=>{var t;if(!((t=m.data)!=null&&t.daily_breakdown))return 1;let l=0;for(const y of m.data.daily_breakdown){const p=Object.values(y.by_sphere).reduce((B,$)=>B+$,0);p>l&&(l=p)}return Math.max(l,1)}),b=l=>Math.max(l/i.value*80,4),d=L(()=>{var t;const l={};if((t=m.data)!=null&&t.attention_distribution)for(const y of m.data.attention_distribution)l[y.sphere_id]=y;return l}),v=l=>{var t;return((t=d.value[l])==null?void 0:t.color)||"#888"},h=l=>{var t;return((t=d.value[l])==null?void 0:t.name)||""},c=l=>E().format("YYYY-MM-DD")===l;return(l,t)=>{var y,p,B,$;return a.data?(r(),s("div",St,[e("div",Pt,[e("div",Lt,[t[0]||(t[0]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Всего задач",-1)),e("p",Yt,n(((y=a.data.summary)==null?void 0:y.total_tasks)||0),1)]),e("div",Bt,[t[1]||(t[1]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Выполнено",-1)),e("p",jt,n(((p=a.data.summary)==null?void 0:p.completed)||0),1)]),e("div",zt,[t[2]||(t[2]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Выполнение",-1)),e("p",At,n(((B=a.data.summary)==null?void 0:B.completion_rate)||0)+"%",1)])]),e("div",Dt,[t[4]||(t[4]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4"},"Рентген недели",-1)),e("div",Tt,[(r(!0),s(f,null,C(a.data.daily_breakdown,o=>(r(),s("div",{key:o.date,class:"flex-1 flex flex-col items-center gap-1"},[e("div",Ht,[(r(!0),s(f,null,C(Object.keys(o.by_sphere),S=>(r(),s("div",{key:S,class:"w-full rounded-sm transition-all duration-300",style:M({height:b(o.by_sphere[S])+"px",backgroundColor:v(parseInt(S)),opacity:.8}),title:`${h(parseInt(S))}: ${o.by_sphere[S]}`},null,12,Wt))),128)),Object.keys(o.by_sphere).length?_("",!0):(r(),s("div",Nt,[...t[3]||(t[3]=[e("span",{class:"text-gray-300 dark:text-gray-600 text-xs"},"—",-1)])]))]),e("span",{class:j(["text-xs mt-1",c(o.date)?"font-bold text-primary-600 dark:text-primary-400":"text-gray-500 dark:text-gray-400"])},n(o.day),3)]))),128))])]),e("div",Ot,[t[5]||(t[5]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Распределение внимания",-1)),e("div",Vt,[(r(!0),s(f,null,C(a.data.attention_distribution,o=>(r(),s("div",{key:o.sphere_id,class:"flex items-center gap-3"},[e("div",Et,n(o.name),1),e("div",qt,[e("div",{class:"h-full rounded-full transition-all duration-500",style:M({width:o.percentage+"%",backgroundColor:o.color,opacity:o.percentage>0?1:.3})},null,4)]),e("span",Ft,n(o.percentage)+"% ",1)]))),128))])]),($=a.data.projects)!=null&&$.length?(r(),s("div",Rt,[t[6]||(t[6]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Потоки",-1)),e("div",Gt,[(r(!0),s(f,null,C(a.data.projects,o=>(r(),s("div",{key:o.id,class:j(["flex items-center gap-3 p-2 rounded-lg",o.is_stalled?"opacity-50":""])},[e("div",{class:"w-2 h-2 rounded-full flex-shrink-0",style:M({backgroundColor:o.sphere_color||o.color})},null,4),e("div",Zt,[e("div",Jt,[e("span",Kt,n(o.name),1),o.is_stalled?(r(),s("span",Qt,"стоит")):_("",!0)])]),e("div",Ut,[e("div",Xt,[e("div",{class:"h-full rounded-full",style:M({width:(o.total>0?o.done/o.total*100:0)+"%",backgroundColor:o.sphere_color||o.color})},null,4)]),e("span",It,n(o.done)+"/"+n(o.total),1)])],2))),128))])])):_("",!0)])):_("",!0)}}},ta={key:0,class:"space-y-6"},aa={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},ra={class:"flex items-center gap-4 mb-2"},sa={class:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden"},oa={class:"text-sm font-bold text-gray-900 dark:text-white tabular-nums"},la={class:"text-xs text-gray-500 dark:text-gray-400"},na={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},da={class:"space-y-2"},ia={class:"w-20 text-xs text-gray-600 dark:text-gray-400 truncate"},ca={class:"text-xs text-gray-400 dark:text-gray-500 tabular-nums w-8 text-right"},ua={class:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden relative"},ga={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-amber-200 dark:border-amber-900/50 p-4"},xa={class:"space-y-2"},ha={class:"text-sm text-gray-700 dark:text-gray-300 flex-1"},ya={class:"text-xs text-amber-600 dark:text-amber-400"},ma={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-rose-200 dark:border-rose-900/50 p-4"},ba={class:"space-y-3"},va={class:"flex items-center justify-between mb-2"},ka={class:"flex items-center gap-2"},pa={class:"text-sm font-medium text-gray-900 dark:text-white"},fa={class:"text-xs text-gray-500 dark:text-gray-400"},_a={class:"flex items-center gap-3"},$a={class:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden relative"},wa=["title"],Ma={class:"text-xs text-rose-600 dark:text-rose-400 tabular-nums"},Ca={class:"text-gray-400"},Sa={__name:"PeriodMonthView",props:{data:{type:Object,default:null}},setup(a){const m=a,i=L(()=>{var d;return((d=m.data)==null?void 0:d.planned_vs_done)||{planned:0,done:0,days_passed:0,days_remaining:0,required_daily_pace:0,completion_rate:0}}),b=d=>d>2?"text-emerald-600 dark:text-emerald-400":d<-2?"text-rose-600 dark:text-rose-400":"text-gray-400 dark:text-gray-500";return(d,v)=>{var h,c;return a.data?(r(),s("div",ta,[e("div",aa,[v[0]||(v[0]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Нагрузка",-1)),e("div",ra,[e("div",sa,[e("div",{class:"h-full rounded-full bg-primary-500 transition-all duration-500",style:M({width:(i.value.completion_rate||0)+"%"})},null,4)]),e("span",oa,n(i.value.done)+"/"+n(i.value.planned),1)]),e("p",la," Осталось "+n(i.value.planned-i.value.done)+" задач, ~"+n(i.value.required_daily_pace)+"/день чтобы успеть. Прошло "+n(i.value.days_passed)+" дн., осталось "+n(i.value.days_remaining)+" дн. ",1)]),e("div",na,[v[1]||(v[1]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Было → Стало",-1)),e("div",da,[(r(!0),s(f,null,C(a.data.sphere_trends,l=>(r(),s("div",{key:l.sphere_id,class:"flex items-center gap-3"},[e("div",ia,n(l.name),1),e("span",ca,n(l.prev_pct)+"%",1),e("div",ua,[e("div",{class:"absolute top-0 h-full w-0.5 bg-gray-400 dark:bg-gray-500 z-10",style:M({left:l.prev_pct+"%"})},null,4),e("div",{class:"h-full rounded-full transition-all duration-500",style:M({width:l.current_pct+"%",backgroundColor:l.color})},null,4)]),e("span",{class:"text-xs font-medium tabular-nums w-8 text-right",style:M({color:l.color})},n(l.current_pct)+"% ",5),e("span",{class:j(["text-xs tabular-nums w-10 text-right",b(l.change)])},n(l.change>0?"+":"")+n(l.change)+"% ",3)]))),128))])]),(h=a.data.stalled_projects)!=null&&h.length?(r(),s("div",ga,[v[2]||(v[2]=e("h3",{class:"text-sm font-semibold text-amber-600 dark:text-amber-400 mb-3"},"Застрявшие потоки",-1)),e("div",xa,[(r(!0),s(f,null,C(a.data.stalled_projects,l=>(r(),s("div",{key:l.id,class:"flex items-center gap-3 p-2 rounded-lg bg-amber-50/50 dark:bg-amber-900/10"},[e("div",{class:"w-2 h-2 rounded-full",style:M({backgroundColor:l.sphere_color||"#F59E0B"})},null,4),e("span",ha,n(l.name),1),e("span",ya,n(l.days_since_activity)+" дн. без движения ",1)]))),128))])])):_("",!0),(c=a.data.goals_at_risk)!=null&&c.length?(r(),s("div",ma,[v[3]||(v[3]=e("h3",{class:"text-sm font-semibold text-rose-600 dark:text-rose-400 mb-3"},"Цели под угрозой",-1)),e("div",ba,[(r(!0),s(f,null,C(a.data.goals_at_risk,l=>(r(),s("div",{key:l.id,class:"p-3 rounded-lg bg-rose-50/50 dark:bg-rose-900/10"},[e("div",va,[e("div",ka,[e("div",{class:"w-2 h-2 rounded-full",style:M({backgroundColor:l.sphere_color})},null,4),e("span",pa,n(l.name),1)]),e("span",fa,n(l.days_left)+" дн. до дедлайна",1)]),e("div",_a,[e("div",$a,[e("div",{class:"absolute top-0 h-full w-0.5 bg-rose-400 z-10",style:M({left:l.expected_progress+"%"}),title:"Ожидаемый: "+l.expected_progress+"%"},null,12,wa),e("div",{class:"h-full rounded-full bg-rose-500",style:M({width:l.progress+"%"})},null,4)]),e("span",Ma,[T(n(l.progress)+"% ",1),e("span",Ca,"из "+n(l.expected_progress)+"%",1)])])]))),128))])])):_("",!0)])):_("",!0)}}},Pa={key:0,class:"space-y-6"},La={class:"grid grid-cols-2 sm:grid-cols-5 gap-3"},Ya={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},Ba={class:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},ja={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-emerald-200 dark:border-emerald-900/50"},za={class:"text-2xl font-bold text-emerald-600 dark:text-emerald-400 mt-1"},Aa={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-blue-200 dark:border-blue-900/50"},Da={class:"text-2xl font-bold text-blue-600 dark:text-blue-400 mt-1"},Ta={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-amber-200 dark:border-amber-900/50"},Ha={class:"text-2xl font-bold text-amber-600 dark:text-amber-400 mt-1"},Wa={class:"bg-white dark:bg-gray-800 rounded-xl p-4 border border-gray-200 dark:border-gray-700"},Na={class:"text-2xl font-bold text-gray-400 mt-1"},Oa={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},Va={class:"flex items-end gap-2 h-32"},Ea={class:"text-xs font-bold text-gray-900 dark:text-white tabular-nums"},qa={class:"text-[10px] text-gray-500 dark:text-gray-400 truncate max-w-full"},Fa={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},Ra={class:"space-y-3"},Ga={class:"flex-1 min-w-0"},Za={class:"flex items-center gap-2 mb-1"},Ja={class:"text-sm text-gray-900 dark:text-white truncate"},Ka={class:"flex items-center gap-2"},Qa={class:"flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden"},Ua={class:"text-xs text-gray-500 dark:text-gray-400 tabular-nums"},Xa={key:0,class:"text-xs text-gray-400 tabular-nums whitespace-nowrap"},Ia={key:2,class:"bg-white dark:bg-gray-800 rounded-xl border border-emerald-200 dark:border-emerald-900/50 p-4"},er={class:"space-y-2"},tr={class:"text-sm text-gray-900 dark:text-white flex-1"},ar={class:"text-xs text-gray-400"},rr={key:3,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4"},sr={class:"space-y-2"},or={class:"text-xs text-gray-600 dark:text-gray-400 w-20 truncate"},lr={class:"text-[10px] text-gray-400 dark:text-gray-500"},nr={__name:"PeriodYearView",props:{data:{type:Object,default:null}},setup(a){const m=a,i=L(()=>{var l;return((l=m.data)==null?void 0:l.goals_summary)||{total:0,achieved:0,on_track:0,behind:0,at_risk:0,stalled:0}}),b={ahead:"bg-emerald-100 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400",on_track:"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400",behind:"bg-amber-100 dark:bg-amber-900/20 text-amber-700 dark:text-amber-400",at_risk:"bg-rose-100 dark:bg-rose-900/20 text-rose-700 dark:text-rose-400",stalled:"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"},d={ahead:"опережает",on_track:"по графику",behind:"отстаёт",at_risk:"под угрозой",stalled:"стоит"},v={growing:"↑",falling:"↓",stable:"→",stalled:"·"},h={growing:"растёт",falling:"падает",stable:"стабильно",stalled:"стоит"},c=l=>l==="growing"?"text-emerald-600 dark:text-emerald-400":l==="falling"?"text-rose-600 dark:text-rose-400":"text-gray-400 dark:text-gray-500";return(l,t)=>{var y,p,B,$;return a.data?(r(),s("div",Pa,[e("div",La,[e("div",Ya,[t[0]||(t[0]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"Всего целей",-1)),e("p",Ba,n(i.value.total),1)]),e("div",ja,[t[1]||(t[1]=e("p",{class:"text-xs text-emerald-600 dark:text-emerald-400"},"Достигнуто",-1)),e("p",za,n(i.value.achieved),1)]),e("div",Aa,[t[2]||(t[2]=e("p",{class:"text-xs text-blue-600 dark:text-blue-400"},"По графику",-1)),e("p",Da,n(i.value.on_track),1)]),e("div",Ta,[t[3]||(t[3]=e("p",{class:"text-xs text-amber-600 dark:text-amber-400"},"Отстают",-1)),e("p",Ha,n(i.value.behind+i.value.at_risk),1)]),e("div",Wa,[t[4]||(t[4]=e("p",{class:"text-xs text-gray-400"},"Стоят",-1)),e("p",Na,n(i.value.stalled),1)])]),(y=a.data.monthly_balance_trend)!=null&&y.length?(r(),s("div",Oa,[t[5]||(t[5]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4"},"Индекс баланса — тренд",-1)),e("div",Va,[(r(!0),s(f,null,C(a.data.monthly_balance_trend,o=>(r(),s("div",{key:o.month_key,class:"flex-1 flex flex-col items-center gap-1"},[e("span",Ea,n(o.balance_index),1),e("div",{class:j(["w-full rounded-t transition-all duration-300",o.is_current?"bg-primary-500 shadow-lg shadow-primary-500/30":"bg-gray-300 dark:bg-gray-600"]),style:M({height:Math.max(o.balance_index,5)+"%"})},null,6),e("span",qa,n(o.month.split(" ")[0]),1)]))),128))])])):_("",!0),(p=a.data.active_goals)!=null&&p.length?(r(),s("div",Fa,[t[6]||(t[6]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Цели года",-1)),e("div",Ra,[(r(!0),s(f,null,C(a.data.active_goals,o=>(r(),s("div",{key:o.id,class:j(["flex items-center gap-3 p-2 rounded-lg",o.status==="stalled"?"opacity-50":""])},[e("div",{class:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:M({backgroundColor:o.sphere_color})},null,4),e("div",Ga,[e("div",Za,[e("span",Ja,n(o.name),1),e("span",{class:j(["text-[10px] px-1.5 py-0.5 rounded-full",b[o.status]||b.on_track])},n(d[o.status]||o.status),3)]),e("div",Ka,[e("div",Qa,[e("div",{class:"h-full rounded-full transition-all duration-500",style:M({width:o.progress+"%",backgroundColor:o.sphere_color})},null,4)]),e("span",Ua,n(o.progress)+"%",1)])]),o.days_left?(r(),s("span",Xa,n(o.days_left)+" дн. ",1)):_("",!0)],2))),128))])])):_("",!0),(B=a.data.achieved_goals)!=null&&B.length?(r(),s("div",Ia,[t[8]||(t[8]=e("h3",{class:"text-sm font-semibold text-emerald-600 dark:text-emerald-400 mb-3"},"Достигнутые цели",-1)),e("div",er,[(r(!0),s(f,null,C(a.data.achieved_goals,o=>(r(),s("div",{key:o.id,class:"flex items-center gap-3 p-2"},[t[7]||(t[7]=e("svg",{class:"w-5 h-5 text-emerald-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",tr,n(o.name),1),e("span",ar,n(o.completed_at),1)]))),128))])])):_("",!0),($=a.data.sphere_yearly_trends)!=null&&$.length?(r(),s("div",rr,[t[9]||(t[9]=e("h3",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Тренды по сферам",-1)),e("div",sr,[(r(!0),s(f,null,C(a.data.sphere_yearly_trends,o=>(r(),s("div",{key:o.sphere_id,class:"flex items-center gap-3"},[e("div",{class:"w-2 h-2 rounded-full",style:M({backgroundColor:o.color})},null,4),e("span",or,n(o.name),1),e("span",{class:j(["text-xs tabular-nums w-12",c(o.trend)])},n(v[o.trend]||"—")+" "+n(o.avg_attention)+"% ",3),e("span",lr,n(h[o.trend]||""),1)]))),128))])])):_("",!0)])):_("",!0)}}},dr={key:0,class:"flex items-center justify-center py-16"},ir={key:1,class:"text-center py-16"},cr={class:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6"},ur={class:"lg:col-span-1 flex items-center justify-center"},gr={class:"lg:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-3"},xr={key:1,class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},hr={__name:"WorkspaceDashboard",props:{workspaceId:{type:Number,required:!0},period:{type:String,required:!0},data:{type:Object,default:null}},setup(a){const m=a,i=D(null),b=c=>{i.value=c},d=()=>{i.value=null},v=L(()=>({day:V,week:ea,month:Sa,year:nr})[m.period]||V),h=L(()=>{var y;const c=(y=m.data)==null?void 0:y.lifeMirror;if(!c)return[];const l=(c.spheres||[]).map(p=>({name:p.name,total:p.tasks_total||0,done:p.tasks_done||0,color:p.color})),t=(c.missing_spheres||[]).map(p=>({name:p.name,total:0,done:0,color:p.color}));return[...l,...t]});return(c,l)=>{var t,y,p,B,$,o,S,P,Y,w;return(t=a.data)!=null&&t.loading&&!((y=a.data)!=null&&y.lifeMirror)?(r(),s("div",dr,[...l[0]||(l[0]=[e("div",{class:"animate-spin rounded-full h-10 w-10 border-2 border-primary-600 border-t-transparent"},null,-1)])])):!((p=a.data)!=null&&p.loading)&&!((B=a.data)!=null&&B.lifeMirror)?(r(),s("div",ir,[...l[1]||(l[1]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},"Нет данных",-1),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"Создайте сферы жизни и задачи для аналитики",-1)])])):(r(),s(f,{key:2},[e("div",cr,[e("div",ur,[H(Qe,{spheres:h.value,"balance-index":(($=a.data.lifeMirror)==null?void 0:$.balance_index)||0,size:280,"hovered-sphere-name":i.value,onSphereHover:b,onSphereLeave:d},null,8,["spheres","balance-index","hovered-sphere-name"])]),e("div",gr,[(r(!0),s(f,null,C((o=a.data.lifeMirror)==null?void 0:o.spheres,A=>(r(),W(st,{key:A.id,sphere:A},null,8,["sphere"]))),128))])]),(P=(S=a.data.lifeMirror)==null?void 0:S.missing_spheres)!=null&&P.length?(r(),W(ct,{key:0,spheres:a.data.lifeMirror.missing_spheres,class:"mb-6"},null,8,["spheres"])):_("",!0),a.period==="day"?(r(),s("div",xr,[H(K,{message:a.data.aiMessage,loading:a.data.aiLoading},null,8,["message","loading"]),H(V,{data:(Y=a.data.lifeMirror)==null?void 0:Y.period_data,"hovered-sphere-name":i.value,onTaskHover:b,onTaskLeave:d},null,8,["data","hovered-sphere-name"])])):(r(),s(f,{key:2},[H(K,{message:a.data.aiMessage,loading:a.data.aiLoading,class:"mb-6"},null,8,["message","loading"]),(r(),W(de(v.value),{data:(w=a.data.lifeMirror)==null?void 0:w.period_data},null,8,["data"]))],64))],64))}}},yr={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},mr={class:"max-w-7xl mx-auto px-4 sm:px-6 py-6"},br={key:0,class:"text-center py-16"},vr={key:0,class:"mb-6"},kr={class:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide"},pr=["onClick"],fr={key:0,class:"text-base"},Yr={__name:"Dashboard",setup(a){const m=ge(),i=X(),b=L(()=>i.selectedWorkspaces),d=D(null),v=L(()=>d.value&&m.dataByWorkspace[d.value]||null);return U(()=>b.value.map(h=>h.id),h=>{if(!h.length){d.value=null;return}(!d.value||!h.includes(d.value))&&(d.value=h[0])},{immediate:!0}),ie(()=>{m.fetchAllWorkspaces()}),(h,c)=>(r(),s("div",yr,[e("div",mr,[H(ve,{period:O(m).selectedPeriod,onChangePeriod:O(m).setPeriod},null,8,["period","onChangePeriod"]),b.value.length?(r(),s(f,{key:1},[b.value.length>1?(r(),s("div",vr,[e("div",kr,[(r(!0),s(f,null,C(b.value,l=>(r(),s("button",{key:l.id,onClick:t=>d.value=l.id,class:j(["flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-xl whitespace-nowrap transition-all duration-200",[d.value===l.id?"bg-white dark:bg-gray-800 text-gray-900 dark:text-white shadow-sm ring-1 ring-gray-200 dark:ring-gray-700":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800/50"]])},[l.emoji?(r(),s("span",fr,n(l.emoji),1)):_("",!0),e("span",null,n(l.name),1)],10,pr))),128))])])):_("",!0),d.value?(r(),W(hr,{key:d.value,"workspace-id":d.value,period:O(m).selectedPeriod,data:v.value},null,8,["workspace-id","period","data"])):_("",!0)],64)):(r(),s("div",br,[...c[0]||(c[0]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},"Нет данных",-1),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"Выберите workspace для просмотра аналитики",-1)])]))])]))}};export{Yr as default};
