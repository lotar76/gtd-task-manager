import{c as i,o as s,a as e,j as ge,k as W,h as le,l as G,g as T,b as E,m as he,n as $e,p as R,t as $,r as v,f as x,w as O,q as Ce,s as te,x as oe,T as K,d as Z,F as re,y as ae,z as ve,A as ee,v as ie,B as de,e as U,C as ot,u as Me,i as st,D as we}from"./index-B6HI204u.js";import{u as ce}from"./workspace-Cm4YHt43.js";import{r as je,a as Se,b as _e,c as Te,d as Ee,e as De,u as rt,T as at}from"./TaskModal-CKlznka9.js";import{u as nt}from"./projects-BsIMSTaO.js";import{r as lt}from"./RectangleStackIcon-comqCMKw.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as it}from"./ProjectModal-D0xOu_v-.js";function dt(y,M){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function Y(y,M){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}const ct={class:"flex items-center space-x-3"},pe={__name:"NavLink",props:{to:{type:String,required:!0},icon:{type:String,default:"folder"},count:{type:Number,default:null}},emits:["close-sidebar"],setup(y,{emit:M}){const k=y,j=M,f=ge(),d=ce(),p=()=>{window.innerWidth<1024&&j("close-sidebar")},m={inbox:De,lightning:Ee,calendar:Te,clock:_e,archive:Se,folder:Y,"calendar-days":je,target:Y,"rectangle-stack":lt,cog:dt},h=W(()=>m[k.icon]||Y),n=W(()=>{var S;const l=(S=d.currentWorkspace)==null?void 0:S.id;return k.to.replace(":id",l||"1")}),o=W(()=>f.path===n.value);return(l,S)=>{const V=le("router-link");return s(),G(V,{to:n.value,onClick:p,class:R(["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors",o.value?"bg-primary-50 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"])},{default:T(()=>[e("div",ct,[(s(),G(he(h.value),{class:"w-5 h-5"})),e("span",null,[$e(l.$slots,"default")])]),y.count!==null&&y.count>0?(s(),i("span",{key:0,class:R(["px-2 py-0.5 text-xs font-semibold rounded-full",o.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"])},$(y.count),3)):E("",!0)]),_:3},8,["to","class"])}}},ut={class:"flex items-center space-x-3"},X={__name:"DroppableNavLink",props:{to:{type:String,required:!0},icon:{type:String,default:"folder"},count:{type:Number,default:null},dropStatus:{type:String,default:null}},emits:["task-dropped","close-sidebar"],setup(y,{emit:M}){const k=y,j=M,f=ge(),d=ce(),p=v(!1),m=()=>{window.innerWidth<1024&&j("close-sidebar")},h={inbox:De,lightning:Ee,calendar:Te,clock:_e,archive:Se,folder:Y,"calendar-days":je,target:Y},n=W(()=>h[k.icon]||Y),o=W(()=>{var A;const B=(A=d.currentWorkspace)==null?void 0:A.id;return k.to.replace(":id",B||"1")}),l=W(()=>f.path===o.value),S=B=>{B.preventDefault(),p.value=!0,B.dataTransfer.dropEffect="move"},V=()=>{p.value=!1},H=B=>{B.preventDefault(),p.value=!1;try{const A=JSON.parse(B.dataTransfer.getData("application/json"));k.dropStatus&&A&&j("task-dropped",{taskId:A.id,newStatus:k.dropStatus})}catch(A){console.error("Error handling drop:",A)}};return(B,A)=>{const u=le("router-link");return s(),i("div",{onDrop:H,onDragover:O(S,["prevent"]),onDragleave:V,class:R(["rounded-lg transition-all",p.value?"bg-primary-100 dark:bg-primary-900/40 ring-2 ring-primary-500":""])},[x(u,{to:o.value,onClick:m,class:R(["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors",l.value?"bg-primary-50 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"])},{default:T(()=>[e("div",ut,[(s(),G(he(n.value),{class:"w-5 h-5"})),e("span",null,[$e(B.$slots,"default")])]),y.count!==null&&y.count>0?(s(),i("span",{key:0,class:R(["px-2 py-0.5 text-xs font-semibold rounded-full",l.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"])},$(y.count),3)):E("",!0)]),_:3},8,["to","class"])],34)}}},vt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%20width='300'%20height='300'%3e%3ccircle%20cx='150'%20cy='150'%20r='137.5'%20fill='none'%20stroke='%23E84848'%20stroke-width='25'/%3e%3ccircle%20cx='150'%20cy='150'%20r='87.5'%20fill='none'%20stroke='%23E84848'%20stroke-width='25'/%3e%3ccircle%20cx='150'%20cy='150'%20r='37.5'%20fill='none'%20stroke='%23E84848'%20stroke-width='25'/%3e%3ccircle%20cx='150'%20cy='150'%20r='8'%20fill='%23E84848'/%3e%3c/svg%3e",pt="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%20width='300'%20height='300'%3e%3ccircle%20cx='150'%20cy='150'%20r='137.5'%20fill='none'%20stroke='%23FFFFFF'%20stroke-width='25'/%3e%3ccircle%20cx='150'%20cy='150'%20r='87.5'%20fill='none'%20stroke='%23FFFFFF'%20stroke-width='25'/%3e%3ccircle%20cx='150'%20cy='150'%20r='37.5'%20fill='none'%20stroke='%23FFFFFF'%20stroke-width='25'/%3e%3ccircle%20cx='150'%20cy='150'%20r='8'%20fill='%23FFFFFF'/%3e%3c/svg%3e",gt={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-20"},kt={class:"flex items-center justify-between px-4 lg:px-8 py-3"},mt={class:"lg:hidden flex items-center mr-3"},yt=["src"],ft={class:"flex items-center space-x-2 lg:space-x-4 ml-4"},xt={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2 z-50"},bt={class:"relative"},wt={key:0,class:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white"},ht={key:0,class:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2 max-h-96 overflow-y-auto"},$t={key:0,class:"px-4 py-6 text-center text-sm text-gray-500 dark:text-gray-400"},Ct={key:1},Mt={class:"text-sm text-gray-900 dark:text-gray-100"},jt={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},St=["title"],_t={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Tt={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Et={class:"hidden lg:block relative"},Dt={class:"w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},Lt={class:"hidden lg:block text-left"},Bt={class:"text-sm font-medium text-gray-900 dark:text-white"},Wt={class:"text-xs text-gray-500 dark:text-gray-400"},At={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2"},Ft={__name:"Toolbar",props:{user:{type:Object,default:null}},emits:["quick-add","quick-add-task","quick-add-project","quick-add-goal","search","logout","profile","settings"],setup(y,{emit:M}){const k=Ce(),j=W(()=>k.isDark?pt:vt),f=y,d=M;v("");const p=v(!1),m=v(!1),h=v(!1),n=v(0),o=v([]),l=v(null),S=W(()=>{var a;return(((a=f.user)==null?void 0:a.name)||"").split(" ").map(I=>I[0]).join("").toUpperCase().slice(0,2)}),V=()=>{h.value=!h.value},H=()=>{h.value=!1,d("quick-add-task")},B=()=>{h.value=!1,d("quick-add-project")},A=()=>{h.value=!1,d("quick-add-goal")},u=C=>{l.value&&!l.value.contains(C.target)&&(h.value=!1)},c=C=>{C.key==="Escape"&&(h.value=!1,p.value=!1,m.value=!1)};te(()=>{document.addEventListener("click",u),document.addEventListener("keydown",c)}),oe(()=>{document.removeEventListener("click",u),document.removeEventListener("keydown",c)});const b=()=>{m.value=!1,d("logout")},F=()=>{m.value=!1,d("profile")},q=()=>{m.value=!1,d("settings")},D={mounted(C,a){C.clickOutsideEvent=I=>{C===I.target||C.contains(I.target)||a.value()},document.addEventListener("click",C.clickOutsideEvent)},unmounted(C){document.removeEventListener("click",C.clickOutsideEvent)}};return(C,a)=>{var I,N;return s(),i("header",gt,[e("div",kt,[e("div",mt,[e("img",{src:j.value,alt:"GTD TODO",class:"h-8 w-8 object-contain"},null,8,yt)]),a[16]||(a[16]=e("div",{class:"flex-1"},null,-1)),e("div",ft,[e("div",{class:"relative",ref_key:"quickAddMenuContainer",ref:l},[e("button",{onClick:O(V,["stop"]),class:"inline-flex items-center px-3 lg:px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-primary-500 transition-colors"},[...a[3]||(a[3]=[e("svg",{class:"w-5 h-5 lg:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",{class:"hidden lg:inline"},"Создать",-1)])]),x(K,{name:"dropdown"},{default:T(()=>[h.value?(s(),i("div",xt,[e("button",{onClick:H,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[4]||(a[4]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",null,"Задачу")],-1)])]),e("button",{onClick:B,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[5]||(a[5]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})]),e("span",null,"Проект")],-1)])]),e("button",{onClick:A,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[6]||(a[6]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})]),e("span",null,"Цель")],-1)])])])):E("",!0)]),_:1})],512),e("div",bt,[e("button",{onClick:a[0]||(a[0]=O(L=>p.value=!p.value,["stop"])),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors relative"},[a[7]||(a[7]=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),n.value>0?(s(),i("span",wt)):E("",!0)]),p.value?Z((s(),i("div",ht,[a[8]||(a[8]=e("div",{class:"px-4 py-2 border-b border-gray-200 dark:border-gray-600"},[e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Уведомления")],-1)),o.value.length===0?(s(),i("div",$t," Нет новых уведомлений ")):(s(),i("div",Ct,[(s(!0),i(re,null,ae(o.value,L=>(s(),i("button",{key:L.id,class:"w-full px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors text-left"},[e("p",Mt,$(L.message),1),e("p",jt,$(L.time),1)]))),128))]))])),[[D,()=>p.value=!1]]):E("",!0)]),e("button",{onClick:a[1]||(a[1]=L=>ve(k).toggleTheme()),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:ve(k).isDark?"Светлая тема":"Тёмная тема"},[ve(k).isDark?(s(),i("svg",_t,[...a[9]||(a[9]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(s(),i("svg",Tt,[...a[10]||(a[10]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))],8,St),e("div",Et,[e("button",{onClick:a[2]||(a[2]=O(L=>m.value=!m.value,["stop"])),class:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[e("div",Dt,$(S.value),1),e("div",Lt,[e("div",Bt,$((I=y.user)==null?void 0:I.name),1),e("div",Wt,$((N=y.user)==null?void 0:N.email),1)]),a[11]||(a[11]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),m.value?Z((s(),i("div",At,[e("button",{onClick:F,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[12]||(a[12]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),e("span",null,"Профиль")],-1)])]),e("button",{onClick:q,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[13]||(a[13]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]),e("span",null,"Настройки")],-1)])]),a[15]||(a[15]=e("div",{class:"border-t border-gray-200 dark:border-gray-600 my-2"},null,-1)),e("button",{onClick:b,class:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors"},[...a[14]||(a[14]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})]),e("span",null,"Выйти")],-1)])])])),[[D,()=>m.value=!1]]):E("",!0)])])])])}}},Ot=se(Ft,[["__scopeId","data-v-87261f5f"]]),Pt="/assets/logo-D4KoLT79.jpg",zt="/assets/logo-bg-CxxxX31b.png",Vt={class:"flex min-h-screen items-center justify-center p-4"},It={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},qt={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},Rt={class:"flex justify-end space-x-3 pt-4"},Ht=["disabled"],Qt={__name:"WorkspaceModal",props:{show:{type:Boolean,default:!1}},emits:["close","submit"],setup(y,{emit:M}){const k=y,j=M,f=n=>{n.key==="Escape"&&k.show&&j("close")};te(()=>document.addEventListener("keydown",f)),oe(()=>document.removeEventListener("keydown",f));const d=v({name:"",description:""}),p=v(!1),m=v("");ee(()=>k.show,n=>{n||(d.value={name:"",description:""},p.value=!1,m.value="")});const h=()=>{m.value="",p.value=!0,j("submit",d.value)};return(n,o)=>(s(),G(de,{to:"body"},[x(K,{name:"modal"},{default:T(()=>[y.show?(s(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:o[5]||(o[5]=O(l=>n.$emit("close"),["self"]))},[o[10]||(o[10]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",Vt,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:o[4]||(o[4]=O(()=>{},["stop"]))},[e("div",It,[o[7]||(o[7]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Новое рабочее пространство ",-1)),e("button",{onClick:o[0]||(o[0]=l=>n.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...o[6]||(o[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:O(h,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[o[8]||(o[8]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название * ",-1)),Z(e("input",{id:"name","onUpdate:modelValue":o[1]||(o[1]=l=>d.value.name=l),type:"text",required:"",class:"input",placeholder:"Например: Команда разработки"},null,512),[[ie,d.value.name]])]),e("div",null,[o[9]||(o[9]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),Z(e("textarea",{id:"description","onUpdate:modelValue":o[2]||(o[2]=l=>d.value.description=l),rows:"3",class:"input",placeholder:"Краткое описание рабочего пространства"},null,512),[[ie,d.value.description]])]),m.value?(s(),i("div",qt,$(m.value),1)):E("",!0),e("div",Rt,[e("button",{type:"button",onClick:o[3]||(o[3]=l=>n.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:p.value,class:"btn btn-primary"},$(p.value?"Создание...":"Создать"),9,Ht)])],32)])])])):E("",!0)]),_:1})]))}},Ut=se(Qt,[["__scopeId","data-v-68182ad4"]]),Nt={class:"flex min-h-screen items-center justify-center p-4"},Gt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Kt={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},Zt={class:"font-medium"},Jt={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},Xt={class:"flex justify-end space-x-3 pt-4"},Yt=["disabled"],eo={__name:"AddMemberModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","submit"],setup(y,{emit:M}){const k=y,j=M,f=n=>{n.key==="Escape"&&k.show&&j("close")};te(()=>document.addEventListener("keydown",f)),oe(()=>document.removeEventListener("keydown",f));const d=v({email:"",role:"member"}),p=v(!1),m=v("");ee(()=>k.show,n=>{n||(d.value={email:"",role:"member"},p.value=!1,m.value="")});const h=()=>{var n;m.value="",p.value=!0,j("submit",{...d.value,workspace_id:(n=k.workspace)==null?void 0:n.id})};return(n,o)=>(s(),G(de,{to:"body"},[x(K,{name:"modal"},{default:T(()=>{var l;return[y.show?(s(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:o[5]||(o[5]=O(S=>n.$emit("close"),["self"]))},[o[12]||(o[12]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",Nt,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:o[4]||(o[4]=O(()=>{},["stop"]))},[e("div",Gt,[o[7]||(o[7]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Добавить пользователя ",-1)),e("button",{onClick:o[0]||(o[0]=S=>n.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...o[6]||(o[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:O(h,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[e("p",Kt,[o[8]||(o[8]=U(" Workspace: ",-1)),e("span",Zt,$((l=y.workspace)==null?void 0:l.name),1)])]),e("div",null,[o[9]||(o[9]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Email пользователя * ",-1)),Z(e("input",{id:"email","onUpdate:modelValue":o[1]||(o[1]=S=>d.value.email=S),type:"email",required:"",class:"input",placeholder:"user@example.com"},null,512),[[ie,d.value.email]])]),e("div",null,[o[11]||(o[11]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Роль ",-1)),Z(e("select",{id:"role","onUpdate:modelValue":o[2]||(o[2]=S=>d.value.role=S),class:"input"},[...o[10]||(o[10]=[e("option",{value:"viewer"},"Просмотр",-1),e("option",{value:"member"},"Участник",-1),e("option",{value:"admin"},"Администратор",-1)])],512),[[ot,d.value.role]])]),m.value?(s(),i("div",Jt,$(m.value),1)):E("",!0),e("div",Xt,[e("button",{type:"button",onClick:o[3]||(o[3]=S=>n.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:p.value,class:"btn btn-primary"},$(p.value?"Добавление...":"Добавить"),9,Yt)])],32)])])])):E("",!0)]}),_:1})]))}},to=se(eo,[["__scopeId","data-v-72cbffa0"]]),oo={class:"flex min-h-screen items-center justify-center p-4"},so={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},ro={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},ao={class:"flex justify-end space-x-3 pt-4"},no=["disabled"],lo={__name:"RenameWorkspaceModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","submit"],setup(y,{emit:M}){const k=y,j=M,f=n=>{n.key==="Escape"&&k.show&&j("close")};te(()=>document.addEventListener("keydown",f)),oe(()=>document.removeEventListener("keydown",f));const d=v({name:""}),p=v(!1),m=v("");ee(()=>k.workspace,n=>{n&&(d.value.name=n.name)},{immediate:!0}),ee(()=>k.show,n=>{n||(p.value=!1,m.value="")});const h=()=>{m.value="",p.value=!0,j("submit",d.value.name)};return(n,o)=>(s(),G(de,{to:"body"},[x(K,{name:"modal"},{default:T(()=>[y.show?(s(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:o[4]||(o[4]=O(l=>n.$emit("close"),["self"]))},[o[8]||(o[8]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",oo,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:o[3]||(o[3]=O(()=>{},["stop"]))},[e("div",so,[o[6]||(o[6]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Переименовать workspace ",-1)),e("button",{onClick:o[0]||(o[0]=l=>n.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...o[5]||(o[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:O(h,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[o[7]||(o[7]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Новое название * ",-1)),Z(e("input",{id:"name","onUpdate:modelValue":o[1]||(o[1]=l=>d.value.name=l),type:"text",required:"",class:"input",placeholder:"Название workspace"},null,512),[[ie,d.value.name]])]),m.value?(s(),i("div",ro,$(m.value),1)):E("",!0),e("div",ao,[e("button",{type:"button",onClick:o[2]||(o[2]=l=>n.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:p.value,class:"btn btn-primary"},$(p.value?"Сохранение...":"Сохранить"),9,no)])],32)])])])):E("",!0)]),_:1})]))}},io=se(lo,[["__scopeId","data-v-9efc4d3d"]]),co={class:"flex min-h-screen items-center justify-center p-4"},uo={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},vo={class:"p-6"},po={key:0,class:"text-center py-8"},go={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},ko={key:2,class:"space-y-3"},mo={class:"flex items-center space-x-3"},yo={class:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},fo={class:"font-medium text-gray-900 dark:text-white"},xo={class:"text-sm text-gray-500 dark:text-gray-400"},bo={class:"flex items-center space-x-3"},wo=["onClick","disabled"],ho={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},$o={key:1,class:"inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-red-600"},Co={key:0,class:"px-6 pb-4"},Mo={class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},jo={class:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700"},So={__name:"MembersModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","member-removed"],setup(y,{emit:M}){const k=y,j=M,f=u=>{u.key==="Escape"&&k.show&&j("close")};te(()=>document.addEventListener("keydown",f)),oe(()=>document.removeEventListener("keydown",f));const d=ce(),p=Me(),m=v([]),h=v(!1),n=v(""),o=v(null),l=u=>u?u.split(" ").map(c=>c[0]).join("").toUpperCase().substring(0,2):"?",S=u=>({owner:"Владелец",admin:"Администратор",member:"Участник",viewer:"Наблюдатель"})[u]||u,V=u=>({owner:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",admin:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",member:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",viewer:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"})[u]||"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400",H=u=>{var q,D,C,a,I,N,L;const c=(q=p.user)==null?void 0:q.id,b=((D=k.workspace)==null?void 0:D.owner_id)===c,F=((N=(I=(a=(C=k.workspace)==null?void 0:C.members)==null?void 0:a.find(ne=>ne.id===c))==null?void 0:I.pivot)==null?void 0:N.role)==="admin";return((L=k.workspace)==null?void 0:L.owner_id)===u.id||u.id===c?!1:b||F},B=async()=>{var u;if((u=k.workspace)!=null&&u.id){h.value=!0,n.value="";try{const c=await d.fetchMembers(k.workspace.id);m.value=c.members||c||[]}catch(c){console.error("Error loading members:",c),n.value="Ошибка при загрузке участников"}finally{h.value=!1}}},A=async u=>{var c,b;if(confirm(`Вы уверены, что хотите удалить ${u.name} из workspace?`)){o.value=u.id,n.value="";try{await d.removeMember(k.workspace.id,u.id),await B(),j("member-removed",u)}catch(F){console.error("Error removing member:",F),n.value=((b=(c=F.response)==null?void 0:c.data)==null?void 0:b.message)||"Ошибка при удалении участника"}finally{o.value=null}}};return ee(()=>k.show,u=>{u?B():(m.value=[],n.value="",o.value=null)}),ee(()=>{var u;return(u=k.workspace)==null?void 0:u.id},()=>{k.show&&B()}),(u,c)=>(s(),G(de,{to:"body"},[x(K,{name:"modal"},{default:T(()=>[y.show?(s(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:c[3]||(c[3]=O(b=>u.$emit("close"),["self"]))},[c[8]||(c[8]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",co,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-auto",onClick:c[2]||(c[2]=O(()=>{},["stop"]))},[e("div",uo,[c[5]||(c[5]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Участники workspace ",-1)),e("button",{onClick:c[0]||(c[0]=b=>u.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...c[4]||(c[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",vo,[h.value?(s(),i("div",po,[...c[6]||(c[6]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):m.value.length===0?(s(),i("div",go," Нет участников ")):(s(),i("div",ko,[(s(!0),i(re,null,ae(m.value,b=>{var F,q,D,C;return s(),i("div",{key:b.id,class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[e("div",mo,[e("div",yo,$(l(b.name)),1),e("div",null,[e("div",fo,$(b.name),1),e("div",xo,$(b.email),1)])]),e("div",bo,[e("span",{class:R(["px-3 py-1 text-xs font-medium rounded-full",V(((F=b.pivot)==null?void 0:F.role)||(((q=y.workspace)==null?void 0:q.owner_id)===b.id?"owner":"member"))])},$(S(((D=b.pivot)==null?void 0:D.role)||(((C=y.workspace)==null?void 0:C.owner_id)===b.id?"owner":"member"))),3),H(b)?(s(),i("button",{key:0,onClick:a=>A(b),class:"text-red-600 hover:text-red-700 p-2 rounded transition-colors",disabled:o.value===b.id,title:"Удалить из workspace"},[o.value!==b.id?(s(),i("svg",ho,[...c[7]||(c[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1)])])):(s(),i("div",$o))],8,wo)):E("",!0)])])}),128))]))]),n.value?(s(),i("div",Co,[e("div",Mo,$(n.value),1)])):E("",!0),e("div",jo,[e("button",{onClick:c[1]||(c[1]=b=>u.$emit("close")),class:"btn btn-secondary"}," Закрыть ")])])])])):E("",!0)]),_:1})]))}},_o=se(So,[["__scopeId","data-v-e1a886d2"]]),To={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},Eo={key:0,class:"fixed inset-0 z-[100] bg-white dark:bg-gray-900 flex items-center justify-center"},Do={class:"text-center"},Lo={class:"mb-6 flex justify-center"},Bo=["src"],Wo={class:"text-sm text-gray-500 dark:text-gray-400 flex justify-center"},Ao={class:"flex h-screen"},Fo={class:"flex flex-col h-full"},Oo={class:"hidden lg:flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Po={class:"flex items-center space-x-3"},zo=["src"],Vo={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Io={class:"flex items-center justify-between mb-3"},qo={class:"space-y-1"},Ro=["onClick"],Ho={class:"flex-1 overflow-y-auto p-4"},Qo={class:"space-y-1"},Uo={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 space-y-1"},No={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},Go={class:"space-y-1 max-h-64 overflow-y-auto"},Ko={class:"flex-1 min-w-0"},Zo={class:"flex items-center space-x-1"},Jo={key:0,class:"text-xs text-gray-500 flex-shrink-0"},Xo={class:"text-xs text-gray-400 dark:text-gray-500 truncate"},Yo={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},es={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},ts={class:"space-y-1"},os={key:1,class:"fixed bottom-5 right-5 z-30 lg:hidden flex flex-col gap-3 items-center"},ss={class:"flex-1 flex flex-col overflow-hidden"},rs={class:"flex-1 overflow-auto"},as={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4"},ns={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-sm w-full p-6"},ls={class:"text-sm text-gray-500 dark:text-gray-400 mb-6"},is={__name:"MainLayout",setup(y){const M=st(),k=ge(),j=Me(),f=ce(),d=rt(),p=nt(),m=Ce(),h=W(()=>m.isDark?zt:Pt),n=v(!0),o=v("Загрузка...".split("")),l=v(!1);v(!1);const S=v(!1),V=v(!1),H=v(""),B=v(null),A=v(!1),u=v(!1),c=v(!1),b=v(!1),F=v(null),q=v(""),D=v(null),C=v(!1),a=v(null),I=W(()=>j.user),N=W(()=>f.workspaces),L=W(()=>d.counts);W(()=>f.currentWorkspace);const ne=W(()=>p.activeProjects),ue=W(()=>f.selectedWorkspaces.map(g=>g.id)),Le=W(()=>d.filteredTasks.length),Be=W(()=>{if(ue.value.length===0)return 0;const g=L.value.scheduled||0,t=L.value.today||0,w=L.value.tomorrow||0;return g+t+w});W(()=>{var t;return(((t=I.value)==null?void 0:t.name)||"").split(" ").map(w=>w[0]).join("").toUpperCase().slice(0,2)});const ke=g=>{var Q;f.toggleSelectedWorkspace(g);const w=M.currentRoute.value.path.split("/"),_=w[w.length-1],P=["inbox","next-actions","today","waiting","someday","calendar","projects","goals"].includes(_)?_:"inbox",z=((Q=f.currentWorkspace)==null?void 0:Q.id)||g.id;M.push(`/workspaces/${z}/${P}`)},We=async g=>{try{const t=await f.createWorkspace(g);S.value=!1,await ke(t)}catch(t){console.error("Ошибка создания workspace:",t)}},Ae=async()=>{await j.logout(),M.push("/login")},Fe=()=>{V.value=!0},me=()=>{F.value=null,b.value=!0},Oe=async g=>{var t,w;q.value="";try{F.value?await p.updateProject(F.value.id,g):await p.createProject(g),b.value=!1,F.value=null,await p.fetchAllProjects({force:!0})}catch(_){console.error("Error saving project:",_),q.value=((w=(t=_.response)==null?void 0:t.data)==null?void 0:w.message)||_.message||"Ошибка при сохранении проекта"}},Pe=()=>{b.value=!1,F.value=null,q.value=""},ze=()=>{console.log("Quick add goal")},Ve=async g=>{var t,w;H.value="";try{await d.createTask(g),V.value=!1}catch(_){console.error("Error creating task:",_),H.value=((w=(t=_.response)==null?void 0:t.data)==null?void 0:w.message)||_.message||"Ошибка при создании задачи"}},Ie=()=>{V.value=!1,H.value=""},J=async({taskId:g,newStatus:t})=>{var w,_;try{const r={status:t};if(t==="today")r.due_date=new Date().toISOString().split("T")[0];else if(t==="tomorrow"){const P=new Date;P.setDate(P.getDate()+1),r.due_date=P.toISOString().split("T")[0]}await d.updateTask(g,r)}catch(r){console.error("Error updating task status:",r),alert(((_=(w=r.response)==null?void 0:w.data)==null?void 0:_.message)||"Ошибка при обновлении задачи")}},qe=()=>{window.innerWidth<1024&&(l.value=!1)},Re=g=>{console.log("Search:",g)},He=()=>{M.push("/settings")},Qe=()=>{M.push("/settings")},Ue=g=>{g.target.style.display="none"},Ne=async()=>{if(a.value){try{await f.deleteWorkspace(a.value.id)}catch(g){console.error("Error deleting workspace:",g)}C.value=!1,a.value=null}},ye=()=>{C.value=!1,a.value=null},Ge=()=>{A.value=!1,D.value=null},Ke=()=>{c.value=!1,D.value=null},Ze=async()=>{await f.fetchWorkspaces()},Je=()=>{u.value=!1,D.value=null},Xe=async g=>{var t,w,_,r,P;try{console.log("Sending member data:",g),await f.addMember(g.workspace_id,{email:g.email,role:g.role}),A.value=!1,D.value=null,alert("Пользователь успешно добавлен в workspace")}catch(z){console.error("Error adding member:",z),console.error("Error response:",(t=z.response)==null?void 0:t.data);let Q="Ошибка при добавлении пользователя";(_=(w=z.response)==null?void 0:w.data)!=null&&_.errors?Q=Object.values(z.response.data.errors).flat().join(", "):(P=(r=z.response)==null?void 0:r.data)!=null&&P.message&&(Q=z.response.data.message),alert(Q)}},Ye=async g=>{var t,w,_,r,P;try{console.log("Renaming workspace:",D.value.id,"to:",g),await f.updateWorkspace(D.value.id,{name:g}),await f.fetchWorkspaces(),u.value=!1,D.value=null,alert("Workspace успешно переименован")}catch(z){console.error("Error renaming workspace:",z),console.error("Error response:",(t=z.response)==null?void 0:t.data);let Q="Ошибка при переименовании";(_=(w=z.response)==null?void 0:w.data)!=null&&_.errors?Q=Object.values(z.response.data.errors).flat().join(", "):(P=(r=z.response)==null?void 0:r.data)!=null&&P.message&&(Q=z.response.data.message),alert(Q)}},fe=g=>{g.key==="Escape"&&(B.value=null)};te(async()=>{try{await f.fetchWorkspaces(),await Promise.all([d.fetchAllTasks(),p.fetchAllProjects()])}finally{n.value=!1}d.startSync(),p.startSync(),document.addEventListener("click",xe),document.addEventListener("keydown",fe)}),oe(()=>{d.stopSync(),p.stopSync(),document.removeEventListener("click",xe),document.removeEventListener("keydown",fe)});const xe=()=>{B.value=null},et=g=>{const t=N.value.find(w=>w.id===g);return(t==null?void 0:t.name)||""},be=g=>k.path.includes(`/projects/${g}`);return(g,t)=>{const w=le("router-link"),_=le("router-view");return s(),i("div",To,[x(K,{name:"fade"},{default:T(()=>[n.value?(s(),i("div",Eo,[e("div",Do,[e("div",Lo,[e("img",{src:h.value,alt:"GTD TODO",class:"w-48 h-48 object-contain",onError:Ue},null,40,Bo)]),t[16]||(t[16]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"GTD TODO",-1)),e("p",Wo,[(s(!0),i(re,null,ae(o.value,(r,P)=>(s(),i("span",{key:P,style:we({animationDelay:`${P*.1}s`}),class:"loading-letter"},$(r),5))),128))])])])):E("",!0)]),_:1}),e("div",Ao,[e("aside",{class:R(["fixed lg:static inset-y-0 left-0 z-40 w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 ease-in-out",l.value?"translate-x-0":"-translate-x-full lg:translate-x-0"])},[e("div",Fo,[e("div",Oo,[e("div",Po,[e("img",{src:h.value,alt:"GTD TODO",class:"h-10 w-10 object-contain"},null,8,zo),t[17]||(t[17]=e("h1",{class:"text-xl font-bold text-gray-900 dark:text-white"},"GTD TODO",-1))])]),e("div",Vo,[e("div",Io,[t[19]||(t[19]=e("h3",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Рабочие пространства ",-1)),e("button",{onClick:t[0]||(t[0]=r=>S.value=!0),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:"Создать workspace"},[...t[18]||(t[18]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),e("div",qo,[(s(!0),i(re,null,ae(N.value,r=>(s(),i("div",{key:r.id,class:R(["group flex items-center rounded-lg transition-colors overflow-hidden",ue.value.includes(r.id)?"bg-primary-50 dark:bg-primary-900/30":"hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("button",{class:"flex-1 flex items-center px-3 py-2 text-sm cursor-pointer text-left",onClick:P=>ke(r)},[e("span",{class:R(["truncate",ue.value.includes(r.id)?"text-primary-700 dark:text-primary-400 font-medium":"text-gray-500 dark:text-gray-400"])},$(r.name),3)],8,Ro),x(w,{to:`/workspaces/${r.id}/settings`,class:"flex-shrink-0 p-1.5 mr-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded transition-colors opacity-0 group-hover:opacity-100",title:"Настройки",onClick:t[1]||(t[1]=O(()=>{},["stop"]))},{default:T(()=>[...t[20]||(t[20]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})],-1)])]),_:1},8,["to"])],2))),128))])]),e("nav",Ho,[e("div",Qo,[x(X,{to:"/workspaces/:id/inbox",icon:"inbox",count:L.value.inbox,"drop-status":"inbox",onTaskDropped:J,onCloseSidebar:t[2]||(t[2]=r=>l.value=!1)},{default:T(()=>[...t[21]||(t[21]=[U(" Входящие ",-1)])]),_:1},8,["count"])]),e("div",Uo,[x(X,{to:"/workspaces/:id/today",icon:"calendar",count:L.value.today,"drop-status":"today",onTaskDropped:J,onCloseSidebar:t[3]||(t[3]=r=>l.value=!1)},{default:T(()=>[...t[22]||(t[22]=[U(" Сегодня ",-1)])]),_:1},8,["count"]),x(X,{to:"/workspaces/:id/next-actions",icon:"lightning",count:L.value.next_actions,"drop-status":"next_action",onTaskDropped:J,onCloseSidebar:t[4]||(t[4]=r=>l.value=!1)},{default:T(()=>[...t[23]||(t[23]=[U(" Следующие ",-1)])]),_:1},8,["count"]),x(X,{to:"/workspaces/:id/tomorrow",icon:"calendar-days",count:L.value.tomorrow,"drop-status":"tomorrow",onTaskDropped:J,onCloseSidebar:t[5]||(t[5]=r=>l.value=!1)},{default:T(()=>[...t[24]||(t[24]=[U(" Завтра ",-1)])]),_:1},8,["count"]),x(pe,{to:"/workspaces/:id/calendar",icon:"calendar-days",count:Be.value,onCloseSidebar:t[6]||(t[6]=r=>l.value=!1)},{default:T(()=>[...t[25]||(t[25]=[U(" Календарь ",-1)])]),_:1},8,["count"]),x(X,{to:"/workspaces/:id/someday",icon:"archive",count:L.value.someday,"drop-status":"someday",onTaskDropped:J,onCloseSidebar:t[7]||(t[7]=r=>l.value=!1)},{default:T(()=>[...t[26]||(t[26]=[U(" Когда-нибудь ",-1)])]),_:1},8,["count"]),x(X,{to:"/workspaces/:id/waiting",icon:"clock",count:L.value.waiting,"drop-status":"waiting",onTaskDropped:J,onCloseSidebar:t[8]||(t[8]=r=>l.value=!1)},{default:T(()=>[...t[27]||(t[27]=[U(" Ожидание ",-1)])]),_:1},8,["count"]),x(pe,{to:"/workspaces/:id/all",icon:"rectangle-stack",count:Le.value,onCloseSidebar:t[9]||(t[9]=r=>l.value=!1)},{default:T(()=>[...t[28]||(t[28]=[U(" Все задачи ",-1)])]),_:1},8,["count"])]),e("div",No,[e("div",{class:"flex items-center justify-between px-3 mb-3"},[t[30]||(t[30]=e("h3",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Проекты ",-1)),e("button",{onClick:me,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Создать проект"},[...t[29]||(t[29]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),e("div",Go,[(s(!0),i(re,null,ae(ne.value,r=>(s(),i("div",{key:r.id,class:R(["flex items-center justify-between group px-3 py-2 rounded-lg transition-colors",be(r.id)?"bg-primary-50 dark:bg-primary-900/30":"hover:bg-gray-50 dark:hover:bg-gray-700"])},[x(w,{to:`/workspaces/${r.workspace_id}/projects/${r.id}`,onClick:qe,class:"flex items-center space-x-2 flex-1 min-w-0"},{default:T(()=>[e("div",{class:"w-3 h-3 rounded-full flex-shrink-0",style:we({backgroundColor:r.color||"#3B82F6"})},null,4),e("div",Ko,[e("div",Zo,[e("span",{class:R(["text-sm truncate",be(r.id)?"text-primary-700 dark:text-primary-400 font-medium":"text-gray-700 dark:text-gray-300"])},$(r.name),3),r.tasks_count>0?(s(),i("span",Jo," ("+$(r.tasks_count)+") ",1)):E("",!0)]),e("div",Xo,$(et(r.workspace_id)),1)])]),_:2},1032,["to"])],2))),128)),ne.value.length===0?(s(),i("div",Yo," Нет проектов ")):E("",!0)])]),e("div",es,[t[32]||(t[32]=e("h3",{class:"px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3"}," Организация ",-1)),e("div",ts,[x(pe,{to:"/workspaces/:id/goals",icon:"target",onCloseSidebar:t[10]||(t[10]=r=>l.value=!1)},{default:T(()=>[...t[31]||(t[31]=[U(" Цели ",-1)])]),_:1})])])])])],2),l.value?(s(),i("div",{key:0,onClick:t[11]||(t[11]=r=>l.value=!1),class:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden"})):E("",!0),l.value?E("",!0):(s(),i("div",os,[e("button",{onClick:t[12]||(t[12]=r=>V.value=!0),class:"w-10 h-10 bg-green-500 hover:bg-green-600 text-white rounded-full shadow-lg flex items-center justify-center active:scale-95 transition-transform"},[...t[33]||(t[33]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1)])]),x(w,{to:"/calendar",class:"w-10 h-10 bg-purple-600 hover:bg-purple-700 text-white rounded-full shadow-lg flex items-center justify-center active:scale-95 transition-transform"},{default:T(()=>[...t[34]||(t[34]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])]),_:1}),e("button",{onClick:t[13]||(t[13]=r=>l.value=!0),class:"w-12 h-12 bg-primary-600 hover:bg-primary-700 text-white rounded-full shadow-lg flex items-center justify-center active:scale-95 transition-transform"},[...t[35]||(t[35]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})],-1)])])])),e("main",ss,[x(Ot,{user:I.value,onQuickAddTask:Fe,onQuickAddProject:me,onQuickAddGoal:ze,onSearch:Re,onLogout:Ae,onProfile:He,onSettings:Qe,onToggleSidebar:t[14]||(t[14]=r=>l.value=!l.value)},null,8,["user"]),e("div",rs,[x(_)])])]),x(Ut,{show:S.value,onClose:t[15]||(t[15]=r=>S.value=!1),onSubmit:We},null,8,["show"]),x(at,{show:V.value,"server-error":H.value,onClose:Ie,onSubmit:Ve},null,8,["show","server-error"]),x(to,{show:A.value,workspace:D.value,onClose:Ge,onSubmit:Xe},null,8,["show","workspace"]),x(io,{show:u.value,workspace:D.value,onClose:Je,onSubmit:Ye},null,8,["show","workspace"]),x(_o,{show:c.value,workspace:D.value,onClose:Ke,onMemberRemoved:Ze},null,8,["show","workspace"]),x(it,{show:b.value,project:F.value,"server-error":q.value,onClose:Pe,onSubmit:Oe},null,8,["show","project","server-error"]),x(K,{name:"modal"},{default:T(()=>{var r;return[C.value?(s(),i("div",as,[e("div",{class:"fixed inset-0 bg-black/50",onClick:ye}),e("div",ns,[t[36]||(t[36]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"Удалить пространство?",-1)),e("p",ls," Пространство «"+$((r=a.value)==null?void 0:r.name)+"» будет удалено навсегда. Это действие нельзя отменить. ",1),e("div",{class:"flex justify-end space-x-3"},[e("button",{onClick:ye,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," Отмена "),e("button",{onClick:Ne,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors"}," Удалить ")])])])):E("",!0)]}),_:1})])}}},ms=se(is,[["__scopeId","data-v-c8854e3d"]]);export{ms as default};
