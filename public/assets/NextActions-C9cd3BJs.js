import{u as w,T as y}from"./TaskModal-CJhei9Ul.js";import{_ as b}from"./TaskList-DsFPsP-2.js";import{k as p,r as i,c as v,a as n,l as C,f as B,o as u}from"./index-C08jv159.js";import"./workspace-BpQsCEKO.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ru-B7JyRvIu.js";const E={class:"p-4 lg:p-8"},M={class:"max-w-4xl mx-auto"},S={key:0,class:"text-center py-12"},F={__name:"NextActions",setup(N){const a=w(),f=p(()=>a.nextActionTasks),g=p(()=>a.loading),r=i(!1),o=i(null),l=i(""),T=e=>{o.value=e,r.value=!0},x=async e=>{try{e.status==="completed"?await a.updateTask(e.id,{status:"next_action"}):await a.completeTask(e.id)}catch(s){console.error("Error toggling task:",s)}},_=async e=>{var s,d,k,m;l.value="";try{o.value?await a.updateTask(o.value.id,e):await a.createTask(e),r.value=!1,o.value=null}catch(t){console.error("Error saving task:",t);let c="Ошибка при сохранении задачи";(d=(s=t.response)==null?void 0:s.data)!=null&&d.errors?c=Object.values(t.response.data.errors).flat().join(", "):(m=(k=t.response)==null?void 0:k.data)!=null&&m.message&&(c=t.response.data.message),l.value=c}},h=()=>{r.value=!1,o.value=null,l.value=""};return(e,s)=>(u(),v("div",E,[n("div",M,[s[1]||(s[1]=n("div",{class:"mb-6"},[n("h1",{class:"text-xl lg:text-2xl font-semibold text-gray-900"},"Следующие")],-1)),g.value?(u(),v("div",S,[...s[0]||(s[0]=[n("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):(u(),C(b,{key:1,tasks:f.value,onTaskClick:T,onToggleComplete:x},null,8,["tasks"])),B(y,{show:r.value,task:o.value,"server-error":l.value,onClose:h,onSubmit:_},null,8,["show","task","server-error"])])]))}};export{F as default};
