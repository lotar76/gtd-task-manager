import{c as i,o as a,a as e,j as fe,k as P,h as le,l as J,g as W,b as T,m as xe,n as be,p as F,t as M,r as g,f as $,w as D,q as Je,s as re,x as se,d as G,v as ne,y as Xe,T as X,F as de,z as ie,A as pe,B as Y,C as ue,e as q,D as Ye,u as we,i as et,E as tt}from"./index-ZxFSRklB.js";import{u as ce}from"./workspace-B9rqsI10.js";import{r as he,a as $e,b as Ce,c as Me,d as je,u as ot,e as rt,T as st}from"./TaskModal-BA2QKnE1.js";import{r as at}from"./RectangleStackIcon-BoHSv9cP.js";import{r as _e}from"./CalendarDaysIcon-DuibOPdo.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as nt}from"./ProjectModal-CjesI5CC.js";function lt(y,j){return a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function oe(y,j){return a(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}const dt={class:"flex items-center space-x-3"},ve={__name:"NavLink",props:{to:{type:String,required:!0},icon:{type:String,default:"folder"},count:{type:Number,default:null}},setup(y){const j=y,k=fe(),f=ce(),m={inbox:je,lightning:Me,calendar:Ce,clock:$e,archive:he,folder:oe,"calendar-days":_e,target:oe,"rectangle-stack":at,cog:lt},c=P(()=>m[j.icon]||oe),v=P(()=>{var r;const w=(r=f.currentWorkspace)==null?void 0:r.id;return j.to.replace(":id",w||"1")}),p=P(()=>k.path===v.value);return(w,r)=>{const t=le("router-link");return a(),J(t,{to:v.value,class:F(["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors",p.value?"bg-primary-50 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"])},{default:W(()=>[e("div",dt,[(a(),J(xe(c.value),{class:"w-5 h-5"})),e("span",null,[be(w.$slots,"default")])]),y.count!==null&&y.count>0?(a(),i("span",{key:0,class:F(["px-2 py-0.5 text-xs font-semibold rounded-full",p.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"])},M(y.count),3)):T("",!0)]),_:3},8,["to","class"])}}},it={class:"flex items-center space-x-3"},te={__name:"DroppableNavLink",props:{to:{type:String,required:!0},icon:{type:String,default:"folder"},count:{type:Number,default:null},dropStatus:{type:String,default:null}},emits:["task-dropped"],setup(y,{emit:j}){const k=y,f=j,m=fe(),c=ce(),v=g(!1),p={inbox:je,lightning:Me,calendar:Ce,clock:$e,archive:he,folder:oe,"calendar-days":_e,target:oe},w=P(()=>p[k.icon]||oe),r=P(()=>{var _;const B=(_=c.currentWorkspace)==null?void 0:_.id;return k.to.replace(":id",B||"1")}),t=P(()=>m.path===r.value),C=B=>{B.preventDefault(),v.value=!0,B.dataTransfer.dropEffect="move"},z=()=>{v.value=!1},K=B=>{B.preventDefault(),v.value=!1;try{const _=JSON.parse(B.dataTransfer.getData("application/json"));k.dropStatus&&_&&f("task-dropped",{taskId:_.id,newStatus:k.dropStatus})}catch(_){console.error("Error handling drop:",_)}};return(B,_)=>{const R=le("router-link");return a(),i("div",{onDrop:K,onDragover:D(C,["prevent"]),onDragleave:z,class:F(["rounded-lg transition-all",v.value?"bg-primary-100 dark:bg-primary-900/40 ring-2 ring-primary-500":""])},[$(R,{to:r.value,class:F(["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors",t.value?"bg-primary-50 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"])},{default:W(()=>[e("div",it,[(a(),J(xe(w.value),{class:"w-5 h-5"})),e("span",null,[be(B.$slots,"default")])]),y.count!==null&&y.count>0?(a(),i("span",{key:0,class:F(["px-2 py-0.5 text-xs font-semibold rounded-full",t.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"])},M(y.count),3)):T("",!0)]),_:3},8,["to","class"])],34)}}},ut={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-20"},ct={class:"flex items-center justify-between px-4 lg:px-8 py-3"},pt={class:"flex-1 max-w-2xl"},vt={class:"relative"},gt={class:"flex items-center space-x-2 lg:space-x-4 ml-4"},kt={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2 z-50"},mt={class:"relative"},yt={key:0,class:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white"},ft={key:0,class:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2 max-h-96 overflow-y-auto"},xt={key:0,class:"px-4 py-6 text-center text-sm text-gray-500 dark:text-gray-400"},bt={key:1},wt={class:"text-sm text-gray-900 dark:text-gray-100"},ht={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},$t=["title"],Ct={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Mt={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},jt={class:"hidden lg:block relative"},_t={class:"w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},St={class:"hidden lg:block text-left"},Et={class:"text-sm font-medium text-gray-900 dark:text-white"},Tt={class:"text-xs text-gray-500 dark:text-gray-400"},Wt={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2"},Bt={__name:"Toolbar",props:{user:{type:Object,default:null}},emits:["quick-add","quick-add-task","quick-add-project","quick-add-goal","search","logout","profile","settings","toggle-sidebar"],setup(y,{emit:j}){const k=Je(),f=y,m=j,c=g(""),v=g(!1),p=g(!1),w=g(!1),r=g(0),t=g([]),C=g(null),z=P(()=>{var s;return(((s=f.user)==null?void 0:s.name)||"").split(" ").map(I=>I[0]).join("").toUpperCase().slice(0,2)}),K=()=>{w.value=!w.value},B=()=>{w.value=!1,m("quick-add-task")},_=()=>{w.value=!1,m("quick-add-project")},R=()=>{w.value=!1,m("quick-add-goal")},d=S=>{C.value&&!C.value.contains(S.target)&&(w.value=!1)},u=S=>{S.key==="Escape"&&(w.value=!1,v.value=!1,p.value=!1)};re(()=>{document.addEventListener("click",d),document.addEventListener("keydown",u)}),se(()=>{document.removeEventListener("click",d),document.removeEventListener("keydown",u)});const b=()=>{c.value.trim()&&m("search",c.value)},O=()=>{b()},U=()=>{p.value=!1,m("logout")},A=()=>{p.value=!1,m("profile")},H=()=>{p.value=!1,m("settings")},N={mounted(S,s){S.clickOutsideEvent=I=>{S===I.target||S.contains(I.target)||s.value()},document.addEventListener("click",S.clickOutsideEvent)},unmounted(S){document.removeEventListener("click",S.clickOutsideEvent)}};return(S,s)=>{var I,Z;return a(),i("header",ut,[e("div",ct,[e("button",{onClick:s[0]||(s[0]=V=>S.$emit("toggle-sidebar")),class:"lg:hidden p-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors mr-2"},[...s[5]||(s[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])]),e("div",pt,[e("div",vt,[s[6]||(s[6]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),G(e("input",{"onUpdate:modelValue":s[1]||(s[1]=V=>c.value=V),type:"text",placeholder:"Поиск задач...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm",onInput:b,onKeydown:Xe(O,["enter"])},null,544),[[ne,c.value]])])]),e("div",gt,[e("div",{class:"relative",ref_key:"quickAddMenuContainer",ref:C},[e("button",{onClick:D(K,["stop"]),class:"inline-flex items-center px-3 lg:px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-primary-500 transition-colors"},[...s[7]||(s[7]=[e("svg",{class:"w-5 h-5 lg:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",{class:"hidden lg:inline"},"Создать",-1)])]),$(X,{name:"dropdown"},{default:W(()=>[w.value?(a(),i("div",kt,[e("button",{onClick:B,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...s[8]||(s[8]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",null,"Задачу")],-1)])]),e("button",{onClick:_,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...s[9]||(s[9]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})]),e("span",null,"Проект")],-1)])]),e("button",{onClick:R,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...s[10]||(s[10]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})]),e("span",null,"Цель")],-1)])])])):T("",!0)]),_:1})],512),e("div",mt,[e("button",{onClick:s[2]||(s[2]=D(V=>v.value=!v.value,["stop"])),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors relative"},[s[11]||(s[11]=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),r.value>0?(a(),i("span",yt)):T("",!0)]),v.value?G((a(),i("div",ft,[s[12]||(s[12]=e("div",{class:"px-4 py-2 border-b border-gray-200 dark:border-gray-600"},[e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Уведомления")],-1)),t.value.length===0?(a(),i("div",xt," Нет новых уведомлений ")):(a(),i("div",bt,[(a(!0),i(de,null,ie(t.value,V=>(a(),i("button",{key:V.id,class:"w-full px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors text-left"},[e("p",wt,M(V.message),1),e("p",ht,M(V.time),1)]))),128))]))])),[[N,()=>v.value=!1]]):T("",!0)]),e("button",{onClick:s[3]||(s[3]=V=>pe(k).toggleTheme()),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:pe(k).isDark?"Светлая тема":"Тёмная тема"},[pe(k).isDark?(a(),i("svg",Ct,[...s[13]||(s[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(a(),i("svg",Mt,[...s[14]||(s[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))],8,$t),e("div",jt,[e("button",{onClick:s[4]||(s[4]=D(V=>p.value=!p.value,["stop"])),class:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[e("div",_t,M(z.value),1),e("div",St,[e("div",Et,M((I=y.user)==null?void 0:I.name),1),e("div",Tt,M((Z=y.user)==null?void 0:Z.email),1)]),s[15]||(s[15]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),p.value?G((a(),i("div",Wt,[e("button",{onClick:A,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...s[16]||(s[16]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),e("span",null,"Профиль")],-1)])]),e("button",{onClick:H,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...s[17]||(s[17]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]),e("span",null,"Настройки")],-1)])]),s[19]||(s[19]=e("div",{class:"border-t border-gray-200 dark:border-gray-600 my-2"},null,-1)),e("button",{onClick:U,class:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors"},[...s[18]||(s[18]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})]),e("span",null,"Выйти")],-1)])])])),[[N,()=>p.value=!1]]):T("",!0)])])])])}}},Lt=ae(Bt,[["__scopeId","data-v-24f2ea9a"]]),At={class:"flex min-h-screen items-center justify-center p-4"},Dt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},zt={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},Pt={class:"flex justify-end space-x-3 pt-4"},Ot=["disabled"],It={__name:"WorkspaceModal",props:{show:{type:Boolean,default:!1}},emits:["close","submit"],setup(y,{emit:j}){const k=y,f=j,m=r=>{r.key==="Escape"&&k.show&&f("close")};re(()=>document.addEventListener("keydown",m)),se(()=>document.removeEventListener("keydown",m));const c=g({name:"",description:""}),v=g(!1),p=g("");Y(()=>k.show,r=>{r||(c.value={name:"",description:""},v.value=!1,p.value="")});const w=()=>{p.value="",v.value=!0,f("submit",c.value)};return(r,t)=>(a(),J(ue,{to:"body"},[$(X,{name:"modal"},{default:W(()=>[y.show?(a(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[5]||(t[5]=D(C=>r.$emit("close"),["self"]))},[t[10]||(t[10]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",At,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:t[4]||(t[4]=D(()=>{},["stop"]))},[e("div",Dt,[t[7]||(t[7]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Новое рабочее пространство ",-1)),e("button",{onClick:t[0]||(t[0]=C=>r.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[6]||(t[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:D(w,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[8]||(t[8]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название * ",-1)),G(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=C=>c.value.name=C),type:"text",required:"",class:"input",placeholder:"Например: Команда разработки"},null,512),[[ne,c.value.name]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),G(e("textarea",{id:"description","onUpdate:modelValue":t[2]||(t[2]=C=>c.value.description=C),rows:"3",class:"input",placeholder:"Краткое описание рабочего пространства"},null,512),[[ne,c.value.description]])]),p.value?(a(),i("div",zt,M(p.value),1)):T("",!0),e("div",Pt,[e("button",{type:"button",onClick:t[3]||(t[3]=C=>r.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:v.value,class:"btn btn-primary"},M(v.value?"Создание...":"Создать"),9,Ot)])],32)])])])):T("",!0)]),_:1})]))}},Vt=ae(It,[["__scopeId","data-v-68182ad4"]]),qt={class:"flex min-h-screen items-center justify-center p-4"},Rt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Qt={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},Ut={class:"font-medium"},Ht={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},Nt={class:"flex justify-end space-x-3 pt-4"},Ft=["disabled"],Kt={__name:"AddMemberModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","submit"],setup(y,{emit:j}){const k=y,f=j,m=r=>{r.key==="Escape"&&k.show&&f("close")};re(()=>document.addEventListener("keydown",m)),se(()=>document.removeEventListener("keydown",m));const c=g({email:"",role:"member"}),v=g(!1),p=g("");Y(()=>k.show,r=>{r||(c.value={email:"",role:"member"},v.value=!1,p.value="")});const w=()=>{var r;p.value="",v.value=!0,f("submit",{...c.value,workspace_id:(r=k.workspace)==null?void 0:r.id})};return(r,t)=>(a(),J(ue,{to:"body"},[$(X,{name:"modal"},{default:W(()=>{var C;return[y.show?(a(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[5]||(t[5]=D(z=>r.$emit("close"),["self"]))},[t[12]||(t[12]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",qt,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:t[4]||(t[4]=D(()=>{},["stop"]))},[e("div",Rt,[t[7]||(t[7]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Добавить пользователя ",-1)),e("button",{onClick:t[0]||(t[0]=z=>r.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[6]||(t[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:D(w,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[e("p",Qt,[t[8]||(t[8]=q(" Workspace: ",-1)),e("span",Ut,M((C=y.workspace)==null?void 0:C.name),1)])]),e("div",null,[t[9]||(t[9]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Email пользователя * ",-1)),G(e("input",{id:"email","onUpdate:modelValue":t[1]||(t[1]=z=>c.value.email=z),type:"email",required:"",class:"input",placeholder:"user@example.com"},null,512),[[ne,c.value.email]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Роль ",-1)),G(e("select",{id:"role","onUpdate:modelValue":t[2]||(t[2]=z=>c.value.role=z),class:"input"},[...t[10]||(t[10]=[e("option",{value:"viewer"},"Просмотр",-1),e("option",{value:"member"},"Участник",-1),e("option",{value:"admin"},"Администратор",-1)])],512),[[Ye,c.value.role]])]),p.value?(a(),i("div",Ht,M(p.value),1)):T("",!0),e("div",Nt,[e("button",{type:"button",onClick:t[3]||(t[3]=z=>r.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:v.value,class:"btn btn-primary"},M(v.value?"Добавление...":"Добавить"),9,Ft)])],32)])])])):T("",!0)]}),_:1})]))}},Gt=ae(Kt,[["__scopeId","data-v-72cbffa0"]]),Zt={class:"flex min-h-screen items-center justify-center p-4"},Jt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Xt={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},Yt={class:"flex justify-end space-x-3 pt-4"},eo=["disabled"],to={__name:"RenameWorkspaceModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","submit"],setup(y,{emit:j}){const k=y,f=j,m=r=>{r.key==="Escape"&&k.show&&f("close")};re(()=>document.addEventListener("keydown",m)),se(()=>document.removeEventListener("keydown",m));const c=g({name:""}),v=g(!1),p=g("");Y(()=>k.workspace,r=>{r&&(c.value.name=r.name)},{immediate:!0}),Y(()=>k.show,r=>{r||(v.value=!1,p.value="")});const w=()=>{p.value="",v.value=!0,f("submit",c.value.name)};return(r,t)=>(a(),J(ue,{to:"body"},[$(X,{name:"modal"},{default:W(()=>[y.show?(a(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[4]||(t[4]=D(C=>r.$emit("close"),["self"]))},[t[8]||(t[8]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",Zt,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:t[3]||(t[3]=D(()=>{},["stop"]))},[e("div",Jt,[t[6]||(t[6]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Переименовать workspace ",-1)),e("button",{onClick:t[0]||(t[0]=C=>r.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[5]||(t[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:D(w,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[7]||(t[7]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Новое название * ",-1)),G(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=C=>c.value.name=C),type:"text",required:"",class:"input",placeholder:"Название workspace"},null,512),[[ne,c.value.name]])]),p.value?(a(),i("div",Xt,M(p.value),1)):T("",!0),e("div",Yt,[e("button",{type:"button",onClick:t[2]||(t[2]=C=>r.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:v.value,class:"btn btn-primary"},M(v.value?"Сохранение...":"Сохранить"),9,eo)])],32)])])])):T("",!0)]),_:1})]))}},oo=ae(to,[["__scopeId","data-v-9efc4d3d"]]),ro={class:"flex min-h-screen items-center justify-center p-4"},so={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},ao={class:"p-6"},no={key:0,class:"text-center py-8"},lo={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},io={key:2,class:"space-y-3"},uo={class:"flex items-center space-x-3"},co={class:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},po={class:"font-medium text-gray-900 dark:text-white"},vo={class:"text-sm text-gray-500 dark:text-gray-400"},go={class:"flex items-center space-x-3"},ko=["onClick","disabled"],mo={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},yo={key:1,class:"inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-red-600"},fo={key:0,class:"px-6 pb-4"},xo={class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},bo={class:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700"},wo={__name:"MembersModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","member-removed"],setup(y,{emit:j}){const k=y,f=j,m=d=>{d.key==="Escape"&&k.show&&f("close")};re(()=>document.addEventListener("keydown",m)),se(()=>document.removeEventListener("keydown",m));const c=ce(),v=we(),p=g([]),w=g(!1),r=g(""),t=g(null),C=d=>d?d.split(" ").map(u=>u[0]).join("").toUpperCase().substring(0,2):"?",z=d=>({owner:"Владелец",admin:"Администратор",member:"Участник",viewer:"Наблюдатель"})[d]||d,K=d=>({owner:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",admin:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",member:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",viewer:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"})[d]||"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400",B=d=>{var U,A,H,N,S,s,I;const u=(U=v.user)==null?void 0:U.id,b=((A=k.workspace)==null?void 0:A.owner_id)===u,O=((s=(S=(N=(H=k.workspace)==null?void 0:H.members)==null?void 0:N.find(Z=>Z.id===u))==null?void 0:S.pivot)==null?void 0:s.role)==="admin";return((I=k.workspace)==null?void 0:I.owner_id)===d.id||d.id===u?!1:b||O},_=async()=>{var d;if((d=k.workspace)!=null&&d.id){w.value=!0,r.value="";try{const u=await c.fetchMembers(k.workspace.id);p.value=u.members||u||[]}catch(u){console.error("Error loading members:",u),r.value="Ошибка при загрузке участников"}finally{w.value=!1}}},R=async d=>{var u,b;if(confirm(`Вы уверены, что хотите удалить ${d.name} из workspace?`)){t.value=d.id,r.value="";try{await c.removeMember(k.workspace.id,d.id),await _(),f("member-removed",d)}catch(O){console.error("Error removing member:",O),r.value=((b=(u=O.response)==null?void 0:u.data)==null?void 0:b.message)||"Ошибка при удалении участника"}finally{t.value=null}}};return Y(()=>k.show,d=>{d?_():(p.value=[],r.value="",t.value=null)}),Y(()=>{var d;return(d=k.workspace)==null?void 0:d.id},()=>{k.show&&_()}),(d,u)=>(a(),J(ue,{to:"body"},[$(X,{name:"modal"},{default:W(()=>[y.show?(a(),i("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:u[3]||(u[3]=D(b=>d.$emit("close"),["self"]))},[u[8]||(u[8]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",ro,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-auto",onClick:u[2]||(u[2]=D(()=>{},["stop"]))},[e("div",so,[u[5]||(u[5]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Участники workspace ",-1)),e("button",{onClick:u[0]||(u[0]=b=>d.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...u[4]||(u[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",ao,[w.value?(a(),i("div",no,[...u[6]||(u[6]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):p.value.length===0?(a(),i("div",lo," Нет участников ")):(a(),i("div",io,[(a(!0),i(de,null,ie(p.value,b=>{var O,U,A,H;return a(),i("div",{key:b.id,class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[e("div",uo,[e("div",co,M(C(b.name)),1),e("div",null,[e("div",po,M(b.name),1),e("div",vo,M(b.email),1)])]),e("div",go,[e("span",{class:F(["px-3 py-1 text-xs font-medium rounded-full",K(((O=b.pivot)==null?void 0:O.role)||(((U=y.workspace)==null?void 0:U.owner_id)===b.id?"owner":"member"))])},M(z(((A=b.pivot)==null?void 0:A.role)||(((H=y.workspace)==null?void 0:H.owner_id)===b.id?"owner":"member"))),3),B(b)?(a(),i("button",{key:0,onClick:N=>R(b),class:"text-red-600 hover:text-red-700 p-2 rounded transition-colors",disabled:t.value===b.id,title:"Удалить из workspace"},[t.value!==b.id?(a(),i("svg",mo,[...u[7]||(u[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1)])])):(a(),i("div",yo))],8,ko)):T("",!0)])])}),128))]))]),r.value?(a(),i("div",fo,[e("div",xo,M(r.value),1)])):T("",!0),e("div",bo,[e("button",{onClick:u[1]||(u[1]=b=>d.$emit("close")),class:"btn btn-secondary"}," Закрыть ")])])])])):T("",!0)]),_:1})]))}},ho=ae(wo,[["__scopeId","data-v-e1a886d2"]]),$o={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},Co={class:"flex h-screen"},Mo={class:"flex flex-col h-full"},jo={class:"p-4 border-b border-gray-200 dark:border-gray-700"},_o={class:"flex items-center justify-between mb-3"},So={class:"space-y-1"},Eo={class:"flex-1 flex items-center px-3 py-2 text-sm cursor-pointer"},To=["checked","onChange"],Wo=["onClick"],Bo={key:0,class:"absolute right-0 mt-1 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-1 z-50"},Lo=["onClick"],Ao={class:"flex-1 overflow-y-auto p-4"},Do={class:"space-y-1"},zo={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 space-y-1"},Po={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},Oo={class:"space-y-1 max-h-64 overflow-y-auto"},Io={class:"text-sm text-gray-700 dark:text-gray-300 truncate"},Vo={key:0,class:"text-xs text-gray-500"},qo=["onClick"],Ro={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},Qo={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},Uo={class:"space-y-1"},Ho={class:"flex-1 flex flex-col overflow-hidden"},No={class:"flex-1 overflow-auto"},Fo={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4"},Ko={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-sm w-full p-6"},Go={class:"text-sm text-gray-500 dark:text-gray-400 mb-6"},Zo={__name:"MainLayout",setup(y){const j=et(),k=we(),f=ce(),m=ot(),c=rt(),v=g(!1);g(!1);const p=g(!1),w=g(!1),r=g(""),t=g(null),C=g(!1),z=g(!1),K=g(!1),B=g(!1),_=g(null),R=g(""),d=g(null),u=g(!1),b=g(null),O=P(()=>k.user),U=P(()=>f.workspaces),A=P(()=>m.counts),H=P(()=>f.currentWorkspace),N=P(()=>c.activeProjects),S=P(()=>f.selectedWorkspaces.map(n=>n.id)),s=P(()=>m.filteredTasks.length),I=P(()=>{if(S.value.length===0)return 0;const n=A.value.scheduled||0,o=A.value.today||0,x=A.value.tomorrow||0;return n+o+x});P(()=>{var o;return(((o=O.value)==null?void 0:o.name)||"").split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2)});const Z=n=>{var Q;f.toggleSelectedWorkspace(n);const x=j.currentRoute.value.path.split("/"),h=x[x.length-1],E=["inbox","next-actions","today","waiting","someday","calendar","projects","goals"].includes(h)?h:"inbox",L=((Q=f.currentWorkspace)==null?void 0:Q.id)||n.id;j.push(`/workspaces/${L}/${E}`)},V=async n=>{try{const o=await f.createWorkspace(n);p.value=!1,await Z(o)}catch(o){console.error("Ошибка создания workspace:",o)}},Se=async()=>{await k.logout(),j.push("/login")},Ee=()=>{w.value=!0},ge=()=>{_.value=null,B.value=!0},Te=async n=>{var o,x;R.value="";try{_.value?await c.updateProject(_.value.id,n):await c.createProject(n),B.value=!1,_.value=null,await c.fetchProjects()}catch(h){console.error("Error saving project:",h),R.value=((x=(o=h.response)==null?void 0:o.data)==null?void 0:x.message)||h.message||"Ошибка при сохранении проекта"}},We=()=>{B.value=!1,_.value=null,R.value=""},Be=async n=>{var o,x;if(confirm(`Архивировать проект "${n.name}"?`))try{await c.archiveProject(n.id),await c.fetchProjects()}catch(h){console.error("Error archiving project:",h),alert("Ошибка при архивировании проекта: "+(((x=(o=h.response)==null?void 0:o.data)==null?void 0:x.message)||h.message))}},Le=()=>{console.log("Quick add goal")},Ae=async n=>{var o,x;r.value="";try{await m.createTask(n),w.value=!1}catch(h){console.error("Error creating task:",h),r.value=((x=(o=h.response)==null?void 0:o.data)==null?void 0:x.message)||h.message||"Ошибка при создании задачи"}},De=()=>{w.value=!1,r.value=""},ee=async({taskId:n,newStatus:o})=>{var x,h;try{const l={status:o};if(o==="today")l.due_date=new Date().toISOString().split("T")[0];else if(o==="tomorrow"){const E=new Date;E.setDate(E.getDate()+1),l.due_date=E.toISOString().split("T")[0]}await m.updateTask(n,l)}catch(l){console.error("Error updating task status:",l),alert(((h=(x=l.response)==null?void 0:x.data)==null?void 0:h.message)||"Ошибка при обновлении задачи")}},ze=n=>{console.log("Search:",n)},Pe=()=>{j.push("/settings")},Oe=()=>{j.push("/settings")},Ie=n=>{var h,l,E;const o=(h=O.value)==null?void 0:h.id;if(!o)return!1;if(n.owner_id===o)return!0;const x=(l=n.members)==null?void 0:l.find(L=>L.id===o);return((E=x==null?void 0:x.pivot)==null?void 0:E.role)==="admin"},Ve=n=>{t.value=t.value===n?null:n},qe=n=>m.allTasks.filter(o=>o.workspace_id===n).length,Re=n=>{b.value=n,u.value=!0,t.value=null},Qe=async()=>{if(b.value){try{await f.deleteWorkspace(b.value.id)}catch(n){console.error("Error deleting workspace:",n)}u.value=!1,b.value=null}},ke=()=>{u.value=!1,b.value=null},Ue=()=>{C.value=!1,d.value=null},He=()=>{K.value=!1,d.value=null},Ne=async()=>{await f.fetchWorkspaces()},Fe=()=>{z.value=!1,d.value=null},Ke=async n=>{var o,x,h,l,E;try{console.log("Sending member data:",n),await f.addMember(n.workspace_id,{email:n.email,role:n.role}),C.value=!1,d.value=null,alert("Пользователь успешно добавлен в workspace")}catch(L){console.error("Error adding member:",L),console.error("Error response:",(o=L.response)==null?void 0:o.data);let Q="Ошибка при добавлении пользователя";(h=(x=L.response)==null?void 0:x.data)!=null&&h.errors?Q=Object.values(L.response.data.errors).flat().join(", "):(E=(l=L.response)==null?void 0:l.data)!=null&&E.message&&(Q=L.response.data.message),alert(Q)}},Ge=async n=>{var o,x,h,l,E;try{console.log("Renaming workspace:",d.value.id,"to:",n),await f.updateWorkspace(d.value.id,{name:n}),await f.fetchWorkspaces(),z.value=!1,d.value=null,alert("Workspace успешно переименован")}catch(L){console.error("Error renaming workspace:",L),console.error("Error response:",(o=L.response)==null?void 0:o.data);let Q="Ошибка при переименовании";(h=(x=L.response)==null?void 0:x.data)!=null&&h.errors?Q=Object.values(L.response.data.errors).flat().join(", "):(E=(l=L.response)==null?void 0:l.data)!=null&&E.message&&(Q=L.response.data.message),alert(Q)}},me=n=>{n.key==="Escape"&&(t.value=null)};re(async()=>{await f.fetchWorkspaces(),await m.fetchAllTasks(),await c.fetchProjects(),m.startSync(),document.addEventListener("click",ye),document.addEventListener("keydown",me)}),Y(()=>{var n;return(n=f.currentWorkspace)==null?void 0:n.id},n=>{n&&c.fetchProjects()}),se(()=>{m.stopSync(),document.removeEventListener("click",ye),document.removeEventListener("keydown",me)});const ye=()=>{t.value=null};return(n,o)=>{const x=le("router-link"),h=le("router-view");return a(),i("div",$o,[e("div",Co,[e("aside",{class:F(["fixed lg:static inset-y-0 left-0 z-40 w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 ease-in-out",v.value?"translate-x-0":"-translate-x-full lg:translate-x-0"])},[e("div",Mo,[o[23]||(o[23]=e("div",{class:"hidden lg:flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},[e("h1",{class:"text-xl font-bold text-gray-900 dark:text-white"},"GTD TODO")],-1)),e("div",jo,[e("div",_o,[o[7]||(o[7]=e("h3",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Рабочие пространства ",-1)),e("button",{onClick:o[0]||(o[0]=l=>p.value=!0),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:"Создать workspace"},[...o[6]||(o[6]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),e("div",So,[(a(!0),i(de,null,ie(U.value,l=>(a(),i("div",{key:l.id,class:F(["flex items-center rounded-lg transition-colors",S.value.includes(l.id)?"bg-primary-50 dark:bg-primary-900/30":"hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("label",Eo,[e("input",{type:"checkbox",checked:S.value.includes(l.id),onChange:E=>Z(l),class:"mr-3 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 dark:border-gray-600 rounded dark:bg-gray-700"},null,40,To),e("span",{class:F(["truncate",S.value.includes(l.id)?"text-primary-700 dark:text-primary-400 font-medium":"text-gray-700 dark:text-gray-300"])},M(l.name),3)]),e("div",{class:"relative",onClick:o[2]||(o[2]=D(()=>{},["stop"]))},[e("button",{onClick:E=>Ve(l.id),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded transition-colors"},[...o[8]||(o[8]=[e("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})],-1)])],8,Wo),$(X,{name:"dropdown"},{default:W(()=>[t.value===l.id?(a(),i("div",Bo,[$(x,{to:`/workspaces/${l.id}/settings`,onClick:o[1]||(o[1]=E=>t.value=null),class:"block w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},{default:W(()=>[...o[9]||(o[9]=[q(" Настройки ",-1)])]),_:1},8,["to"]),Ie(l)&&qe(l.id)===0?(a(),i("button",{key:0,onClick:E=>Re(l),class:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors"}," Удалить пространство ",8,Lo)):T("",!0)])):T("",!0)]),_:2},1024)])],2))),128))])]),e("nav",Ao,[e("div",Do,[$(te,{to:"/workspaces/:id/inbox",icon:"inbox",count:A.value.inbox,"drop-status":"inbox",onTaskDropped:ee},{default:W(()=>[...o[10]||(o[10]=[q(" Входящие ",-1)])]),_:1},8,["count"])]),e("div",zo,[$(te,{to:"/workspaces/:id/today",icon:"calendar",count:A.value.today,"drop-status":"today",onTaskDropped:ee},{default:W(()=>[...o[11]||(o[11]=[q(" Сегодня ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/next-actions",icon:"lightning",count:A.value.next_actions,"drop-status":"next_action",onTaskDropped:ee},{default:W(()=>[...o[12]||(o[12]=[q(" Следующие ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/tomorrow",icon:"calendar-days",count:A.value.tomorrow,"drop-status":"tomorrow",onTaskDropped:ee},{default:W(()=>[...o[13]||(o[13]=[q(" Завтра ",-1)])]),_:1},8,["count"]),$(ve,{to:"/workspaces/:id/calendar",icon:"calendar-days",count:I.value},{default:W(()=>[...o[14]||(o[14]=[q(" Календарь ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/someday",icon:"archive",count:A.value.someday,"drop-status":"someday",onTaskDropped:ee},{default:W(()=>[...o[15]||(o[15]=[q(" Когда-нибудь ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/waiting",icon:"clock",count:A.value.waiting,"drop-status":"waiting",onTaskDropped:ee},{default:W(()=>[...o[16]||(o[16]=[q(" Ожидание ",-1)])]),_:1},8,["count"]),$(ve,{to:"/workspaces/:id/all",icon:"rectangle-stack",count:s.value},{default:W(()=>[...o[17]||(o[17]=[q(" Все задачи ",-1)])]),_:1},8,["count"])]),e("div",Po,[e("div",{class:"flex items-center justify-between px-3 mb-3"},[o[19]||(o[19]=e("h3",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Проекты ",-1)),e("button",{onClick:ge,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Создать проект"},[...o[18]||(o[18]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),e("div",Oo,[(a(!0),i(de,null,ie(N.value,l=>{var E;return a(),i("div",{key:l.id,class:"flex items-center justify-between group px-3 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[$(x,{to:`/workspaces/${(E=H.value)==null?void 0:E.id}/projects/${l.id}`,class:"flex items-center space-x-2 flex-1 min-w-0"},{default:W(()=>[e("div",{class:"w-3 h-3 rounded-full flex-shrink-0",style:tt({backgroundColor:l.color||"#3B82F6"})},null,4),e("span",Io,M(l.name),1),l.tasks_count>0?(a(),i("span",Vo," ("+M(l.tasks_count)+") ",1)):T("",!0)]),_:2},1032,["to"]),e("button",{onClick:D(L=>Be(l),["stop"]),class:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-1 transition-opacity",title:"Архивировать"},[...o[20]||(o[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)])],8,qo)])}),128)),N.value.length===0?(a(),i("div",Ro," Нет проектов ")):T("",!0)])]),e("div",Qo,[o[22]||(o[22]=e("h3",{class:"px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3"}," Организация ",-1)),e("div",Uo,[$(ve,{to:"/workspaces/:id/goals",icon:"target"},{default:W(()=>[...o[21]||(o[21]=[q(" Цели ",-1)])]),_:1})])])])])],2),v.value?(a(),i("div",{key:0,onClick:o[3]||(o[3]=l=>v.value=!1),class:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden"})):T("",!0),e("main",Ho,[$(Lt,{user:O.value,onQuickAddTask:Ee,onQuickAddProject:ge,onQuickAddGoal:Le,onSearch:ze,onLogout:Se,onProfile:Pe,onSettings:Oe,onToggleSidebar:o[4]||(o[4]=l=>v.value=!v.value)},null,8,["user"]),e("div",No,[$(h)])])]),$(Vt,{show:p.value,onClose:o[5]||(o[5]=l=>p.value=!1),onSubmit:V},null,8,["show"]),$(st,{show:w.value,"server-error":r.value,onClose:De,onSubmit:Ae},null,8,["show","server-error"]),$(Gt,{show:C.value,workspace:d.value,onClose:Ue,onSubmit:Ke},null,8,["show","workspace"]),$(oo,{show:z.value,workspace:d.value,onClose:Fe,onSubmit:Ge},null,8,["show","workspace"]),$(ho,{show:K.value,workspace:d.value,onClose:He,onMemberRemoved:Ne},null,8,["show","workspace"]),$(nt,{show:B.value,project:_.value,"server-error":R.value,onClose:We,onSubmit:Te},null,8,["show","project","server-error"]),$(X,{name:"modal"},{default:W(()=>{var l;return[u.value?(a(),i("div",Fo,[e("div",{class:"fixed inset-0 bg-black/50",onClick:ke}),e("div",Ko,[o[24]||(o[24]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"Удалить пространство?",-1)),e("p",Go," Пространство «"+M((l=b.value)==null?void 0:l.name)+"» будет удалено навсегда. Это действие нельзя отменить. ",1),e("div",{class:"flex justify-end space-x-3"},[e("button",{onClick:ke,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," Отмена "),e("button",{onClick:Qe,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors"}," Удалить ")])])])):T("",!0)]}),_:1})])}}},sr=ae(Zo,[["__scopeId","data-v-9d78b1b7"]]);export{sr as default};
