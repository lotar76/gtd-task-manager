import{c as n,o as r,a as e,j as he,k as O,h as ce,l as Z,g as S,b as _,m as we,n as $e,p as F,t as M,r as p,f as $,w as L,q as Xe,s as se,x as ae,y as oe,d as G,v as de,z as Ye,T as J,F as le,A as ie,B as X,C as ue,e as H,D as et,u as Ce,i as tt,E as be}from"./index-BolgmRw1.js";import{u as pe}from"./workspace-CsN_rP9h.js";import{r as Me,a as je,b as _e,c as Se,d as Te,u as ot,e as rt,T as st}from"./TaskModal-BrHxoNIa.js";import{r as at}from"./RectangleStackIcon-BWQmp6Kv.js";import{r as Ee}from"./CalendarDaysIcon-y8GlNuDq.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{P as nt}from"./ProjectModal-q6BAh0UO.js";function lt(f,j){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function re(f,j){return r(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 12.75V12A2.25 2.25 0 0 1 4.5 9.75h15A2.25 2.25 0 0 1 21.75 12v.75m-8.69-6.44-2.12-2.12a1.5 1.5 0 0 0-1.061-.44H4.5A2.25 2.25 0 0 0 2.25 6v12a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9a2.25 2.25 0 0 0-2.25-2.25h-5.379a1.5 1.5 0 0 1-1.06-.44Z"})])}const it={class:"flex items-center space-x-3"},ve={__name:"NavLink",props:{to:{type:String,required:!0},icon:{type:String,default:"folder"},count:{type:Number,default:null}},setup(f){const j=f,v=he(),x=pe(),b={inbox:Te,lightning:Se,calendar:_e,clock:je,archive:Me,folder:re,"calendar-days":Ee,target:re,"rectangle-stack":at,cog:lt},c=O(()=>b[j.icon]||re),m=O(()=>{var s;const y=(s=x.currentWorkspace)==null?void 0:s.id;return j.to.replace(":id",y||"1")}),g=O(()=>v.path===m.value);return(y,s)=>{const t=ce("router-link");return r(),Z(t,{to:m.value,class:F(["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors",g.value?"bg-primary-50 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"])},{default:S(()=>[e("div",it,[(r(),Z(we(c.value),{class:"w-5 h-5"})),e("span",null,[$e(y.$slots,"default")])]),f.count!==null&&f.count>0?(r(),n("span",{key:0,class:F(["px-2 py-0.5 text-xs font-semibold rounded-full",g.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"])},M(f.count),3)):_("",!0)]),_:3},8,["to","class"])}}},dt={class:"flex items-center space-x-3"},te={__name:"DroppableNavLink",props:{to:{type:String,required:!0},icon:{type:String,default:"folder"},count:{type:Number,default:null},dropStatus:{type:String,default:null}},emits:["task-dropped"],setup(f,{emit:j}){const v=f,x=j,b=he(),c=pe(),m=p(!1),g={inbox:Te,lightning:Se,calendar:_e,clock:je,archive:Me,folder:re,"calendar-days":Ee,target:re},y=O(()=>g[v.icon]||re),s=O(()=>{var B;const D=(B=c.currentWorkspace)==null?void 0:B.id;return v.to.replace(":id",D||"1")}),t=O(()=>b.path===s.value),h=D=>{D.preventDefault(),m.value=!0,D.dataTransfer.dropEffect="move"},P=()=>{m.value=!1},K=D=>{D.preventDefault(),m.value=!1;try{const B=JSON.parse(D.dataTransfer.getData("application/json"));v.dropStatus&&B&&x("task-dropped",{taskId:B.id,newStatus:v.dropStatus})}catch(B){console.error("Error handling drop:",B)}};return(D,B)=>{const R=ce("router-link");return r(),n("div",{onDrop:K,onDragover:L(h,["prevent"]),onDragleave:P,class:F(["rounded-lg transition-all",m.value?"bg-primary-100 dark:bg-primary-900/40 ring-2 ring-primary-500":""])},[$(R,{to:s.value,class:F(["flex items-center justify-between px-3 py-2 rounded-lg text-sm font-medium transition-colors",t.value?"bg-primary-50 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"])},{default:S(()=>[e("div",dt,[(r(),Z(we(y.value),{class:"w-5 h-5"})),e("span",null,[$e(D.$slots,"default")])]),f.count!==null&&f.count>0?(r(),n("span",{key:0,class:F(["px-2 py-0.5 text-xs font-semibold rounded-full",t.value?"bg-primary-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300"])},M(f.count),3)):_("",!0)]),_:3},8,["to","class"])],34)}}},ge="/assets/logo-D4KoLT79.jpg",ct={class:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-20"},ut={class:"flex items-center justify-between px-4 lg:px-8 py-3"},pt={class:"lg:hidden flex items-center mr-3"},vt=["src"],gt={class:"flex-1 max-w-2xl"},kt={class:"relative"},mt={class:"flex items-center space-x-2 lg:space-x-4 ml-4"},yt={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2 z-50"},ft={class:"relative"},xt={key:0,class:"absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white"},bt={key:0,class:"absolute right-0 mt-2 w-80 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2 max-h-96 overflow-y-auto"},ht={key:0,class:"px-4 py-6 text-center text-sm text-gray-500 dark:text-gray-400"},wt={key:1},$t={class:"text-sm text-gray-900 dark:text-gray-100"},Ct={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},Mt=["title"],jt={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_t={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},St={class:"hidden lg:block relative"},Tt={class:"w-8 h-8 bg-primary-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},Et={class:"hidden lg:block text-left"},Dt={class:"text-sm font-medium text-gray-900 dark:text-white"},Bt={class:"text-xs text-gray-500 dark:text-gray-400"},Lt={key:0,class:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 py-2"},Wt={__name:"Toolbar",props:{user:{type:Object,default:null}},emits:["quick-add","quick-add-task","quick-add-project","quick-add-goal","search","logout","profile","settings","toggle-sidebar"],setup(f,{emit:j}){const v=Xe(),x=f,b=j,c=p(""),m=p(!1),g=p(!1),y=p(!1),s=p(0),t=p([]),h=p(null),P=O(()=>{var a;return(((a=x.user)==null?void 0:a.name)||"").split(" ").map(z=>z[0]).join("").toUpperCase().slice(0,2)}),K=()=>{y.value=!y.value},D=()=>{y.value=!1,b("quick-add-task")},B=()=>{y.value=!1,b("quick-add-project")},R=()=>{y.value=!1,b("quick-add-goal")},u=T=>{h.value&&!h.value.contains(T.target)&&(y.value=!1)},l=T=>{T.key==="Escape"&&(y.value=!1,m.value=!1,g.value=!1)};se(()=>{document.addEventListener("click",u),document.addEventListener("keydown",l)}),ae(()=>{document.removeEventListener("click",u),document.removeEventListener("keydown",l)});const k=()=>{c.value.trim()&&b("search",c.value)},I=()=>{k()},V=()=>{g.value=!1,b("logout")},Q=()=>{g.value=!1,b("profile")},N=()=>{g.value=!1,b("settings")},W={mounted(T,a){T.clickOutsideEvent=z=>{T===z.target||T.contains(z.target)||a.value()},document.addEventListener("click",T.clickOutsideEvent)},unmounted(T){document.removeEventListener("click",T.clickOutsideEvent)}};return(T,a)=>{var z,Y;return r(),n("header",ct,[e("div",ut,[e("button",{onClick:a[0]||(a[0]=q=>T.$emit("toggle-sidebar")),class:"lg:hidden p-2 text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors mr-2"},[...a[5]||(a[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])]),e("div",pt,[e("img",{src:oe(ge),alt:"GTD TODO",class:"h-8 w-8 object-contain"},null,8,vt)]),e("div",gt,[e("div",kt,[a[6]||(a[6]=e("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[e("svg",{class:"h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1)),G(e("input",{"onUpdate:modelValue":a[1]||(a[1]=q=>c.value=q),type:"text",placeholder:"Поиск задач...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg leading-5 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:placeholder-gray-400 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm",onInput:k,onKeydown:Ye(I,["enter"])},null,544),[[de,c.value]])])]),e("div",mt,[e("div",{class:"relative",ref_key:"quickAddMenuContainer",ref:h},[e("button",{onClick:L(K,["stop"]),class:"inline-flex items-center px-3 lg:px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 focus:ring-primary-500 transition-colors"},[...a[7]||(a[7]=[e("svg",{class:"w-5 h-5 lg:mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",{class:"hidden lg:inline"},"Создать",-1)])]),$(J,{name:"dropdown"},{default:S(()=>[y.value?(r(),n("div",yt,[e("button",{onClick:D,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[8]||(a[8]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),e("span",null,"Задачу")],-1)])]),e("button",{onClick:B,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[9]||(a[9]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})]),e("span",null,"Проект")],-1)])]),e("button",{onClick:R,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[10]||(a[10]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})]),e("span",null,"Цель")],-1)])])])):_("",!0)]),_:1})],512),e("div",ft,[e("button",{onClick:a[2]||(a[2]=L(q=>m.value=!m.value,["stop"])),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors relative"},[a[11]||(a[11]=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),s.value>0?(r(),n("span",xt)):_("",!0)]),m.value?G((r(),n("div",bt,[a[12]||(a[12]=e("div",{class:"px-4 py-2 border-b border-gray-200 dark:border-gray-600"},[e("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white"},"Уведомления")],-1)),t.value.length===0?(r(),n("div",ht," Нет новых уведомлений ")):(r(),n("div",wt,[(r(!0),n(le,null,ie(t.value,q=>(r(),n("button",{key:q.id,class:"w-full px-4 py-3 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors text-left"},[e("p",$t,M(q.message),1),e("p",Ct,M(q.time),1)]))),128))]))])),[[W,()=>m.value=!1]]):_("",!0)]),e("button",{onClick:a[3]||(a[3]=q=>oe(v).toggleTheme()),class:"p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:oe(v).isDark?"Светлая тема":"Тёмная тема"},[oe(v).isDark?(r(),n("svg",jt,[...a[13]||(a[13]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(r(),n("svg",_t,[...a[14]||(a[14]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))],8,Mt),e("div",St,[e("button",{onClick:a[4]||(a[4]=L(q=>g.value=!g.value,["stop"])),class:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[e("div",Tt,M(P.value),1),e("div",Et,[e("div",Dt,M((z=f.user)==null?void 0:z.name),1),e("div",Bt,M((Y=f.user)==null?void 0:Y.email),1)]),a[15]||(a[15]=e("svg",{class:"w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))]),g.value?G((r(),n("div",Lt,[e("button",{onClick:Q,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[16]||(a[16]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),e("span",null,"Профиль")],-1)])]),e("button",{onClick:N,class:"w-full px-4 py-2 text-left text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[...a[17]||(a[17]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]),e("span",null,"Настройки")],-1)])]),a[19]||(a[19]=e("div",{class:"border-t border-gray-200 dark:border-gray-600 my-2"},null,-1)),e("button",{onClick:V,class:"w-full px-4 py-2 text-left text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors"},[...a[18]||(a[18]=[e("div",{class:"flex items-center space-x-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})]),e("span",null,"Выйти")],-1)])])])),[[W,()=>g.value=!1]]):_("",!0)])])])])}}},At=ne(Wt,[["__scopeId","data-v-139125f4"]]),Ot={class:"flex min-h-screen items-center justify-center p-4"},Pt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},zt={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},It={class:"flex justify-end space-x-3 pt-4"},Vt=["disabled"],qt={__name:"WorkspaceModal",props:{show:{type:Boolean,default:!1}},emits:["close","submit"],setup(f,{emit:j}){const v=f,x=j,b=s=>{s.key==="Escape"&&v.show&&x("close")};se(()=>document.addEventListener("keydown",b)),ae(()=>document.removeEventListener("keydown",b));const c=p({name:"",description:""}),m=p(!1),g=p("");X(()=>v.show,s=>{s||(c.value={name:"",description:""},m.value=!1,g.value="")});const y=()=>{g.value="",m.value=!0,x("submit",c.value)};return(s,t)=>(r(),Z(ue,{to:"body"},[$(J,{name:"modal"},{default:S(()=>[f.show?(r(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[5]||(t[5]=L(h=>s.$emit("close"),["self"]))},[t[10]||(t[10]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",Ot,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:t[4]||(t[4]=L(()=>{},["stop"]))},[e("div",Pt,[t[7]||(t[7]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Новое рабочее пространство ",-1)),e("button",{onClick:t[0]||(t[0]=h=>s.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[6]||(t[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:L(y,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[8]||(t[8]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название * ",-1)),G(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=h=>c.value.name=h),type:"text",required:"",class:"input",placeholder:"Например: Команда разработки"},null,512),[[de,c.value.name]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),G(e("textarea",{id:"description","onUpdate:modelValue":t[2]||(t[2]=h=>c.value.description=h),rows:"3",class:"input",placeholder:"Краткое описание рабочего пространства"},null,512),[[de,c.value.description]])]),g.value?(r(),n("div",zt,M(g.value),1)):_("",!0),e("div",It,[e("button",{type:"button",onClick:t[3]||(t[3]=h=>s.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:m.value,class:"btn btn-primary"},M(m.value?"Создание...":"Создать"),9,Vt)])],32)])])])):_("",!0)]),_:1})]))}},Rt=ne(qt,[["__scopeId","data-v-f11c7066"]]),Qt={class:"flex min-h-screen items-center justify-center p-4"},Ut={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Ht={class:"text-sm text-gray-600 dark:text-gray-400 mb-4"},Kt={class:"font-medium"},Nt={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},Ft={class:"flex justify-end space-x-3 pt-4"},Gt=["disabled"],Zt={__name:"AddMemberModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","submit"],setup(f,{emit:j}){const v=f,x=j,b=s=>{s.key==="Escape"&&v.show&&x("close")};se(()=>document.addEventListener("keydown",b)),ae(()=>document.removeEventListener("keydown",b));const c=p({email:"",role:"member"}),m=p(!1),g=p("");X(()=>v.show,s=>{s||(c.value={email:"",role:"member"},m.value=!1,g.value="")});const y=()=>{var s;g.value="",m.value=!0,x("submit",{...c.value,workspace_id:(s=v.workspace)==null?void 0:s.id})};return(s,t)=>(r(),Z(ue,{to:"body"},[$(J,{name:"modal"},{default:S(()=>{var h;return[f.show?(r(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[5]||(t[5]=L(P=>s.$emit("close"),["self"]))},[t[12]||(t[12]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",Qt,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:t[4]||(t[4]=L(()=>{},["stop"]))},[e("div",Ut,[t[7]||(t[7]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Добавить пользователя ",-1)),e("button",{onClick:t[0]||(t[0]=P=>s.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[6]||(t[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:L(y,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[e("p",Ht,[t[8]||(t[8]=H(" Workspace: ",-1)),e("span",Kt,M((h=f.workspace)==null?void 0:h.name),1)])]),e("div",null,[t[9]||(t[9]=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Email пользователя * ",-1)),G(e("input",{id:"email","onUpdate:modelValue":t[1]||(t[1]=P=>c.value.email=P),type:"email",required:"",class:"input",placeholder:"user@example.com"},null,512),[[de,c.value.email]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Роль ",-1)),G(e("select",{id:"role","onUpdate:modelValue":t[2]||(t[2]=P=>c.value.role=P),class:"input"},[...t[10]||(t[10]=[e("option",{value:"viewer"},"Просмотр",-1),e("option",{value:"member"},"Участник",-1),e("option",{value:"admin"},"Администратор",-1)])],512),[[et,c.value.role]])]),g.value?(r(),n("div",Nt,M(g.value),1)):_("",!0),e("div",Ft,[e("button",{type:"button",onClick:t[3]||(t[3]=P=>s.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:m.value,class:"btn btn-primary"},M(m.value?"Добавление...":"Добавить"),9,Gt)])],32)])])])):_("",!0)]}),_:1})]))}},Jt=ne(Zt,[["__scopeId","data-v-6f7095f1"]]),Xt={class:"flex min-h-screen items-center justify-center p-4"},Yt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},eo={key:0,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},to={class:"flex justify-end space-x-3 pt-4"},oo=["disabled"],ro={__name:"RenameWorkspaceModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","submit"],setup(f,{emit:j}){const v=f,x=j,b=s=>{s.key==="Escape"&&v.show&&x("close")};se(()=>document.addEventListener("keydown",b)),ae(()=>document.removeEventListener("keydown",b));const c=p({name:""}),m=p(!1),g=p("");X(()=>v.workspace,s=>{s&&(c.value.name=s.name)},{immediate:!0}),X(()=>v.show,s=>{s||(m.value=!1,g.value="")});const y=()=>{g.value="",m.value=!0,x("submit",c.value.name)};return(s,t)=>(r(),Z(ue,{to:"body"},[$(J,{name:"modal"},{default:S(()=>[f.show?(r(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:t[4]||(t[4]=L(h=>s.$emit("close"),["self"]))},[t[8]||(t[8]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",Xt,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-auto",onClick:t[3]||(t[3]=L(()=>{},["stop"]))},[e("div",Yt,[t[6]||(t[6]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Переименовать workspace ",-1)),e("button",{onClick:t[0]||(t[0]=h=>s.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...t[5]||(t[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:L(y,["prevent"]),class:"p-6 space-y-4"},[e("div",null,[t[7]||(t[7]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Новое название * ",-1)),G(e("input",{id:"name","onUpdate:modelValue":t[1]||(t[1]=h=>c.value.name=h),type:"text",required:"",class:"input",placeholder:"Название workspace"},null,512),[[de,c.value.name]])]),g.value?(r(),n("div",eo,M(g.value),1)):_("",!0),e("div",to,[e("button",{type:"button",onClick:t[2]||(t[2]=h=>s.$emit("close")),class:"btn btn-secondary"}," Отмена "),e("button",{type:"submit",disabled:m.value,class:"btn btn-primary"},M(m.value?"Сохранение...":"Сохранить"),9,oo)])],32)])])])):_("",!0)]),_:1})]))}},so=ne(ro,[["__scopeId","data-v-98660e9e"]]),ao={class:"flex min-h-screen items-center justify-center p-4"},no={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},lo={class:"p-6"},io={key:0,class:"text-center py-8"},co={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},uo={key:2,class:"space-y-3"},po={class:"flex items-center space-x-3"},vo={class:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center text-white text-sm font-medium"},go={class:"font-medium text-gray-900 dark:text-white"},ko={class:"text-sm text-gray-500 dark:text-gray-400"},mo={class:"flex items-center space-x-3"},yo=["onClick","disabled"],fo={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xo={key:1,class:"inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-red-600"},bo={key:0,class:"px-6 pb-4"},ho={class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},wo={class:"flex justify-end p-6 border-t border-gray-200 dark:border-gray-700"},$o={__name:"MembersModal",props:{show:{type:Boolean,default:!1},workspace:{type:Object,default:null}},emits:["close","member-removed"],setup(f,{emit:j}){const v=f,x=j,b=u=>{u.key==="Escape"&&v.show&&x("close")};se(()=>document.addEventListener("keydown",b)),ae(()=>document.removeEventListener("keydown",b));const c=pe(),m=Ce(),g=p([]),y=p(!1),s=p(""),t=p(null),h=u=>u?u.split(" ").map(l=>l[0]).join("").toUpperCase().substring(0,2):"?",P=u=>({owner:"Владелец",admin:"Администратор",member:"Участник",viewer:"Наблюдатель"})[u]||u,K=u=>({owner:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400",admin:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",member:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",viewer:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400"})[u]||"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-400",D=u=>{var V,Q,N,W,T,a,z;const l=(V=m.user)==null?void 0:V.id,k=((Q=v.workspace)==null?void 0:Q.owner_id)===l,I=((a=(T=(W=(N=v.workspace)==null?void 0:N.members)==null?void 0:W.find(Y=>Y.id===l))==null?void 0:T.pivot)==null?void 0:a.role)==="admin";return((z=v.workspace)==null?void 0:z.owner_id)===u.id||u.id===l?!1:k||I},B=async()=>{var u;if((u=v.workspace)!=null&&u.id){y.value=!0,s.value="";try{const l=await c.fetchMembers(v.workspace.id);g.value=l.members||l||[]}catch(l){console.error("Error loading members:",l),s.value="Ошибка при загрузке участников"}finally{y.value=!1}}},R=async u=>{var l,k;if(confirm(`Вы уверены, что хотите удалить ${u.name} из workspace?`)){t.value=u.id,s.value="";try{await c.removeMember(v.workspace.id,u.id),await B(),x("member-removed",u)}catch(I){console.error("Error removing member:",I),s.value=((k=(l=I.response)==null?void 0:l.data)==null?void 0:k.message)||"Ошибка при удалении участника"}finally{t.value=null}}};return X(()=>v.show,u=>{u?B():(g.value=[],s.value="",t.value=null)}),X(()=>{var u;return(u=v.workspace)==null?void 0:u.id},()=>{v.show&&B()}),(u,l)=>(r(),Z(ue,{to:"body"},[$(J,{name:"modal"},{default:S(()=>[f.show?(r(),n("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:l[3]||(l[3]=L(k=>u.$emit("close"),["self"]))},[l[8]||(l[8]=e("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),e("div",ao,[e("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-auto",onClick:l[2]||(l[2]=L(()=>{},["stop"]))},[e("div",no,[l[5]||(l[5]=e("h3",{class:"text-xl font-semibold text-gray-900 dark:text-white"}," Участники workspace ",-1)),e("button",{onClick:l[0]||(l[0]=k=>u.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...l[4]||(l[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",lo,[y.value?(r(),n("div",io,[...l[6]||(l[6]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):g.value.length===0?(r(),n("div",co," Нет участников ")):(r(),n("div",uo,[(r(!0),n(le,null,ie(g.value,k=>{var I,V,Q,N;return r(),n("div",{key:k.id,class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},[e("div",po,[e("div",vo,M(h(k.name)),1),e("div",null,[e("div",go,M(k.name),1),e("div",ko,M(k.email),1)])]),e("div",mo,[e("span",{class:F(["px-3 py-1 text-xs font-medium rounded-full",K(((I=k.pivot)==null?void 0:I.role)||(((V=f.workspace)==null?void 0:V.owner_id)===k.id?"owner":"member"))])},M(P(((Q=k.pivot)==null?void 0:Q.role)||(((N=f.workspace)==null?void 0:N.owner_id)===k.id?"owner":"member"))),3),D(k)?(r(),n("button",{key:0,onClick:W=>R(k),class:"text-red-600 hover:text-red-700 p-2 rounded transition-colors",disabled:t.value===k.id,title:"Удалить из workspace"},[t.value!==k.id?(r(),n("svg",fo,[...l[7]||(l[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1)])])):(r(),n("div",xo))],8,yo)):_("",!0)])])}),128))]))]),s.value?(r(),n("div",bo,[e("div",ho,M(s.value),1)])):_("",!0),e("div",wo,[e("button",{onClick:l[1]||(l[1]=k=>u.$emit("close")),class:"btn btn-secondary"}," Закрыть ")])])])])):_("",!0)]),_:1})]))}},Co=ne($o,[["__scopeId","data-v-6667e3af"]]),Mo={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},jo={key:0,class:"fixed inset-0 z-[100] bg-white dark:bg-gray-900 flex items-center justify-center"},_o={class:"text-center"},So={class:"mb-6 flex justify-center"},To=["src"],Eo={class:"text-sm text-gray-500 dark:text-gray-400 flex justify-center"},Do={class:"flex h-screen"},Bo={class:"flex flex-col h-full"},Lo={class:"hidden lg:flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Wo={class:"flex items-center space-x-3"},Ao=["src"],Oo={class:"p-4 border-b border-gray-200 dark:border-gray-700"},Po={class:"flex items-center justify-between mb-3"},zo={class:"space-y-1"},Io={class:"flex-1 flex items-center px-3 py-2 text-sm cursor-pointer"},Vo=["checked","onChange"],qo={class:"flex-1 overflow-y-auto p-4"},Ro={class:"space-y-1"},Qo={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700 space-y-1"},Uo={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},Ho={class:"space-y-1 max-h-64 overflow-y-auto"},Ko={class:"text-sm text-gray-700 dark:text-gray-300 truncate"},No={key:0,class:"text-xs text-gray-500"},Fo=["onClick"],Go={key:0,class:"px-3 py-2 text-sm text-gray-500 text-center"},Zo={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},Jo={class:"space-y-1"},Xo={key:1,class:"fixed bottom-5 right-5 z-30 lg:hidden flex flex-col gap-3 items-center"},Yo={class:"flex-1 flex flex-col overflow-hidden"},er={class:"flex-1 overflow-auto"},tr={key:0,class:"fixed inset-0 z-[60] flex items-center justify-center p-4"},or={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-xl max-w-sm w-full p-6"},rr={class:"text-sm text-gray-500 dark:text-gray-400 mb-6"},sr={__name:"MainLayout",setup(f){const j=tt(),v=Ce(),x=pe(),b=ot(),c=rt(),m=p(!0),g=p("Загрузка...".split("")),y=p(!1);p(!1);const s=p(!1),t=p(!1),h=p(""),P=p(null),K=p(!1),D=p(!1),B=p(!1),R=p(!1),u=p(null),l=p(""),k=p(null),I=p(!1),V=p(null),Q=O(()=>v.user),N=O(()=>x.workspaces),W=O(()=>b.counts),T=O(()=>x.currentWorkspace),a=O(()=>c.activeProjects),z=O(()=>x.selectedWorkspaces.map(i=>i.id)),Y=O(()=>b.filteredTasks.length),q=O(()=>{if(z.value.length===0)return 0;const i=W.value.scheduled||0,o=W.value.today||0,w=W.value.tomorrow||0;return i+o+w});O(()=>{var o;return(((o=Q.value)==null?void 0:o.name)||"").split(" ").map(w=>w[0]).join("").toUpperCase().slice(0,2)});const ke=i=>{var U;x.toggleSelectedWorkspace(i);const w=j.currentRoute.value.path.split("/"),C=w[w.length-1],E=["inbox","next-actions","today","waiting","someday","calendar","projects","goals"].includes(C)?C:"inbox",A=((U=x.currentWorkspace)==null?void 0:U.id)||i.id;j.push(`/workspaces/${A}/${E}`)},De=async i=>{try{const o=await x.createWorkspace(i);s.value=!1,await ke(o)}catch(o){console.error("Ошибка создания workspace:",o)}},Be=async()=>{await v.logout(),j.push("/login")},Le=()=>{t.value=!0},me=()=>{u.value=null,R.value=!0},We=async i=>{var o,w;l.value="";try{u.value?await c.updateProject(u.value.id,i):await c.createProject(i),R.value=!1,u.value=null,await c.fetchProjects()}catch(C){console.error("Error saving project:",C),l.value=((w=(o=C.response)==null?void 0:o.data)==null?void 0:w.message)||C.message||"Ошибка при сохранении проекта"}},Ae=()=>{R.value=!1,u.value=null,l.value=""},Oe=async i=>{var o,w;if(confirm(`Архивировать проект "${i.name}"?`))try{await c.archiveProject(i.id),await c.fetchProjects()}catch(C){console.error("Error archiving project:",C),alert("Ошибка при архивировании проекта: "+(((w=(o=C.response)==null?void 0:o.data)==null?void 0:w.message)||C.message))}},Pe=()=>{console.log("Quick add goal")},ze=async i=>{var o,w;h.value="";try{await b.createTask(i),t.value=!1}catch(C){console.error("Error creating task:",C),h.value=((w=(o=C.response)==null?void 0:o.data)==null?void 0:w.message)||C.message||"Ошибка при создании задачи"}},Ie=()=>{t.value=!1,h.value=""},ee=async({taskId:i,newStatus:o})=>{var w,C;try{const d={status:o};if(o==="today")d.due_date=new Date().toISOString().split("T")[0];else if(o==="tomorrow"){const E=new Date;E.setDate(E.getDate()+1),d.due_date=E.toISOString().split("T")[0]}await b.updateTask(i,d)}catch(d){console.error("Error updating task status:",d),alert(((C=(w=d.response)==null?void 0:w.data)==null?void 0:C.message)||"Ошибка при обновлении задачи")}},Ve=i=>{console.log("Search:",i)},qe=()=>{j.push("/settings")},Re=()=>{j.push("/settings")},Qe=i=>{i.target.style.display="none"},Ue=async()=>{if(V.value){try{await x.deleteWorkspace(V.value.id)}catch(i){console.error("Error deleting workspace:",i)}I.value=!1,V.value=null}},ye=()=>{I.value=!1,V.value=null},He=()=>{K.value=!1,k.value=null},Ke=()=>{B.value=!1,k.value=null},Ne=async()=>{await x.fetchWorkspaces()},Fe=()=>{D.value=!1,k.value=null},Ge=async i=>{var o,w,C,d,E;try{console.log("Sending member data:",i),await x.addMember(i.workspace_id,{email:i.email,role:i.role}),K.value=!1,k.value=null,alert("Пользователь успешно добавлен в workspace")}catch(A){console.error("Error adding member:",A),console.error("Error response:",(o=A.response)==null?void 0:o.data);let U="Ошибка при добавлении пользователя";(C=(w=A.response)==null?void 0:w.data)!=null&&C.errors?U=Object.values(A.response.data.errors).flat().join(", "):(E=(d=A.response)==null?void 0:d.data)!=null&&E.message&&(U=A.response.data.message),alert(U)}},Ze=async i=>{var o,w,C,d,E;try{console.log("Renaming workspace:",k.value.id,"to:",i),await x.updateWorkspace(k.value.id,{name:i}),await x.fetchWorkspaces(),D.value=!1,k.value=null,alert("Workspace успешно переименован")}catch(A){console.error("Error renaming workspace:",A),console.error("Error response:",(o=A.response)==null?void 0:o.data);let U="Ошибка при переименовании";(C=(w=A.response)==null?void 0:w.data)!=null&&C.errors?U=Object.values(A.response.data.errors).flat().join(", "):(E=(d=A.response)==null?void 0:d.data)!=null&&E.message&&(U=A.response.data.message),alert(U)}},fe=i=>{i.key==="Escape"&&(P.value=null)};se(async()=>{try{await x.fetchWorkspaces(),await Promise.all([b.fetchAllTasks(),c.fetchProjects()])}finally{m.value=!1}b.startSync(),document.addEventListener("click",xe),document.addEventListener("keydown",fe)}),X(()=>{var i;return(i=x.currentWorkspace)==null?void 0:i.id},i=>{i&&c.fetchProjects()}),ae(()=>{b.stopSync(),document.removeEventListener("click",xe),document.removeEventListener("keydown",fe)});const xe=()=>{P.value=null};return(i,o)=>{const w=ce("router-link"),C=ce("router-view");return r(),n("div",Mo,[$(J,{name:"fade"},{default:S(()=>[m.value?(r(),n("div",jo,[e("div",_o,[e("div",So,[e("img",{src:oe(ge),alt:"GTD TODO",class:"w-48 h-48 object-contain",onError:Qe},null,40,To)]),o[7]||(o[7]=e("h2",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"GTD TODO",-1)),e("p",Eo,[(r(!0),n(le,null,ie(g.value,(d,E)=>(r(),n("span",{key:E,style:be({animationDelay:`${E*.1}s`}),class:"loading-letter"},M(d),5))),128))])])])):_("",!0)]),_:1}),e("div",Do,[e("aside",{class:F(["fixed lg:static inset-y-0 left-0 z-40 w-64 bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 transform transition-transform duration-300 ease-in-out",y.value?"translate-x-0":"-translate-x-full lg:translate-x-0"])},[e("div",Bo,[e("div",Lo,[e("div",Wo,[e("img",{src:oe(ge),alt:"GTD TODO",class:"h-10 w-10 object-contain"},null,8,Ao),o[8]||(o[8]=e("h1",{class:"text-xl font-bold text-gray-900 dark:text-white"},"GTD TODO",-1))])]),e("div",Oo,[e("div",Po,[o[10]||(o[10]=e("h3",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Рабочие пространства ",-1)),e("button",{onClick:o[0]||(o[0]=d=>s.value=!0),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",title:"Создать workspace"},[...o[9]||(o[9]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),e("div",zo,[(r(!0),n(le,null,ie(N.value,d=>(r(),n("div",{key:d.id,class:F(["group flex items-center rounded-lg transition-colors overflow-hidden",z.value.includes(d.id)?"bg-primary-50 dark:bg-primary-900/30":"hover:bg-gray-50 dark:hover:bg-gray-700"])},[e("label",Io,[e("input",{type:"checkbox",checked:z.value.includes(d.id),onChange:E=>ke(d),class:"mr-3 h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 dark:border-gray-600 rounded dark:bg-gray-700"},null,40,Vo),e("span",{class:F(["truncate",z.value.includes(d.id)?"text-primary-700 dark:text-primary-400 font-medium":"text-gray-700 dark:text-gray-300"])},M(d.name),3)]),$(w,{to:`/workspaces/${d.id}/settings`,class:"flex-shrink-0 p-1.5 mr-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 rounded transition-colors opacity-0 group-hover:opacity-100",title:"Настройки",onClick:o[1]||(o[1]=L(()=>{},["stop"]))},{default:S(()=>[...o[11]||(o[11]=[e("svg",{class:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"1.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})],-1)])]),_:1},8,["to"])],2))),128))])]),e("nav",qo,[e("div",Ro,[$(te,{to:"/workspaces/:id/inbox",icon:"inbox",count:W.value.inbox,"drop-status":"inbox",onTaskDropped:ee},{default:S(()=>[...o[12]||(o[12]=[H(" Входящие ",-1)])]),_:1},8,["count"])]),e("div",Qo,[$(te,{to:"/workspaces/:id/today",icon:"calendar",count:W.value.today,"drop-status":"today",onTaskDropped:ee},{default:S(()=>[...o[13]||(o[13]=[H(" Сегодня ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/next-actions",icon:"lightning",count:W.value.next_actions,"drop-status":"next_action",onTaskDropped:ee},{default:S(()=>[...o[14]||(o[14]=[H(" Следующие ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/tomorrow",icon:"calendar-days",count:W.value.tomorrow,"drop-status":"tomorrow",onTaskDropped:ee},{default:S(()=>[...o[15]||(o[15]=[H(" Завтра ",-1)])]),_:1},8,["count"]),$(ve,{to:"/workspaces/:id/calendar",icon:"calendar-days",count:q.value},{default:S(()=>[...o[16]||(o[16]=[H(" Календарь ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/someday",icon:"archive",count:W.value.someday,"drop-status":"someday",onTaskDropped:ee},{default:S(()=>[...o[17]||(o[17]=[H(" Когда-нибудь ",-1)])]),_:1},8,["count"]),$(te,{to:"/workspaces/:id/waiting",icon:"clock",count:W.value.waiting,"drop-status":"waiting",onTaskDropped:ee},{default:S(()=>[...o[18]||(o[18]=[H(" Ожидание ",-1)])]),_:1},8,["count"]),$(ve,{to:"/workspaces/:id/all",icon:"rectangle-stack",count:Y.value},{default:S(()=>[...o[19]||(o[19]=[H(" Все задачи ",-1)])]),_:1},8,["count"])]),e("div",Uo,[e("div",{class:"flex items-center justify-between px-3 mb-3"},[o[21]||(o[21]=e("h3",{class:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"}," Проекты ",-1)),e("button",{onClick:me,class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Создать проект"},[...o[20]||(o[20]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)])])]),e("div",Ho,[(r(!0),n(le,null,ie(a.value,d=>{var E;return r(),n("div",{key:d.id,class:"flex items-center justify-between group px-3 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"},[$(w,{to:`/workspaces/${(E=T.value)==null?void 0:E.id}/projects/${d.id}`,class:"flex items-center space-x-2 flex-1 min-w-0"},{default:S(()=>[e("div",{class:"w-3 h-3 rounded-full flex-shrink-0",style:be({backgroundColor:d.color||"#3B82F6"})},null,4),e("span",Ko,M(d.name),1),d.tasks_count>0?(r(),n("span",No," ("+M(d.tasks_count)+") ",1)):_("",!0)]),_:2},1032,["to"]),e("button",{onClick:L(A=>Oe(d),["stop"]),class:"opacity-0 group-hover:opacity-100 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 p-1 transition-opacity",title:"Архивировать"},[...o[22]||(o[22]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})],-1)])],8,Fo)])}),128)),a.value.length===0?(r(),n("div",Go," Нет проектов ")):_("",!0)])]),e("div",Zo,[o[24]||(o[24]=e("h3",{class:"px-3 text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3"}," Организация ",-1)),e("div",Jo,[$(ve,{to:"/workspaces/:id/goals",icon:"target"},{default:S(()=>[...o[23]||(o[23]=[H(" Цели ",-1)])]),_:1})])])])])],2),y.value?(r(),n("div",{key:0,onClick:o[2]||(o[2]=d=>y.value=!1),class:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden"})):_("",!0),y.value?_("",!0):(r(),n("div",Xo,[e("button",{onClick:o[3]||(o[3]=d=>t.value=!0),class:"w-10 h-10 bg-green-500 hover:bg-green-600 text-white rounded-full shadow-lg flex items-center justify-center active:scale-95 transition-transform"},[...o[25]||(o[25]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4.5v15m7.5-7.5h-15"})],-1)])]),e("button",{onClick:o[4]||(o[4]=d=>y.value=!0),class:"w-12 h-12 bg-primary-600 hover:bg-primary-700 text-white rounded-full shadow-lg flex items-center justify-center active:scale-95 transition-transform"},[...o[26]||(o[26]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})],-1)])])])),e("main",Yo,[$(At,{user:Q.value,onQuickAddTask:Le,onQuickAddProject:me,onQuickAddGoal:Pe,onSearch:Ve,onLogout:Be,onProfile:qe,onSettings:Re,onToggleSidebar:o[5]||(o[5]=d=>y.value=!y.value)},null,8,["user"]),e("div",er,[$(C)])])]),$(Rt,{show:s.value,onClose:o[6]||(o[6]=d=>s.value=!1),onSubmit:De},null,8,["show"]),$(st,{show:t.value,"server-error":h.value,onClose:Ie,onSubmit:ze},null,8,["show","server-error"]),$(Jt,{show:K.value,workspace:k.value,onClose:He,onSubmit:Ge},null,8,["show","workspace"]),$(so,{show:D.value,workspace:k.value,onClose:Fe,onSubmit:Ze},null,8,["show","workspace"]),$(Co,{show:B.value,workspace:k.value,onClose:Ke,onMemberRemoved:Ne},null,8,["show","workspace"]),$(nt,{show:R.value,project:u.value,"server-error":l.value,onClose:Ae,onSubmit:We},null,8,["show","project","server-error"]),$(J,{name:"modal"},{default:S(()=>{var d;return[I.value?(r(),n("div",tr,[e("div",{class:"fixed inset-0 bg-black/50",onClick:ye}),e("div",or,[o[27]||(o[27]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"Удалить пространство?",-1)),e("p",rr," Пространство «"+M((d=V.value)==null?void 0:d.name)+"» будет удалено навсегда. Это действие нельзя отменить. ",1),e("div",{class:"flex justify-end space-x-3"},[e("button",{onClick:ye,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"}," Отмена "),e("button",{onClick:Ue,class:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 transition-colors"}," Удалить ")])])])):_("",!0)]}),_:1})])}}},pr=ne(sr,[["__scopeId","data-v-35146770"]]);export{pr as default};
