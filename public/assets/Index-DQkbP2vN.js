import{r as x,k as G,s as M,c as s,a as r,f as j,F as V,C as B,I as D,i as S,j as $,o,b as n,e as p,D as k,t as l,p as z}from"./index-DARtzBY4.js";import{u as H}from"./goals-BJQeUNzD.js";import{u as N}from"./workspace-CT6nSM7Z.js";import{G as A}from"./GoalModal-BLUDzrOc.js";import"./lifeSpheres-Cp-dWg_N.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"p-4 lg:p-8"},E={class:"flex items-center justify-between mb-6"},F={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},I=["onClick"],L={key:0,class:"h-40 overflow-hidden"},T=["src"],U={class:"p-5"},W={key:0,class:"inline-flex items-center gap-1 text-xs text-gray-500 dark:text-gray-400 mb-1"},q={class:"text-lg font-semibold text-gray-900 dark:text-white truncate mb-2"},J={key:2,class:"text-sm text-gray-600 dark:text-gray-300 mb-2 line-clamp-2"},K={key:3,class:"text-sm italic text-gray-500 dark:text-gray-400 line-clamp-1 mb-3"},O={class:"flex items-center justify-between text-sm"},P={class:"flex items-center space-x-3 text-gray-500 dark:text-gray-400"},Q={key:0,class:"flex items-center"},X={key:1,class:"flex items-center"},Y={key:0,class:"text-primary-600 dark:text-primary-400 font-medium"},Z={key:4,class:"mt-2 w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5"},ee={key:1,class:"text-center py-16"},ie={__name:"Index",setup(te){const g=S(),v=$(),i=H();N();const d=x(!1),u=x(null),c=x(""),y=G(()=>i.activeGoals),h=a=>{if(!a)return null;const e=new Date(a),t=new Date;return t.setHours(0,0,0,0),e.setHours(0,0,0,0),Math.ceil((e-t)/(1e3*60*60*24))},f=a=>{const e=h(a);return e===null?"":e<0?`Просрочено на ${Math.abs(e)} дн.`:e===0?"Сегодня":e===1?"Завтра":e<=30?`${e} дн.`:new Date(a).toLocaleDateString("ru-RU",{day:"numeric",month:"short",year:"numeric"})},w=a=>{const e=h(a);return e===null?"text-gray-500 dark:text-gray-400":e<0?"text-red-500 dark:text-red-400":e<=3?"text-orange-500 dark:text-orange-400":e<=7?"text-yellow-600 dark:text-yellow-400":"text-gray-500 dark:text-gray-400"},_=a=>{g.push(`/workspaces/${v.params.id}/goals/${a.id}`)},b=async a=>{var e,t;c.value="";try{u.value?await i.updateGoal(u.value.id,a):await i.createGoal(a),d.value=!1,u.value=null,await i.fetchAllGoals({force:!0})}catch(m){console.error("Error saving goal:",m),c.value=((t=(e=m.response)==null?void 0:e.data)==null?void 0:t.message)||m.message||"Ошибка при сохранении цели"}},C=()=>{d.value=!1,u.value=null,c.value=""};return M(async()=>{await i.fetchAllGoals()}),(a,e)=>(o(),s("div",R,[r("div",E,[e[3]||(e[3]=r("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"},"Цели",-1)),r("button",{onClick:e[0]||(e[0]=t=>d.value=!0),class:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg flex items-center space-x-2 transition-colors"},[...e[2]||(e[2]=[r("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),r("span",null,"Создать цель",-1)])])]),y.value.length>0?(o(),s("div",F,[(o(!0),s(V,null,B(y.value,t=>(o(),s("div",{key:t.id,class:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:shadow-lg transition-shadow cursor-pointer overflow-hidden",onClick:m=>_(t)},[t.image_url?(o(),s("div",L,[r("img",{src:t.image_url,class:"w-full h-full object-cover"},null,8,T)])):n("",!0),r("div",U,[t.life_sphere?(o(),s("span",W,[r("span",{class:"w-2 h-2 rounded-full flex-shrink-0",style:k({backgroundColor:t.life_sphere.color})},null,4),p(" "+l(t.life_sphere.name),1)])):n("",!0),r("h3",q,l(t.name),1),t.deadline?(o(),s("p",{key:1,class:z(["text-sm mb-2 flex items-center",w(t.deadline)])},[e[4]||(e[4]=r("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),p(" "+l(f(t.deadline)),1)],2)):n("",!0),t.description?(o(),s("p",J,l(t.description),1)):n("",!0),t.bible_verse?(o(),s("p",K,l(t.bible_verse),1)):n("",!0),r("div",O,[r("div",P,[t.projects_count?(o(),s("span",Q,[e[5]||(e[5]=r("svg",{class:"w-3.5 h-3.5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1)),p(" "+l(t.projects_count),1)])):n("",!0),t.direct_tasks_count?(o(),s("span",X,[e[6]||(e[6]=r("svg",{class:"w-3.5 h-3.5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),p(" "+l(t.direct_tasks_count),1)])):n("",!0)]),t.progress>0?(o(),s("span",Y,l(t.progress)+"% ",1)):n("",!0)]),t.progress>0?(o(),s("div",Z,[r("div",{class:"bg-primary-600 h-1.5 rounded-full transition-all",style:k({width:t.progress+"%"})},null,4)])):n("",!0)])],8,I))),128))])):(o(),s("div",ee,[e[7]||(e[7]=D('<svg class="mx-auto h-16 w-16 text-gray-400 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg><h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">У вас пока нет целей</h3><p class="text-gray-500 dark:text-gray-400 mb-2 max-w-md mx-auto leading-relaxed"> Цель — это ваш маяк. То, к чему стремится сердце. </p><p class="text-gray-500 dark:text-gray-400 mb-2 max-w-md mx-auto leading-relaxed"> Запишите свою мечту, добавьте вдохновляющую картинку и стих из Библии — и каждый день напоминайте себе, ради чего вы трудитесь. </p><p class="text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto leading-relaxed"> Привязывайте к цели потоки и задачи, чтобы видеть, как шаг за шагом вы приближаетесь к задуманному. </p>',5)),r("button",{onClick:e[1]||(e[1]=t=>d.value=!0),class:"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg transition-colors"}," Создать цель ")])),j(A,{show:d.value,goal:u.value,"server-error":c.value,onClose:C,onSubmit:b},null,8,["show","goal","server-error"])]))}};export{ie as default};
