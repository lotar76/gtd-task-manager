import{u as M}from"./CalendarDaysIcon-k95rGS8T.js";import{T as N}from"./TaskList-BZY3URFI.js";import{c as S,T as j}from"./TaskModal-BzRPWaSn.js";import{T as A}from"./TaskView-8lvKIHKK.js";import{r as F}from"./PlusIcon-B6A68N3R.js";import{k as g,r as d,c as m,a,f as u,F as U,l as $,y as T,e as G,o as n}from"./index-BQRmz4GQ.js";import"./workspace-DTkHaZL8.js";import"./ru-B7JyRvIu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-BB9qncDe.js";import"./lifeSpheres-DDVy7cpI.js";import"./goals-D1Fsmasl.js";const L={class:"p-4 lg:p-8"},O={class:"max-w-4xl mx-auto"},q={key:0,class:"text-center py-12"},z={key:1,class:"text-center py-12"},D={class:"max-w-md mx-auto"},H={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-yellow-50 dark:bg-yellow-900/30 flex items-center justify-center"},oe={__name:"NextActions",setup(I){const o=M(),v=g(()=>o.nextActionTasks),y=g(()=>o.loading),r=d(!1),i=d(!1),t=d(null),c=d(""),w=s=>{t.value=s,i.value=!0},h=()=>{t.value=null,r.value=!0},b=()=>{i.value=!1,r.value=!0},C=async s=>{try{await o.completeTask(s.id)}catch(e){console.error("Error completing task:",e)}},E=async s=>{try{await o.uncompleteTask(s.id)}catch(e){console.error("Error uncompleting task:",e)}},_=async s=>{try{s.completed_at?await o.uncompleteTask(s.id):await o.completeTask(s.id)}catch(e){console.error("Error toggling task:",e)}},V=async s=>{var e,k,x,f;c.value="";try{t.value?await o.updateTask(t.value.id,s):await o.createTask(s),r.value=!1,t.value=null}catch(l){console.error("Error saving task:",l);let p="Ошибка при сохранении задачи";(k=(e=l.response)==null?void 0:e.data)!=null&&k.errors?p=Object.values(l.response.data.errors).flat().join(", "):(f=(x=l.response)==null?void 0:x.data)!=null&&f.message&&(p=l.response.data.message),c.value=p}},B=()=>{r.value=!1,t.value=null,c.value=""};return(s,e)=>(n(),m("div",L,[a("div",O,[e[5]||(e[5]=a("div",{class:"mb-6"},[a("h1",{class:"text-xl lg:text-2xl font-semibold text-gray-900 dark:text-white"},"Следующие действия")],-1)),y.value?(n(),m("div",q,[...e[1]||(e[1]=[a("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"},null,-1)])])):(n(),m(U,{key:1},[v.value.length>0?(n(),$(N,{key:0,tasks:v.value,onTaskClick:w,onToggleComplete:_},null,8,["tasks"])):(n(),m("div",z,[a("div",D,[a("div",H,[u(T(S),{class:"w-8 h-8 text-yellow-500"})]),e[3]||(e[3]=a("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"Нет следующих действий",-1)),e[4]||(e[4]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-6 leading-relaxed"}," Следующие действия — это ключевой список GTD. Сюда попадают конкретные физические действия, которые можно выполнить прямо сейчас, без привязки к дате. Спросите себя: «Какой следующий конкретный шаг?» — и запишите его сюда. ",-1)),a("button",{onClick:h,class:"inline-flex items-center px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-lg hover:bg-primary-700 transition-colors"},[u(T(F),{class:"w-5 h-5 mr-1.5"}),e[2]||(e[2]=G(" Добавить действие ",-1))])])]))],64)),u(A,{show:i.value,task:t.value,onClose:e[0]||(e[0]=k=>{i.value=!1,t.value=null}),onEnterEdit:b,onCompleteTask:C,onUncompleteTask:E},null,8,["show","task"]),u(j,{show:r.value,task:t.value,"server-error":c.value,onClose:B,onSubmit:V},null,8,["show","task","server-error"])])]))}};export{oe as default};
