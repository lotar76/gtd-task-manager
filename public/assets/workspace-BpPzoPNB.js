import{J as f,r as d,G as o}from"./index-BTCQYrbC.js";const $=f("workspace",()=>{const l=d([]),s=d(null),t=d([]),n=d(!1),i=()=>{const e=localStorage.getItem("selectedWorkspaceIds");if(e)try{const a=JSON.parse(e);t.value=l.value.filter(r=>a.includes(r.id))}catch(a){console.error("Error loading selected workspaces:",a)}},u=()=>{const e=t.value.map(a=>a.id);localStorage.setItem("selectedWorkspaceIds",JSON.stringify(e))};return{workspaces:l,currentWorkspace:s,selectedWorkspaces:t,loading:n,fetchWorkspaces:async()=>{n.value=!0;try{const e=await o.get("/v1/workspaces");l.value=e.data,i();const a=localStorage.getItem("currentWorkspaceId");if(a&&l.value.length>0){const r=l.value.find(c=>c.id===parseInt(a));r?(s.value=r,t.value.find(c=>c.id===r.id)||(t.value.push(r),u())):s.value=l.value[0]}else l.value.length>0&&!s.value&&(s.value=l.value[0]);t.value.length===0&&l.value.length>0&&(t.value.push(l.value[0]),s.value||(s.value=l.value[0]),u())}finally{n.value=!1}},fetchWorkspace:async e=>{n.value=!0;try{const a=await o.get(`/v1/workspaces/${e}`);return s.value=a.data,a.data}finally{n.value=!1}},createWorkspace:async e=>{const a=await o.post("/v1/workspaces",e);return l.value.push(a.data),a.data},updateWorkspace:async(e,a)=>{var v;const r=await o.put(`/v1/workspaces/${e}`,a),c=l.value.findIndex(p=>p.id===e);return c!==-1&&(l.value[c]=r.data),((v=s.value)==null?void 0:v.id)===e&&(s.value=r.data),r.data},addMember:async(e,a)=>(await o.post(`/v1/workspaces/${e}/members`,a)).data,removeMember:async(e,a)=>(await o.delete(`/v1/workspaces/${e}/members/${a}`)).data,fetchMembers:async e=>(await o.get(`/v1/workspaces/${e}/members`)).data,setCurrentWorkspace:e=>{s.value=e,localStorage.setItem("currentWorkspaceId",e.id),t.value.find(a=>a.id===e.id)||(t.value.push(e),u())},toggleSelectedWorkspace:e=>{var r;const a=t.value.findIndex(c=>c.id===e.id);a>-1?(t.value.splice(a,1),t.value.length===0&&l.value.length>0?(t.value.push(l.value[0]),s.value=l.value[0]):((r=s.value)==null?void 0:r.id)===e.id&&t.value.length>0&&(s.value=t.value[0],localStorage.setItem("currentWorkspaceId",s.value.id))):(t.value.push(e),s.value=e,localStorage.setItem("currentWorkspaceId",e.id)),u()},setSelectedWorkspaces:e=>{t.value=l.value.filter(a=>e.includes(a.id)),t.value.length>0&&!s.value&&(s.value=t.value[0],localStorage.setItem("currentWorkspaceId",s.value.id)),u()}}});export{$ as u};
