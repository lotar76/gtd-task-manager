import{I as f,r as v,G as o}from"./index-DS0dSXnQ.js";const x=f("workspace",()=>{const s=v([]),t=v(null),l=v([]),n=v(!1),i=()=>{const e=localStorage.getItem("selectedWorkspaceIds");if(e)try{const a=JSON.parse(e);l.value=s.value.filter(r=>a.includes(r.id))}catch(a){console.error("Error loading selected workspaces:",a)}},u=()=>{const e=l.value.map(a=>a.id);localStorage.setItem("selectedWorkspaceIds",JSON.stringify(e))};return{workspaces:s,currentWorkspace:t,selectedWorkspaces:l,loading:n,fetchWorkspaces:async()=>{n.value=!0;try{const e=await o.get("/v1/workspaces");s.value=e.data,i();const a=localStorage.getItem("currentWorkspaceId");if(a&&s.value.length>0){const r=s.value.find(c=>c.id===parseInt(a));r?(t.value=r,l.value.find(c=>c.id===r.id)||(l.value.push(r),u())):t.value=s.value[0]}else s.value.length>0&&!t.value&&(t.value=s.value[0]);l.value.length===0&&s.value.length>0&&(l.value.push(s.value[0]),t.value||(t.value=s.value[0]),u())}finally{n.value=!1}},fetchWorkspace:async e=>{n.value=!0;try{const a=await o.get(`/v1/workspaces/${e}`);return t.value=a.data,a.data}finally{n.value=!1}},createWorkspace:async e=>{const a=await o.post("/v1/workspaces",e);return s.value.push(a.data),a.data},updateWorkspace:async(e,a)=>{var d;const r=await o.put(`/v1/workspaces/${e}`,a),c=s.value.findIndex(p=>p.id===e);return c!==-1&&(s.value[c]=r.data),((d=t.value)==null?void 0:d.id)===e&&(t.value=r.data),r.data},deleteWorkspace:async e=>{var a;await o.delete(`/v1/workspaces/${e}`),s.value=s.value.filter(r=>r.id!==e),l.value=l.value.filter(r=>r.id!==e),((a=t.value)==null?void 0:a.id)===e&&(t.value=s.value[0]||null,t.value&&localStorage.setItem("currentWorkspaceId",t.value.id)),l.value.length===0&&s.value.length>0&&l.value.push(s.value[0]),u()},addMember:async(e,a)=>(await o.post(`/v1/workspaces/${e}/members`,a)).data,removeMember:async(e,a)=>(await o.delete(`/v1/workspaces/${e}/members/${a}`)).data,fetchMembers:async e=>(await o.get(`/v1/workspaces/${e}/members`)).data,setCurrentWorkspace:e=>{t.value=e,localStorage.setItem("currentWorkspaceId",e.id),l.value.find(a=>a.id===e.id)||(l.value.push(e),u())},toggleSelectedWorkspace:e=>{var r;const a=l.value.findIndex(c=>c.id===e.id);a>-1?(l.value.splice(a,1),l.value.length===0&&s.value.length>0?(l.value.push(s.value[0]),t.value=s.value[0]):((r=t.value)==null?void 0:r.id)===e.id&&l.value.length>0&&(t.value=l.value[0],localStorage.setItem("currentWorkspaceId",t.value.id))):(l.value.push(e),t.value=e,localStorage.setItem("currentWorkspaceId",e.id)),u()},setSelectedWorkspaces:e=>{l.value=s.value.filter(a=>e.includes(a.id)),l.value.length>0&&!t.value&&(t.value=l.value[0],localStorage.setItem("currentWorkspaceId",t.value.id)),u()}}});export{x as u};
