import{k,r as f,s as U,x as G,z as m,l as L,o as l,f as T,g as h,c as r,b,a as o,w as y,t as d,d as p,B as C,F as M,C as B,v as V,T as N,A as q}from"./index-DARtzBY4.js";import{u as z}from"./workspace-CT6nSM7Z.js";import{u as D}from"./goals-BJQeUNzD.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"flex min-h-screen items-center justify-center p-4"},A={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},I={class:"text-xl font-semibold text-gray-900 dark:text-white"},K={key:0},O=["value"],H=["value"],J={key:1,class:"text-red-600 dark:text-red-400 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-lg"},Q={class:"flex justify-end space-x-3 pt-4"},R=["disabled"],X={__name:"ProjectModal",props:{show:{type:Boolean,default:!1},project:{type:Object,default:null},serverError:{type:String,default:""}},emits:["close","submit"],setup(v,{emit:j}){const u=v,x=j,g=z(),w=D(),_=k(()=>g.workspaces),c=k(()=>g.currentWorkspace),$=k(()=>{const t=a.value.workspace_id;return t?w.activeGoals.filter(e=>e.workspace_id===t):w.activeGoals}),S=t=>{t.key==="Escape"&&u.show&&x("close")};U(()=>document.addEventListener("keydown",S)),G(()=>document.removeEventListener("keydown",S));const a=f({workspace_id:null,goal_id:null,name:"",description:""}),n=f(!1),i=f("");m(()=>u.project,t=>{var e,s;t?a.value={workspace_id:t.workspace_id||((e=c.value)==null?void 0:e.id),goal_id:t.goal_id||null,name:t.name||"",description:t.description||""}:a.value={workspace_id:(s=c.value)==null?void 0:s.id,goal_id:null,name:"",description:""},i.value=""},{immediate:!0}),m(()=>{var t;return(t=c.value)==null?void 0:t.id},t=>{!a.value.name&&t&&(a.value.workspace_id=t)}),m(()=>u.show,t=>{t||(n.value=!1,i.value="")}),m(()=>u.serverError,t=>{i.value=t,t&&(n.value=!1)});const E=()=>{i.value="",n.value=!0,x("submit",a.value)};return(t,e)=>(l(),L(q,{to:"body"},[T(N,{name:"modal"},{default:h(()=>[v.show?(l(),r("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:e[7]||(e[7]=y(s=>t.$emit("close"),["self"]))},[e[14]||(e[14]=o("div",{class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity"},null,-1)),o("div",W,[o("div",{class:"relative bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full mx-auto",onClick:e[6]||(e[6]=y(()=>{},["stop"]))},[o("div",A,[o("h3",I,d(v.project?"Редактировать поток":"Новый поток"),1),o("button",{onClick:e[0]||(e[0]=s=>t.$emit("close")),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},[...e[8]||(e[8]=[o("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),o("form",{onSubmit:y(E,["prevent"]),class:"p-6 space-y-4"},[_.value.length>1?(l(),r("div",K,[e[9]||(e[9]=o("label",{for:"workspace_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Рабочее пространство * ",-1)),p(o("select",{id:"workspace_id","onUpdate:modelValue":e[1]||(e[1]=s=>a.value.workspace_id=s),required:"",class:"input"},[(l(!0),r(M,null,B(_.value,s=>(l(),r("option",{key:s.id,value:s.id},d(s.name),9,O))),128))],512),[[C,a.value.workspace_id]])])):b("",!0),o("div",null,[e[10]||(e[10]=o("label",{for:"name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Название потока * ",-1)),p(o("input",{id:"name","onUpdate:modelValue":e[2]||(e[2]=s=>a.value.name=s),type:"text",required:"",class:"input",placeholder:"Введите название потока"},null,512),[[V,a.value.name]])]),o("div",null,[e[12]||(e[12]=o("label",{for:"goal_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Цель ",-1)),p(o("select",{id:"goal_id","onUpdate:modelValue":e[3]||(e[3]=s=>a.value.goal_id=s),class:"input"},[e[11]||(e[11]=o("option",{value:null},"Без цели",-1)),(l(!0),r(M,null,B($.value,s=>(l(),r("option",{key:s.id,value:s.id},d(s.name),9,H))),128))],512),[[C,a.value.goal_id]])]),o("div",null,[e[13]||(e[13]=o("label",{for:"description",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Описание ",-1)),p(o("textarea",{id:"description","onUpdate:modelValue":e[4]||(e[4]=s=>a.value.description=s),rows:"3",class:"input",placeholder:"Добавьте описание потока"},null,512),[[V,a.value.description]])]),i.value?(l(),r("div",J,d(i.value),1)):b("",!0),o("div",Q,[o("button",{type:"button",onClick:e[5]||(e[5]=s=>t.$emit("close")),class:"btn btn-secondary"}," Отмена "),o("button",{type:"submit",disabled:n.value,class:"btn btn-primary"},d(n.value?"Сохранение...":"Сохранить"),9,R)])],32)])])])):b("",!0)]),_:1})]))}},te=F(X,[["__scopeId","data-v-ea8cb3f6"]]);export{te as P};
