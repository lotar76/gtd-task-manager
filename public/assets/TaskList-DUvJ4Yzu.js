import{r as v,c as n,o as a,f as E,b as c,g as J,F as H,C as G,p as B,a as o,w as O,t as l,e as k,D as S,G as q}from"./index-BM-3aGKM.js";import{g as K,c as P,d as w,C as Q}from"./TaskView-9FQW8AeN.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";var A={exports:{}};(function(V,L){(function(g,x){V.exports=x()})(P,function(){return function(g,x,p){g=g||{};var d=x.prototype,h={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function z(s,f,y,_){return d.fromToBase(s,f,y,_)}p.en.relativeTime=h,d.fromToBase=function(s,f,y,_,N){for(var M,u,C,T=y.$locale().relativeTime||h,j=g.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],r=j.length,t=0;t<r;t+=1){var e=j[t];e.d&&(M=_?p(s).diff(y,e.d,!0):y.diff(s,e.d,!0));var m=(g.rounding||Math.round)(Math.abs(M));if(C=M>0,m<=e.r||!e.r){m<=1&&t>0&&(e=j[t-1]);var i=T[e.l];N&&(m=N(""+m)),u=typeof i=="string"?i.replace("%d",m):i(m,f,e.l,C);break}}if(f)return u;var D=C?T.future:T.past;return typeof D=="function"?D(u):D.replace("%s",u)},d.to=function(s,f){return z(s,f,this,!0)},d.from=function(s,f){return z(s,f,this)};var b=function(s){return s.$u?p.utc():p()};d.toNow=function(s){return this.to(b(this),s)},d.fromNow=function(s){return this.from(b(this),s)}}})})(A);var U=A.exports;const W=K(U),X=["onDragstart","onClick"],Y={class:"flex items-start space-x-3"},Z=["onClick"],ee={key:0,class:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},te={class:"flex-1 min-w-0"},re={key:0,class:"text-sm text-gray-500 mt-1 truncate"},oe={class:"flex flex-wrap items-center gap-2 mt-2"},ne={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-indigo-100 text-indigo-700 dark:bg-indigo-900/30 dark:text-indigo-400"},ae={key:3,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400"},se={key:0},ie={key:1},le={key:2},de={key:4,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300"},ue={key:0,class:"text-center py-12"},me={__name:"TaskList",props:{tasks:{type:Array,default:()=>[]}},emits:["task-click","toggle-complete","task-drag-start","task-drag-end"],setup(V,{emit:L}){w.extend(W),w.locale("ru");const g=L,x=v(!1),p=v(null),d=v(!1),h=v(null),z=v("Завершить задачу?"),b=v(""),s=(r,t)=>{x.value=!0,p.value=t,r.dataTransfer.effectAllowed="move",r.dataTransfer.setData("application/json",JSON.stringify(t)),g("task-drag-start",t)},f=()=>{x.value=!1,p.value=null,g("task-drag-end")},y=r=>{if(r.completed_at){g("toggle-complete",r);return}h.value=r,b.value=`Вы уверены, что хотите завершить задачу "${r.title}"?`,d.value=!0},_=()=>{h.value&&g("toggle-complete",h.value),d.value=!1,h.value=null},N=()=>{d.value=!1,h.value=null},M=r=>{const t=w(r),e=w();return t.isSame(e,"day")?"Сегодня":t.isSame(e.add(1,"day"),"day")?"Завтра":t.isBefore(e)?t.fromNow():t.format("D MMM")},u=r=>r?/^\d{2}:\d{2}$/.test(r)?r:r.substring(0,5):"",C=r=>{if(r.completed_at)return"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400";const t=w(r.due_date),e=w();return t.isBefore(e,"day")?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400":t.isSame(e,"day")?"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400"},T=r=>{if(!r.estimated_time||!r.end_time)return 0;const t=u(r.estimated_time),e=u(r.end_time);if(!t||!e)return 0;const[m,i]=t.split(":").map(Number),[D,F]=e.split(":").map(Number),I=m*60+i;let $=D*60+F-I;return $<0&&($+=24*60),$/60},j=r=>{if(r.completed_at)return"bg-white dark:bg-gray-800";const t=T(r);return t===0||t<1?"bg-gradient-to-l from-white via-green-50 to-green-100 dark:from-gray-800 dark:via-green-900/20 dark:to-green-900/40":t>=1&&t<2?"bg-gradient-to-l from-white via-orange-50 to-orange-100 dark:from-gray-800 dark:via-orange-900/20 dark:to-orange-900/40":t>=2?"bg-gradient-to-l from-white via-red-50 to-red-100 dark:from-gray-800 dark:via-red-900/20 dark:to-red-900/40":"bg-white dark:bg-gray-800"};return(r,t)=>(a(),n(H,null,[E(q,{name:"task",tag:"div",class:"space-y-2"},{default:J(()=>[(a(!0),n(H,null,G(V.tasks,e=>{var m;return a(),n("div",{key:e.id,draggable:"true",onDragstart:i=>s(i,e),onDragend:f,class:B(["border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-sm transition-all cursor-move relative overflow-hidden",[{"opacity-50":x.value&&((m=p.value)==null?void 0:m.id)===e.id},j(e)]]),onClick:i=>r.$emit("task-click",e)},[o("div",Y,[o("button",{onClick:O(i=>y(e),["stop"]),class:B(["mt-1 flex-shrink-0 w-5 h-5 rounded border-2 flex items-center justify-center transition-colors duration-200",e.completed_at?"bg-green-500 border-green-500":"border-gray-300 hover:border-primary-500"])},[e.completed_at?(a(),n("svg",ee,[...t[0]||(t[0]=[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"3",d:"M5 13l4 4L19 7"},null,-1)])])):c("",!0)],10,Z),o("div",te,[o("h3",{class:B(["text-sm font-medium transition-all duration-200",e.completed_at?"text-gray-400 line-through":"text-gray-900 dark:text-white"])},l(e.title),3),e.description?(a(),n("p",re,l(e.description),1)):c("",!0),o("div",oe,[e.workspace?(a(),n("span",ne,[t[1]||(t[1]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1)),k(" "+l(e.workspace.name),1)])):c("",!0),e.project?(a(),n("span",{key:1,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:S({backgroundColor:e.project.color+"20",color:e.project.color})},[t[2]||(t[2]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})],-1)),k(" "+l(e.project.name),1)],4)):c("",!0),e.due_date?(a(),n("span",{key:2,class:B(["inline-flex items-center px-2 py-1 rounded text-xs font-medium",C(e)])},[t[3]||(t[3]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),k(" "+l(M(e.due_date)),1)],2)):c("",!0),e.estimated_time||e.end_time?(a(),n("span",ae,[t[4]||(t[4]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e.estimated_time&&e.end_time?(a(),n("span",se,l(u(e.estimated_time))+" - "+l(u(e.end_time)),1)):e.estimated_time?(a(),n("span",ie,l(u(e.estimated_time)),1)):e.end_time?(a(),n("span",le," до "+l(u(e.end_time)),1)):c("",!0)])):c("",!0),e.assignee?(a(),n("span",de,[t[5]||(t[5]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),k(" "+l(e.assignee.name),1)])):c("",!0),e.context?(a(),n("span",{key:5,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:S({backgroundColor:e.context.color+"20",color:e.context.color})},[t[6]||(t[6]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})],-1)),k(" "+l(e.context.name),1)],4)):c("",!0),(a(!0),n(H,null,G(e.tags,i=>(a(),n("span",{key:i.id,class:"inline-flex items-center px-2 py-1 rounded text-xs font-medium",style:S({backgroundColor:i.color+"20",color:i.color})},[t[7]||(t[7]=o("svg",{class:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})],-1)),k(" "+l(i.name),1)],4))),128))])]),e.priority!=="medium"?(a(),n("div",{key:0,class:B(["flex-shrink-0 w-2 h-2 rounded-full mt-2",{"bg-red-500":e.priority==="urgent","bg-orange-500":e.priority==="high","bg-blue-500":e.priority==="low"}])},null,2)):c("",!0)])],42,X)}),128))]),_:1}),V.tasks.length?c("",!0):(a(),n("div",ue,[...t[8]||(t[8]=[o("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),o("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Нет задач",-1),o("p",{class:"mt-1 text-sm text-gray-500"},"Создайте первую задачу чтобы начать",-1)])])),E(Q,{show:d.value,title:z.value,message:b.value,"confirm-text":"Завершить","cancel-text":"Отмена",variant:"success",onConfirm:_,onCancel:N},null,8,["show","title","message"])],64))}},he=R(me,[["__scopeId","data-v-1b31f844"]]);export{he as T};
